<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Hexo Theme Keep"><meta name=description content="Hexo Theme Keep"><meta name=author content=carbofish><title>2024 强网杯 - Reverse | Carbo</title><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/logo.png><link rel=stylesheet href=/font/css/fontawesome.min.css><link rel=stylesheet href=/font/css/regular.min.css><link rel=stylesheet href=/font/css/solid.min.css><link rel=stylesheet href=/font/css/brands.min.css><script class=keep-theme-configurations>let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"example.com",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={base_info:{primary_color:"#1abc9c",title:"Carbo",author:"carbofish",avatar:"/images/avatar.png",logo:"/images/logo.png",favicon:"/images/logo.png"},menu:{home:"/ || fa-solid fa-home",tags:"/tags || fa-solid fa-tags",links:"/links || fa-solid fa-link",about:"/about || fa-solid fa-user-graduate"},first_screen:{enable:!0,background_img:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",background_img_dark:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",description:"白雪却嫌春色晚，欲穿庭树作飞花。",hitokoto:!1},social_contact:{enable:!1,links:{github:null,weixin:null,qq:"https://github.com/XPoet",weibo:null,zhihu:null,twitter:null,x:null,facebook:null,email:null}},scroll:{progress_bar:!0,percent:!0,hide_header:!0},home:{announcement:null,category:!0,tag:!0,post_datetime:"updated"},post:{author_badge:{enable:!1,level_badge:!0,custom_badge:["One","Two","Three"]},word_count:{wordcount:!0,min2read:!0},datetime_format:"YYYY-MM-DD HH:mm:ss",copyright_info:!0,share:!1,reward:{enable:!1,img_link:null,text:null,icon:null}},code_block:{tools:{enable:!0,style:"default"},highlight_theme:"default"},toc:{enable:!0,number:!1,expand_all:!1,init_open:!0,layout:"right"},website_count:{busuanzi_count:{enable:!0,site_uv:!0,site_pv:!0,page_pv:!0}},local_search:{enable:!0,preload:!0},comment:{enable:!0,use:"waline",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.36"},waline:{server_url:"https://comment.carbo.ink/",reaction:!0,version:"3.3.2",option:{dark:"auto"}},giscus:{repo:null,repo_id:null,category:"Announcements",category_id:null,reactions_enabled:!1},artalk:{server:null},disqus:{shortname:null}},rss:{enable:!1},lazyload:{enable:!0},cdn:{enable:!1,provider:"unpkg"},pjax:{enable:!0},footer:{since:2024,word_count:!0,site_deploy:{enable:!1,provider:"github",url:null},record:{enable:!1,list:[{code:null,link:null}]}},inject:{enable:!1,css:[null],js:[null]},root:"",source_data:{links:[{name:"5m10v3",link:"https://5m10v3.top",avatar:"https://5m10v3.top/images/1.jpg",description:"进击的二进制人"},{name:"PangBai",link:"https://pangbai.work/",avatar:"http://pangbai.work/images/avatar.jpg",description:"Bangbai | d180"},{name:"void2eye",link:"https://void2eye.fun/",avatar:"https://void2eye.fun/img/808.png",description:"政治家"},{name:"C3ngH",link:"https://c3ngh.top",avatar:"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg",description:"包罗万象哥"},{name:"A1ic3",link:"https://a1ic3.cn/",avatar:"https://a1ic3.cn/images/avatar1.jpg",description:"小密码王"},{name:"enllus1on",link:"https://enllus1on.github.io/",description:"Pwn神",avatar:"https://enllus1on.github.io/images/kano.jpg"},{name:"AsaL1n",link:"https://asal1n.github.io/",avatar:"https://asal1n.github.io/img/head.jpg",description:"血怒哥"},{name:"Straw",link:"https://straw-233.github.io/",avatar:"https://straw-233.github.io/avatar/meinasi.png",description:"午门痴"},{name:"CHHHCHHOH",link:"http://www.chhhchhoh.cn/",avatar:"https://s2.loli.net/2024/10/20/9EXmLyYuU6b5tVh.png",description:"吃了乙酸的乙醇不会梦到乙酸乙酯"},{name:"Lunatic",link:"https://goodlunatic.github.io/",avatar:"https://www.nssctf.cn/files/2024/4/28/7f130a1387.png",description:"Mind and Hand :)"},{name:"Fup1p1",link:"https://www.fup1p1.cn/",avatar:"https://www.nssctf.cn/files/2024/4/29/524400904c.jpeg",description:"逆向寻真理"},{name:"X1ao",link:"https://www.x1aoblog.top/",avatar:"http://www.x1aoblog.top/upload/mmexport1681277516546.png",description:"大密码王"},{name:"Xux",link:"https://www.xuxblog.top",avatar:"https://avatars.githubusercontent.com/u/82816273?s=64&v=4",description:"神仙 Web 👴"},{name:"Woodwhale",avatar:"https://www.woodwhale.cn/woodwhale.png",link:"https://www.woodwhale.cn",description:"全栈神"},{name:"Xunflash",avatar:"https://www.xunflash.top/icon.png",link:"https://www.xunflash.top/",description:"澳爷"},{name:"bi0x",avatar:"https://blog.bi0x.com/img/avatar.png",link:"https://blog.bi0x.com/",description:"字节👴"},{name:"huanghunr",link:"https://blog.huanghunr.top",avatar:"https://pic.imgdb.cn/item/670b4202d29ded1a8c807e7e.jpg",description:"喵喵喵?!还没想好"},{name:"温婳霂",link:"https://somokel.github.io",avatar:"https://s2.loli.net/2024/10/21/GixfX61nsPMkN4r.jpg",description:"春祺夏安，秋绥冬宁。"}]},version:"4.2.2"},KEEP.language_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},KEEP.language_code_block={copy:"复制代码",copied:"已复制",fold:"折叠代码块",folded:"已折叠"},KEEP.language_copy_copyright={copy:"复制版权信息",copied:"已复制",title:"原文标题",author:"原文作者",link:"原文链接"}</script><meta name=generator content="Hexo 7.3.0"><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body><div class=progress-bar-container><span class=scroll-progress-bar></span> <span class=pjax-progress-bar></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container border-box"><div class="page-main-content border-box"><div class=page-main-content-top><header class=header-wrapper><div class="border-box header-content"><div class="left flex-start border-box"><a class="logo-image border-box" href=/ ><img src=/images/logo.png> </a><a class="site-name border-box" href=/ >Carbo</a></div><div class="right border-box"><div class="pc border-box"><ul class="menu-list border-box"><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/ ><i class="menu-text-color menu-icon fa-solid fa-home"></i> 首页</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/tags><i class="menu-text-color menu-icon fa-solid fa-tags"></i> 标签</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/links><i class="menu-text-color menu-icon fa-solid fa-link"></i> 友链</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/about><i class="menu-text-color menu-icon fa-solid fa-user-graduate"></i> 关于</a></li><li class="menu-item search search-popup-trigger"><i class="menu-text-color fas search fa-search"></i></li></ul></div><div class="mobile border-box flex-start"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class=menu-bar-middle></div></div></div></div></div><div class=header-drawer><ul class="drawer-menu-list border-box"><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/ ><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i> </span>首页</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/tags><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i> </span>标签</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/links><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-link"></i> </span>友链</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/about><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-user-graduate"></i> </span>关于</a></label></li></ul></div><div class=window-mask></div></header></div><div class="page-main-content-middle border-box"><div class="main-content border-box"><div class=fade-in-down-animation><div class="post-page-container border-box"><div class="post-content-container border-box"><div class="post-content-bottom border-box"><div class=post-title>2024 强网杯 - Reverse</div><div class="post-header border-box"><div class="avatar-box border-box"><img src=/images/avatar.png></div><div class=info-box><div class="author border-box"><span class=name>carbofish</span></div><div class="meta-info border-box"><div class="post-meta-info-container border-box post"><div class="post-meta-info border-box"><span class="meta-info-item post-create-date"><i class="icon fa-solid fa-calendar-plus"></i>&nbsp; <span class=datetime>2024-11-07 19:00:00</span> </span><span class="meta-info-item post-update-date"><i class="icon fa-solid fa-file-pen"></i>&nbsp; <span class=datetime data-updated="Mon Nov 18 2024 16:47:53 GMT+0800">2024-11-18 16:47:53</span> </span><span class="post-tag meta-info-item border-box"><ul class=post-tag-ul><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/Reverse/ >Reverse</a></li></ul></span><span class="meta-info-item post-wordcount"><i class="icon fas fa-file-word"></i>&nbsp;<span>4.6k 字</span> </span><span class="meta-info-item post-min2read"><i class="icon fas fa-clock"></i>&nbsp;<span>25 分钟</span> </span><span class="meta-info-item post-pv"><i class="icon fas fa-eye"></i>&nbsp;<span id=vercount_value_page_pv></span></span></div></div></div></div></div><div class="post-content keep-markdown-body"><p><code>2024 强网杯 Reverse 方向 Writes UP</code></p><span id=more></span><p>强网的题目还是不错的，不过可惜的是 mips 这题有点手慢了，吃饭前还只有1解，吃完饭就3解了，只能拿个四血了 :(<br>下次再接再厉~</p><h3 id=boxx><a href=#boxx class=headerlink title=boxx></a>boxx</h3><p>游戏题</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>flag是每个关卡中每个箱子移动的最短的次数拼接的md5码值和几个字符，1.flag{四个字符_md5值}，2.注意同一张图箱子不一定只有一个哦3.同一关需要计算所有箱子的总的最小移动次数，将每一关的最短次数拼接  解释：例如第一关是3第二关是5，就是md5(35...)</span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241103200519596 data-src=https://s3.carbo.ink/img/imgs/image-20241103200519596.png></p><p>这是地图数组，14 张 20*20 的地图，</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br></pre></td><td class=code><pre><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # #                     # # # # # # #</span><br><span class=line># # #   # # # # # # # #   # # # # # # #</span><br><span class=line># # #   # # # # # # # #   # # # # # # #</span><br><span class=line># # #   # # # # # # # #   # # # # # # #</span><br><span class=line># # #   # # # # # # # #   # # # # # # #</span><br><span class=line># # #   # # # # # # # #   # # # # # # #</span><br><span class=line># # #                     # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # #   # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line></span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># #   # # # #   # # # #   # # # # # # #</span><br><span class=line># #   # # # #   # # # #   # # # # # # #</span><br><span class=line># #   # # # #   # # # #   # # # # # # #</span><br><span class=line># #   # # # #   # # # #   # # # # # # #</span><br><span class=line># #   # # # #   # # # #   # # # # # # #</span><br><span class=line># # #   # # #   # # #   # # # # # # # #</span><br><span class=line># # #   # # #   # # #   # # # # # # # #</span><br><span class=line># # #   # #   #   #   # # # # # # # # #</span><br><span class=line># # # #   #   #   #   # # # # # # # # #</span><br><span class=line># # # #   #   #   #   # # # # # # # # #</span><br><span class=line># # # # #   # # #   # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line></span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # #   # # # # # # # # # # # # # # # #</span><br><span class=line># # #   # # # # # # # # # # # # # # # #</span><br><span class=line># # #   # # # # # # # # # # # # # # # #</span><br><span class=line># # #   # # # # # # # # # # # # # # # #</span><br><span class=line># # #   # # # # # # # # # # # # # # # #</span><br><span class=line># # #                   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #   # # # # # # #   # # # # # # # #</span><br><span class=line># # #                   # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line></span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # #           # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #   # # #   # # # # # # # #</span><br><span class=line># # # # # # #           # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # #       # # # # # # # # #</span><br><span class=line># # # # # # # #   #   # # # # # # # # #</span><br><span class=line># # # # # # # #   #   # # # # # # # # #</span><br><span class=line># # # # # # # #       # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br><span class=line># # # # # # # # # # # # # # # # # # # #</span><br></pre></td></tr></table></figure><p>主程序中只用到了前9张地图，后四张地图打印出来就是上面说的四个字母 <code>qwb!</code><br>然后写一个脚本来解每张地图</p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"bits/stdc++.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"map2.h"</span></span></span><br><span class=line><span class=keyword>using</span> <span class=keyword>namespace</span> std;</span><br><span class=line></span><br><span class=line><span class=type>const</span> <span class=type>int</span> dx[] = {<span class=number>-1</span>, <span class=number>1</span>, <span class=number>0</span>, <span class=number>0</span>};</span><br><span class=line><span class=type>const</span> <span class=type>int</span> dy[] = {<span class=number>0</span>, <span class=number>0</span>, <span class=number>-1</span>, <span class=number>1</span>};</span><br><span class=line></span><br><span class=line><span class=keyword>struct</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=type>int</span> playerX, playerY;</span><br><span class=line>    vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; boxes;</span><br><span class=line></span><br><span class=line>    <span class=type>bool</span> <span class=keyword>operator</span>&lt;(<span class=type>const</span> State &amp;other) <span class=type>const</span> {</span><br><span class=line>        <span class=keyword>if</span> (playerX != other.playerX) <span class=keyword>return</span> playerX &lt; other.playerX;</span><br><span class=line>        <span class=keyword>if</span> (playerY != other.playerY) <span class=keyword>return</span> playerY &lt; other.playerY;</span><br><span class=line>        <span class=keyword>return</span> boxes &lt; other.boxes;</span><br><span class=line>    }</span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SokobanSolver</span> {</span><br><span class=line><span class=keyword>private</span>:</span><br><span class=line>    vector&lt;vector&lt;<span class=type>int</span>&gt;&gt; map;</span><br><span class=line>    <span class=type>int</span> n, m;</span><br><span class=line>    vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; targets;</span><br><span class=line>    State initialState;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span>:</span><br><span class=line>    <span class=built_in>SokobanSolver</span>(vector&lt;vector&lt;<span class=type>int</span>&gt;&gt; &amp;gameMap) {</span><br><span class=line>        map = gameMap;</span><br><span class=line>        n = map.<span class=built_in>size</span>();</span><br><span class=line>        m = map[<span class=number>0</span>].<span class=built_in>size</span>();</span><br><span class=line>        <span class=built_in>findInitialState</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function><span class=type>void</span> <span class=title>findInitialState</span><span class=params>()</span> </span>{</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; n; i++) {</span><br><span class=line>            <span class=keyword>for</span> (<span class=type>int</span> j = <span class=number>0</span>; j &lt; m; j++) {</span><br><span class=line>                <span class=keyword>if</span> (map[i][j] == <span class=number>2</span>) {</span><br><span class=line>                    initialState.playerX = i;</span><br><span class=line>                    initialState.playerY = j;</span><br><span class=line>                    map[i][j] = <span class=number>0</span>;</span><br><span class=line>                } <span class=keyword>else</span> <span class=keyword>if</span> (map[i][j] == <span class=number>3</span>) {</span><br><span class=line>                    initialState.boxes.<span class=built_in>push_back</span>({i, j});</span><br><span class=line>                    map[i][j] = <span class=number>0</span>;</span><br><span class=line>                } <span class=keyword>else</span> <span class=keyword>if</span> (map[i][j] == <span class=number>4</span>) {</span><br><span class=line>                    targets.<span class=built_in>push_back</span>({i, j});</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function><span class=type>bool</span> <span class=title>isValid</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span> </span>{</span><br><span class=line>        <span class=keyword>return</span> x &gt;= <span class=number>0</span> &amp;&amp; x &lt; n &amp;&amp; y &gt;= <span class=number>0</span> &amp;&amp; y &lt; m &amp;&amp; map[x][y] != <span class=number>1</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function><span class=type>bool</span> <span class=title>hasBox</span><span class=params>(<span class=type>const</span> vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; &amp;boxes, <span class=type>int</span> x, <span class=type>int</span> y)</span> </span>{</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>find</span>(boxes.<span class=built_in>begin</span>(), boxes.<span class=built_in>end</span>(), <span class=built_in>make_pair</span>(x, y)) != boxes.<span class=built_in>end</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function>vector&lt;<span class=type>int</span>&gt; <span class=title>calculateMinPushes</span><span class=params>()</span> </span>{</span><br><span class=line>        vector&lt;<span class=type>int</span>&gt; result;</span><br><span class=line>        std::map&lt;State, <span class=type>int</span>&gt; visited;</span><br><span class=line>        queue&lt;State&gt; q;</span><br><span class=line></span><br><span class=line></span><br><span class=line>        q.<span class=built_in>push</span>(initialState);</span><br><span class=line>        visited[initialState] = <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>        <span class=keyword>while</span> (!q.<span class=built_in>empty</span>()) {</span><br><span class=line>            State current = q.<span class=built_in>front</span>();</span><br><span class=line>            q.<span class=built_in>pop</span>();</span><br><span class=line>            <span class=type>int</span> steps = visited[current];</span><br><span class=line></span><br><span class=line>            <span class=type>bool</span> allBoxesOnTarget = <span class=literal>true</span>;</span><br><span class=line>            <span class=keyword>for</span> (<span class=type>const</span> <span class=keyword>auto</span> &amp;box: current.boxes) {</span><br><span class=line>                <span class=type>bool</span> onTarget = <span class=literal>false</span>;</span><br><span class=line>                <span class=keyword>for</span> (<span class=type>const</span> <span class=keyword>auto</span> &amp;target: targets) {</span><br><span class=line>                    <span class=keyword>if</span> (box == target) {</span><br><span class=line>                        onTarget = <span class=literal>true</span>;</span><br><span class=line>                        <span class=keyword>break</span>;</span><br><span class=line>                    }</span><br><span class=line>                }</span><br><span class=line>                <span class=keyword>if</span> (!onTarget) {</span><br><span class=line>                    allBoxesOnTarget = <span class=literal>false</span>;</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=keyword>if</span> (allBoxesOnTarget) {</span><br><span class=line>                <span class=keyword>return</span> {steps};</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=keyword>for</span> (<span class=type>int</span> dir = <span class=number>0</span>; dir &lt; <span class=number>4</span>; dir++) {</span><br><span class=line>                <span class=type>int</span> newPlayerX = current.playerX + dx[dir];</span><br><span class=line>                <span class=type>int</span> newPlayerY = current.playerY + dy[dir];</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span> (!<span class=built_in>isValid</span>(newPlayerX, newPlayerY)) <span class=keyword>continue</span>;</span><br><span class=line></span><br><span class=line>                vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; newBoxes = current.boxes;</span><br><span class=line>                <span class=type>bool</span> pushed = <span class=literal>false</span>;</span><br><span class=line></span><br><span class=line>                <span class=keyword>for</span> (<span class=keyword>auto</span> &amp;box: newBoxes) {</span><br><span class=line>                    <span class=keyword>if</span> (box.first == newPlayerX &amp;&amp; box.second == newPlayerY) {</span><br><span class=line></span><br><span class=line>                        <span class=type>int</span> newBoxX = box.first + dx[dir];</span><br><span class=line>                        <span class=type>int</span> newBoxY = box.second + dy[dir];</span><br><span class=line></span><br><span class=line>                        <span class=keyword>if</span> (!<span class=built_in>isValid</span>(newBoxX, newBoxY)) <span class=keyword>continue</span>;</span><br><span class=line>                        <span class=keyword>if</span> (<span class=built_in>hasBox</span>(newBoxes, newBoxX, newBoxY)) <span class=keyword>continue</span>;</span><br><span class=line></span><br><span class=line>                        box = {newBoxX, newBoxY};</span><br><span class=line>                        pushed = <span class=literal>true</span>;</span><br><span class=line>                        <span class=keyword>break</span>;</span><br><span class=line>                    }</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>                State newState = {newPlayerX, newPlayerY, newBoxes};</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span> (visited.<span class=built_in>find</span>(newState) == visited.<span class=built_in>end</span>()) {</span><br><span class=line>                    visited[newState] = steps + (pushed ? <span class=number>1</span> : <span class=number>0</span>);</span><br><span class=line>                    q.<span class=built_in>push</span>(newState);</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> {<span class=number>-1</span>};</span><br><span class=line>    }</span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=function><span class=type>void</span> <span class=title>convert_1d_to_3d</span><span class=params>(<span class=type>int</span> map_22_1d[], <span class=type>int</span> map_22_3d[<span class=number>14</span>][<span class=number>20</span>][<span class=number>20</span>])</span> </span>{</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>14</span>; i++) {</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> j = <span class=number>0</span>; j &lt; <span class=number>20</span>; j++) {</span><br><span class=line>            <span class=keyword>for</span> (<span class=type>int</span> k = <span class=number>0</span>; k &lt; <span class=number>20</span>; k++) {</span><br><span class=line>                <span class=type>int</span> index = i * (<span class=number>20</span> * <span class=number>20</span>) + j * <span class=number>20</span> + k;</span><br><span class=line>                <span class=keyword>if</span> (index &lt; <span class=number>5600</span>) {</span><br><span class=line>                    map_22_3d[i][j][k] = map_22_1d[index];</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=type>int</span> mapX[<span class=number>14</span>][<span class=number>20</span>][<span class=number>20</span>];</span><br><span class=line></span><br><span class=line><span class=function><span class=type>int</span> <span class=title>main</span><span class=params>()</span> </span>{</span><br><span class=line>    <span class=built_in>convert_1d_to_3d</span>(map_22, mapX);</span><br><span class=line>    vector&lt;vector&lt;<span class=type>int</span>&gt;&gt; mapX2 = vector&lt;vector&lt;<span class=type>int</span>&gt;&gt;(<span class=number>20</span>, <span class=built_in>vector</span>&lt;<span class=type>int</span>&gt;(<span class=number>20</span>));</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> k = <span class=number>0</span>; k &lt;= <span class=number>8</span>; ++k) {</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>20</span>; ++i) {</span><br><span class=line>            <span class=keyword>for</span> (<span class=type>int</span> j = <span class=number>0</span>; j &lt; <span class=number>20</span>; ++j) {</span><br><span class=line>                <span class=type>int</span> code = mapX[k][i][j];</span><br><span class=line>                mapX2[i][j] = code;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=function>SokobanSolver <span class=title>solver</span><span class=params>(mapX2)</span></span>;</span><br><span class=line>        vector&lt;<span class=type>int</span>&gt; result = solver.<span class=built_in>calculateMinPushes</span>();</span><br><span class=line></span><br><span class=line>        cout &lt;&lt; <span class=string>"case "</span> &lt;&lt; k &lt;&lt; <span class=string>" "</span>;</span><br><span class=line>        <span class=keyword>if</span> (result[<span class=number>0</span>] == <span class=number>-1</span>) {</span><br><span class=line>            cout &lt;&lt; <span class=string>"no solution"</span> &lt;&lt; endl;</span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            cout &lt;&lt; <span class=string>"at least "</span> &lt;&lt; result[<span class=number>0</span>] &lt;&lt; <span class=string>" times"</span> &lt;&lt; endl;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/*</span></span><br><span class=line><span class=comment>case 0 at least 2 times</span></span><br><span class=line><span class=comment>case 1 at least 12 times</span></span><br><span class=line><span class=comment>case 2 at least 13 times</span></span><br><span class=line><span class=comment>case 3 at least 9 times</span></span><br><span class=line><span class=comment>case 4 at least 21 times</span></span><br><span class=line><span class=comment>case 5 at least 13 times</span></span><br><span class=line><span class=comment>case 6 at least 25 times</span></span><br><span class=line><span class=comment>case 7 at least 31 times</span></span><br><span class=line><span class=comment>case 8 at least 3 times</span></span><br><span class=line><span class=comment>*/</span></span><br><span class=line></span><br><span class=line><span class=comment>// 212139211325313</span></span><br><span class=line><span class=comment>// qwb!_fec2d316d20dbacbe0cdff8fb6ff07b9</span></span><br><span class=line></span><br></pre></td></tr></table></figure><h3 id=斯内克><a href=#斯内克 class=headerlink title=斯内克></a>斯内克</h3><p>又是一个游戏题，通过 <code>Game over!</code> 定位到最终的比对函数哪里</p><p><img lazyload="" alt=image-20241103201303955 data-src=https://s3.carbo.ink/img/imgs/image-20241103201303955.png></p><p>发现有个 md5 散列和比较，然后还有调用，猜测是个 smc<br>对着 LpAddress 交叉引用发现有一个函数根据按下的按键修改 lpAdress 下的内容<br>得到 smc 解密的目标散列值 <code>9c06c08f882d7981e91d663364ce5e2e</code></p><p><img lazyload="" alt=image-20241103201341052 data-src=https://s3.carbo.ink/img/imgs/image-20241103201341052.png></p><p>在这里找到了随机数种子 <code>0xDEADBEEF</code>，同时也确定了这就是个根据你的输入内容解密的smc</p><p><img lazyload="" alt=image-20241103201649369 data-src=https://s3.carbo.ink/img/imgs/image-20241103201649369.png></p><p>题目提示 <code>需要选手的操作序列最短</code>，也就是蛇转方向要尽可能的少，搓一个脚本利用 启发式和A*算法 算出蛇的最优转头路线，然后爆破果子的个数，发现枚举到第10个果子的时候 lpAdress 内容的散列值刚好是预期的</p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br><span class=line>225</span><br><span class=line>226</span><br><span class=line>227</span><br><span class=line>228</span><br><span class=line>229</span><br><span class=line>230</span><br><span class=line>231</span><br><span class=line>232</span><br><span class=line>233</span><br><span class=line>234</span><br><span class=line>235</span><br><span class=line>236</span><br><span class=line>237</span><br><span class=line>238</span><br><span class=line>239</span><br><span class=line>240</span><br><span class=line>241</span><br><span class=line>242</span><br><span class=line>243</span><br><span class=line>244</span><br><span class=line>245</span><br><span class=line>246</span><br><span class=line>247</span><br><span class=line>248</span><br><span class=line>249</span><br><span class=line>250</span><br><span class=line>251</span><br><span class=line>252</span><br><span class=line>253</span><br><span class=line>254</span><br><span class=line>255</span><br><span class=line>256</span><br><span class=line>257</span><br><span class=line>258</span><br><span class=line>259</span><br><span class=line>260</span><br><span class=line>261</span><br><span class=line>262</span><br><span class=line>263</span><br><span class=line>264</span><br><span class=line>265</span><br><span class=line>266</span><br><span class=line>267</span><br><span class=line>268</span><br><span class=line>269</span><br><span class=line>270</span><br><span class=line>271</span><br><span class=line>272</span><br><span class=line>273</span><br><span class=line>274</span><br><span class=line>275</span><br><span class=line>276</span><br><span class=line>277</span><br><span class=line>278</span><br><span class=line>279</span><br><span class=line>280</span><br><span class=line>281</span><br><span class=line>282</span><br><span class=line>283</span><br><span class=line>284</span><br><span class=line>285</span><br><span class=line>286</span><br><span class=line>287</span><br><span class=line>288</span><br><span class=line>289</span><br><span class=line>290</span><br><span class=line>291</span><br><span class=line>292</span><br><span class=line>293</span><br><span class=line>294</span><br><span class=line>295</span><br><span class=line>296</span><br><span class=line>297</span><br><span class=line>298</span><br><span class=line>299</span><br><span class=line>300</span><br><span class=line>301</span><br><span class=line>302</span><br><span class=line>303</span><br><span class=line>304</span><br><span class=line>305</span><br><span class=line>306</span><br><span class=line>307</span><br><span class=line>308</span><br><span class=line>309</span><br><span class=line>310</span><br><span class=line>311</span><br><span class=line>312</span><br><span class=line>313</span><br><span class=line>314</span><br><span class=line>315</span><br><span class=line>316</span><br><span class=line>317</span><br><span class=line>318</span><br><span class=line>319</span><br><span class=line>320</span><br><span class=line>321</span><br><span class=line>322</span><br><span class=line>323</span><br><span class=line>324</span><br><span class=line>325</span><br><span class=line>326</span><br><span class=line>327</span><br><span class=line>328</span><br><span class=line>329</span><br><span class=line>330</span><br><span class=line>331</span><br><span class=line>332</span><br><span class=line>333</span><br><span class=line>334</span><br><span class=line>335</span><br><span class=line>336</span><br><span class=line>337</span><br><span class=line>338</span><br><span class=line>339</span><br><span class=line>340</span><br><span class=line>341</span><br><span class=line>342</span><br><span class=line>343</span><br><span class=line>344</span><br><span class=line>345</span><br><span class=line>346</span><br><span class=line>347</span><br><span class=line>348</span><br><span class=line>349</span><br><span class=line>350</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"bits/stdc++.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"md5.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"defs.h"</span></span></span><br><span class=line><span class=keyword>using</span> <span class=keyword>namespace</span> std;</span><br><span class=line></span><br><span class=line><span class=keyword>enum</span> <span class="title class_">Direction</span> {</span><br><span class=line>    UP,     <span class=comment>// W</span></span><br><span class=line>    DOWN,   <span class=comment>// S</span></span><br><span class=line>    LEFT,   <span class=comment>// A</span></span><br><span class=line>    RIGHT   <span class=comment>// D</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=keyword>struct</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=type>int</span> x, y;           <span class=comment>// 蛇头位置</span></span><br><span class=line>    Direction dir;      <span class=comment>// 当前方向</span></span><br><span class=line>    string path;        <span class=comment>// 路径</span></span><br><span class=line>    <span class=type>int</span> fruitIndex;     <span class=comment>// 当前要吃的果子索引</span></span><br><span class=line>    <span class=type>int</span> steps;          <span class=comment>// 步数</span></span><br><span class=line></span><br><span class=line>    <span class=built_in>State</span>(<span class=type>int</span> x, <span class=type>int</span> y, Direction d, string p, <span class=type>int</span> f, <span class=type>int</span> s)</span><br><span class=line>            : <span class=built_in>x</span>(x), <span class=built_in>y</span>(y), <span class=built_in>dir</span>(d), <span class=built_in>path</span>(p), <span class=built_in>fruitIndex</span>(f), <span class=built_in>steps</span>(s) {}</span><br><span class=line></span><br><span class=line>    <span class=type>bool</span> <span class=keyword>operator</span>&lt;(<span class=type>const</span> State&amp; other) <span class=type>const</span> {</span><br><span class=line>        <span class=keyword>if</span> (x != other.x) <span class=keyword>return</span> x &lt; other.x;</span><br><span class=line>        <span class=keyword>if</span> (y != other.y) <span class=keyword>return</span> y &lt; other.y;</span><br><span class=line>        <span class=keyword>if</span> (dir != other.dir) <span class=keyword>return</span> dir &lt; other.dir;</span><br><span class=line>        <span class=keyword>return</span> fruitIndex &lt; other.fruitIndex;</span><br><span class=line>    }</span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SnakePathFinder</span> {</span><br><span class=line><span class=keyword>private</span>:</span><br><span class=line>    <span class=type>const</span> <span class=type>int</span> SIZE = <span class=number>20</span>;</span><br><span class=line>    vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; fruits;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=type>bool</span> <span class=title>isValid</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span> </span>{</span><br><span class=line>        <span class=keyword>return</span> x &gt;= <span class=number>0</span> &amp;&amp; x &lt; SIZE &amp;&amp; y &gt;= <span class=number>0</span> &amp;&amp; y &lt; SIZE;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function>Direction <span class=title>getOppositeDirection</span><span class=params>(Direction dir)</span> </span>{</span><br><span class=line>        <span class=keyword>switch</span>(dir) {</span><br><span class=line>            <span class=keyword>case</span> UP: <span class=keyword>return</span> DOWN;</span><br><span class=line>            <span class=keyword>case</span> DOWN: <span class=keyword>return</span> UP;</span><br><span class=line>            <span class=keyword>case</span> LEFT: <span class=keyword>return</span> RIGHT;</span><br><span class=line>            <span class=keyword>case</span> RIGHT: <span class=keyword>return</span> LEFT;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> UP;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function><span class=type>char</span> <span class=title>getDirectionChar</span><span class=params>(Direction dir)</span> </span>{</span><br><span class=line>        <span class=keyword>switch</span>(dir) {</span><br><span class=line>            <span class=keyword>case</span> UP: <span class=keyword>return</span> <span class=string>'W'</span>;</span><br><span class=line>            <span class=keyword>case</span> DOWN: <span class=keyword>return</span> <span class=string>'S'</span>;</span><br><span class=line>            <span class=keyword>case</span> LEFT: <span class=keyword>return</span> <span class=string>'A'</span>;</span><br><span class=line>            <span class=keyword>case</span> RIGHT: <span class=keyword>return</span> <span class=string>'D'</span>;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=string>'W'</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function>pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt; <span class=title>moveInDirection</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y, Direction dir)</span> </span>{</span><br><span class=line>        <span class=keyword>switch</span>(dir) {</span><br><span class=line>            <span class=keyword>case</span> UP: <span class=keyword>return</span> {x<span class=number>-1</span>, y};</span><br><span class=line>            <span class=keyword>case</span> DOWN: <span class=keyword>return</span> {x<span class=number>+1</span>, y};</span><br><span class=line>            <span class=keyword>case</span> LEFT: <span class=keyword>return</span> {x, y<span class=number>-1</span>};</span><br><span class=line>            <span class=keyword>case</span> RIGHT: <span class=keyword>return</span> {x, y<span class=number>+1</span>};</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> {x, y};</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 优化后的启发式估计函数</span></span><br><span class=line>    <span class=function><span class=type>int</span> <span class=title>estimateRemainingSteps</span><span class=params>(<span class=type>const</span> State&amp; state)</span> </span>{</span><br><span class=line>        <span class=keyword>if</span> (state.fruitIndex &gt;= fruits.<span class=built_in>size</span>()) <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>        <span class=type>int</span> totalEstimate = <span class=number>0</span>;</span><br><span class=line>        <span class=type>int</span> currentX = state.x;</span><br><span class=line>        <span class=type>int</span> currentY = state.y;</span><br><span class=line></span><br><span class=line>        <span class=comment>// 计算到所有剩余果子的最小距离之和</span></span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> i = state.fruitIndex; i &lt; fruits.<span class=built_in>size</span>(); i++) {</span><br><span class=line>            <span class=type>int</span> dx = <span class=built_in>abs</span>(currentX - fruits[i].first);</span><br><span class=line>            <span class=type>int</span> dy = <span class=built_in>abs</span>(currentY - fruits[i].second);</span><br><span class=line></span><br><span class=line>            <span class=comment>// 考虑转向的代价</span></span><br><span class=line>            <span class=keyword>if</span> (i == state.fruitIndex) {</span><br><span class=line>                <span class=type>bool</span> needHorizontalMove = (currentY != fruits[i].second);</span><br><span class=line>                <span class=type>bool</span> needVerticalMove = (currentX != fruits[i].first);</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span> (needHorizontalMove &amp;&amp; needVerticalMove) {</span><br><span class=line>                    <span class=comment>// 如果需要同时在水平和垂直方向移动，至少需要一次转向</span></span><br><span class=line>                    <span class=keyword>if</span> ((state.dir == LEFT || state.dir == RIGHT) &amp;&amp; needVerticalMove) {</span><br><span class=line>                        totalEstimate += <span class=number>1</span>;  <span class=comment>// 考虑转向的代价</span></span><br><span class=line>                    }</span><br><span class=line>                    <span class=keyword>if</span> ((state.dir == UP || state.dir == DOWN) &amp;&amp; needHorizontalMove) {</span><br><span class=line>                        totalEstimate += <span class=number>1</span>;  <span class=comment>// 考虑转向的代价</span></span><br><span class=line>                    }</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            totalEstimate += dx + dy;  <span class=comment>// 曼哈顿距离</span></span><br><span class=line>            currentX = fruits[i].first;</span><br><span class=line>            currentY = fruits[i].second;</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> totalEstimate;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line><span class=keyword>public</span>:</span><br><span class=line>    <span class=built_in>SnakePathFinder</span>(<span class=type>const</span> vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt;&amp; fruitSequence) {</span><br><span class=line>        fruits = fruitSequence;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=function>string <span class=title>findOptimalPath</span><span class=params>(<span class=type>int</span> startX, <span class=type>int</span> startY, Direction startDir)</span> </span>{</span><br><span class=line>        <span class=comment>// 使用优先队列，按照估计的总步数排序</span></span><br><span class=line>        <span class=keyword>auto</span> cmp = [](<span class=type>const</span> State&amp; a, <span class=type>const</span> State&amp; b) {</span><br><span class=line>            <span class=built_in>return</span> (a.steps + a.path.<span class=built_in>length</span>()) &gt; (b.steps + b.path.<span class=built_in>length</span>());</span><br><span class=line>        };</span><br><span class=line>        priority_queue&lt;State, vector&lt;State&gt;, <span class=keyword>decltype</span>(cmp)&gt; <span class=built_in>pq</span>(cmp);</span><br><span class=line></span><br><span class=line>        set&lt;State&gt; visited;</span><br><span class=line>        <span class=function>State <span class=title>initial</span><span class=params>(startX, startY, startDir, <span class=string>""</span>, <span class=number>0</span>, <span class=number>0</span>)</span></span>;</span><br><span class=line>        pq.<span class=built_in>push</span>(initial);</span><br><span class=line>        visited.<span class=built_in>insert</span>(initial);</span><br><span class=line></span><br><span class=line>        <span class=keyword>while</span>(!pq.<span class=built_in>empty</span>()) {</span><br><span class=line>            State current = pq.<span class=built_in>top</span>();</span><br><span class=line>            pq.<span class=built_in>pop</span>();</span><br><span class=line></span><br><span class=line>            <span class=comment>// 如果所有果子都被吃掉</span></span><br><span class=line>            <span class=keyword>if</span>(current.fruitIndex &gt;= fruits.<span class=built_in>size</span>()) {</span><br><span class=line>                <span class=keyword>return</span> current.path;</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=comment>// 如果到达当前目标果子</span></span><br><span class=line>            <span class=keyword>if</span>(current.x == fruits[current.fruitIndex].first &amp;&amp;</span><br><span class=line>               current.y == fruits[current.fruitIndex].second) {</span><br><span class=line>                State nextState = current;</span><br><span class=line>                nextState.fruitIndex++;</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span>(visited.<span class=built_in>find</span>(nextState) == visited.<span class=built_in>end</span>()) {</span><br><span class=line>                    pq.<span class=built_in>push</span>(nextState);</span><br><span class=line>                    visited.<span class=built_in>insert</span>(nextState);</span><br><span class=line>                }</span><br><span class=line>                <span class=keyword>continue</span>;</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=comment>// 尝试所有可能的方向</span></span><br><span class=line>            <span class=keyword>for</span>(<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>4</span>; i++) {</span><br><span class=line>                Direction newDir = <span class=built_in>static_cast</span>&lt;Direction&gt;(i);</span><br><span class=line></span><br><span class=line>                <span class=comment>// 不能直接调头</span></span><br><span class=line>                <span class=keyword>if</span>(newDir == <span class=built_in>getOppositeDirection</span>(current.dir)) {</span><br><span class=line>                    <span class=keyword>continue</span>;</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>                <span class=keyword>auto</span> [newX, newY] = <span class=built_in>moveInDirection</span>(current.x, current.y, newDir);</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span>(!<span class=built_in>isValid</span>(newX, newY)) {</span><br><span class=line>                    <span class=keyword>continue</span>;</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>                string newPath = current.path;</span><br><span class=line>                <span class=keyword>if</span>(newDir != current.dir) {</span><br><span class=line>                    newPath += <span class=built_in>getDirectionChar</span>(newDir);</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>                <span class=function>State <span class=title>newState</span><span class=params>(newX, newY, newDir, newPath,</span></span></span><br><span class=line><span class=params><span class=function>                               current.fruitIndex, current.steps + <span class=number>1</span>)</span></span>;</span><br><span class=line></span><br><span class=line>                <span class=keyword>if</span>(visited.<span class=built_in>find</span>(newState) == visited.<span class=built_in>end</span>()) {</span><br><span class=line>                    pq.<span class=built_in>push</span>(newState);</span><br><span class=line>                    visited.<span class=built_in>insert</span>(newState);</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> <span class=string>"No path found"</span>;</span><br><span class=line>    }</span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>char</span> map_data_orig[<span class=number>1152</span>] = {</span><br><span class=line>        <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0xB0</span>, <span class=number>0x38</span>, <span class=number>0x6D</span>,</span><br><span class=line>        <span class=number>0xEE</span>, <span class=number>0x3F</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x09</span>, <span class=number>0x6A</span>, <span class=number>0xF0</span>, <span class=number>0x38</span>, <span class=number>0x2C</span>, <span class=number>0x79</span>, <span class=number>0xF6</span>, <span class=number>0x34</span>, <span class=number>0xE9</span>, <span class=number>0x89</span>, <span class=number>0x38</span>,</span><br><span class=line>        <span class=number>0xAC</span>, <span class=number>0x7F</span>, <span class=number>0x35</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x6D</span>, <span class=number>0x77</span>, <span class=number>0xF6</span>, <span class=number>0xB6</span>, <span class=number>0x38</span>, <span class=number>0x6D</span>, <span class=number>0x78</span>, <span class=number>0xF6</span>, <span class=number>0xB6</span>,</span><br><span class=line>        <span class=number>0x2B</span>, <span class=number>0x18</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3B</span>, <span class=number>0x81</span>, <span class=number>0x81</span>, <span class=number>0x81</span>, <span class=number>0x81</span>, <span class=number>0xEF</span>, <span class=number>0x4E</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0x7D</span>, <span class=number>0xF6</span>,</span><br><span class=line>        <span class=number>0x33</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB0</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB0</span>, <span class=number>0xE8</span>, <span class=number>0xF6</span>, <span class=number>0x2B</span>, <span class=number>0x27</span>,</span><br><span class=line>        <span class=number>0xA3</span>, <span class=number>0x1D</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xB4</span>, <span class=number>0xB0</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x38</span>, <span class=number>0x89</span>,</span><br><span class=line>        <span class=number>0xE3</span>, <span class=number>0xC3</span>, <span class=number>0xCA</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xC4</span>, <span class=number>0xB0</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x38</span>,</span><br><span class=line>        <span class=number>0xB3</span>, <span class=number>0x67</span>, <span class=number>0xE3</span>, <span class=number>0x16</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xD4</span>, <span class=number>0xB0</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>,</span><br><span class=line>        <span class=number>0x38</span>, <span class=number>0xB6</span>, <span class=number>0xD3</span>, <span class=number>0xB6</span>, <span class=number>0xA9</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xE4</span>, <span class=number>0xB0</span>, <span class=number>0xF8</span>,</span><br><span class=line>        <span class=number>0x04</span>, <span class=number>0x38</span>, <span class=number>0x89</span>, <span class=number>0xD8</span>, <span class=number>0xC7</span>, <span class=number>0x33</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xB4</span>, <span class=number>0x2B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0xED</span>, <span class=number>0xB5</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xC4</span>, <span class=number>0x2B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xC4</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0xED</span>, <span class=number>0xB5</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xD4</span>, <span class=number>0x2B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xD4</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0xED</span>, <span class=number>0xB5</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xE4</span>, <span class=number>0x2B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xE4</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0xED</span>, <span class=number>0xB5</span>, <span class=number>0xD4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xB0</span>, <span class=number>0xEC</span>, <span class=number>0xFE</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0x6F</span>, <span class=number>0x14</span>, <span class=number>0x4C</span>, <span class=number>0xEC</span>, <span class=number>0xFE</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x2F</span>, <span class=number>0xC0</span>, <span class=number>0x2C</span>, <span class=number>0xEC</span>, <span class=number>0xFE</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xCC</span>, <span class=number>0x6C</span>, <span class=number>0xFE</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB6</span>, <span class=number>0x24</span>, <span class=number>0xCC</span>, <span class=number>0x72</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xB4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xC4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0xD2</span>, <span class=number>0xF4</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>, <span class=number>0xC4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF9</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x04</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>,</span><br><span class=line>        <span class=number>0xC4</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xE9</span>, <span class=number>0xF4</span>, <span class=number>0xCC</span>, <span class=number>0xE2</span>, <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0xE1</span>, <span class=number>0x4C</span>, <span class=number>0xF9</span>, <span class=number>0xED</span>,</span><br><span class=line>        <span class=number>0x38</span>, <span class=number>0xF8</span>, <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0xF8</span>, <span class=number>0xE4</span>, <span class=number>0xE0</span>, <span class=number>0xA8</span>, <span class=number>0x4C</span>, <span class=number>0xC1</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x04</span>,</span><br><span class=line>        <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xB4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>,</span><br><span class=line>        <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF6</span>, <span class=number>0x4C</span>, <span class=number>0x69</span>, <span class=number>0xF4</span>, <span class=number>0xE4</span>, <span class=number>0x40</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xC4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0xD2</span>, <span class=number>0xF4</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF9</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x04</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xE9</span>, <span class=number>0xF4</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x64</span>, <span class=number>0xCC</span>, <span class=number>0xE2</span>, <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0xE1</span>,</span><br><span class=line>        <span class=number>0x4C</span>, <span class=number>0xF9</span>, <span class=number>0xED</span>, <span class=number>0x38</span>, <span class=number>0xF8</span>, <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0xF8</span>, <span class=number>0xE4</span>, <span class=number>0xE0</span>, <span class=number>0xA8</span>, <span class=number>0x4C</span>, <span class=number>0xC1</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>,</span><br><span class=line>        <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xC4</span>, <span class=number>0x2C</span>,</span><br><span class=line>        <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x52</span>, <span class=number>0x54</span>, <span class=number>0x2F</span>, <span class=number>0x2F</span>, <span class=number>0x2F</span>, <span class=number>0xB0</span>, <span class=number>0xEC</span>, <span class=number>0x00</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x6F</span>, <span class=number>0x14</span>, <span class=number>0x4C</span>, <span class=number>0xEC</span>, <span class=number>0x00</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x2F</span>, <span class=number>0xC0</span>, <span class=number>0x2C</span>, <span class=number>0xEC</span>, <span class=number>0x00</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xCC</span>, <span class=number>0x6C</span>, <span class=number>0x00</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB6</span>, <span class=number>0x24</span>, <span class=number>0xCC</span>, <span class=number>0x72</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xD4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>,</span><br><span class=line>        <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0xD2</span>, <span class=number>0xF4</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>,</span><br><span class=line>        <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0xF9</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x04</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>,</span><br><span class=line>        <span class=number>0x4A</span>, <span class=number>0xE1</span>, <span class=number>0xE4</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xE9</span>, <span class=number>0xF4</span>, <span class=number>0xCC</span>, <span class=number>0xE2</span>, <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0xE1</span>, <span class=number>0x4C</span>,</span><br><span class=line>        <span class=number>0xF9</span>, <span class=number>0xED</span>, <span class=number>0x38</span>, <span class=number>0xF8</span>, <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0xF8</span>, <span class=number>0xE4</span>, <span class=number>0xE0</span>, <span class=number>0xA8</span>, <span class=number>0x4C</span>, <span class=number>0xC1</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0xE4</span>,</span><br><span class=line>        <span class=number>0x79</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>,</span><br><span class=line>        <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF6</span>, <span class=number>0x4C</span>, <span class=number>0x69</span>, <span class=number>0xF4</span>, <span class=number>0xE4</span>, <span class=number>0x40</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0x3B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xE4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>,</span><br><span class=line>        <span class=number>0xD4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0xD2</span>, <span class=number>0xF4</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xE1</span>,</span><br><span class=line>        <span class=number>0xD4</span>, <span class=number>0x4C</span>, <span class=number>0xF9</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x04</span>, <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0x5B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>,</span><br><span class=line>        <span class=number>0x4A</span>, <span class=number>0xE1</span>, <span class=number>0xD4</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x05</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xE9</span>, <span class=number>0xF4</span>, <span class=number>0xD0</span>, <span class=number>0x62</span>, <span class=number>0x64</span>, <span class=number>0xCC</span>, <span class=number>0xE2</span>, <span class=number>0xE4</span>,</span><br><span class=line>        <span class=number>0x4C</span>, <span class=number>0xE1</span>, <span class=number>0x4C</span>, <span class=number>0xF9</span>, <span class=number>0xED</span>, <span class=number>0x38</span>, <span class=number>0xF8</span>, <span class=number>0x4C</span>, <span class=number>0xE8</span>, <span class=number>0xF4</span>, <span class=number>0xF8</span>, <span class=number>0xE4</span>, <span class=number>0xE0</span>, <span class=number>0xA8</span>, <span class=number>0x4C</span>, <span class=number>0xC1</span>,</span><br><span class=line>        <span class=number>0xE3</span>, <span class=number>0x60</span>, <span class=number>0xE4</span>, <span class=number>0x79</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>,</span><br><span class=line>        <span class=number>0xE4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x52</span>, <span class=number>0x54</span>, <span class=number>0x2F</span>, <span class=number>0x2F</span>, <span class=number>0x2F</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>,</span><br><span class=line>        <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xB4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xD4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>,</span><br><span class=line>        <span class=number>0x4C</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0xE3</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xB4</span>, <span class=number>0x2C</span>,</span><br><span class=line>        <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xC4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xE4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0xE3</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>,</span><br><span class=line>        <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xC4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xE4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xB4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>,</span><br><span class=line>        <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0xE3</span>, <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>,</span><br><span class=line>        <span class=number>0xE4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x3B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0xC0</span>, <span class=number>0xC4</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xD4</span>, <span class=number>0x4C</span>, <span class=number>0x79</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0x4C</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0xE3</span>,</span><br><span class=line>        <span class=number>0xD0</span>, <span class=number>0x2B</span>, <span class=number>0xF4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x38</span>, <span class=number>0x4A</span>, <span class=number>0x50</span>, <span class=number>0xD4</span>, <span class=number>0x2C</span>, <span class=number>0xF8</span>, <span class=number>0x85</span>, <span class=number>0x37</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>,</span><br><span class=line>        <span class=number>0x42</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3D</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x52</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xBE</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x62</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x51</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x6F</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3D</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x7F</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0x5B</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x12</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x8D</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x22</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x65</span>, <span class=number>0xA0</span>,</span><br><span class=line>        <span class=number>0xEC</span>, <span class=number>0x32</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xA7</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xBF</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x4D</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xCF</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xAC</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xDF</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xF8</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xEF</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0xB4</span>, <span class=number>0x06</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xFF</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xE9</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x8F</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x3B</span>,</span><br><span class=line>        <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0x9F</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xA3</span>, <span class=number>0xA0</span>, <span class=number>0xEC</span>, <span class=number>0xAF</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x31</span>, <span class=number>0xB0</span>, <span class=number>0xEC</span>,</span><br><span class=line>        <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x6F</span>, <span class=number>0x14</span>, <span class=number>0x4C</span>, <span class=number>0xEC</span>, <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>,</span><br><span class=line>        <span class=number>0x2F</span>, <span class=number>0xC0</span>, <span class=number>0x2C</span>, <span class=number>0xEC</span>, <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xCC</span>, <span class=number>0x6C</span>, <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB5</span>, <span class=number>0x68</span>,</span><br><span class=line>        <span class=number>0xE6</span>, <span class=number>0x38</span>, <span class=number>0xCA</span>, <span class=number>0xEC</span>, <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x24</span>, <span class=number>0x1B</span>, <span class=number>0xF8</span>, <span class=number>0x04</span>, <span class=number>0x37</span>, <span class=number>0x38</span>, <span class=number>0xCA</span>, <span class=number>0x6D</span>,</span><br><span class=line>        <span class=number>0xF5</span>, <span class=number>0xC4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x24</span>, <span class=number>0x1B</span>, <span class=number>0x7D</span>, <span class=number>0x85</span>, <span class=number>0x42</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0xB4</span>, <span class=number>0x63</span>, <span class=number>0xD0</span>, <span class=number>0xF7</span>, <span class=number>0xF4</span>,</span><br><span class=line>        <span class=number>0xD3</span>, <span class=number>0xC0</span>, <span class=number>0x6F</span>, <span class=number>0xF4</span>, <span class=number>0x6F</span>, <span class=number>0x00</span>, <span class=number>0xBB</span>, <span class=number>0xC4</span>, <span class=number>0x38</span>, <span class=number>0x4C</span>, <span class=number>0x3F</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span>, <span class=number>0xBD</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line>uint8 *map_data;</span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>char</span> tmp_map[<span class=number>1152</span>]={};</span><br><span class=line></span><br><span class=line><span class=function>std::string <span class=title>charArrayToHex</span><span class=params>(uint8* input, <span class=type>size_t</span> size)</span> </span>{</span><br><span class=line>    std::stringstream hexStream;</span><br><span class=line>    hexStream &lt;&lt; std::hex &lt;&lt; std::<span class=built_in>setfill</span>(<span class=string>'0'</span>);</span><br><span class=line>    <span class=keyword>for</span> (<span class=type>size_t</span> i = <span class=number>0</span>; i &lt; size; ++i) {</span><br><span class=line>        hexStream &lt;&lt; std::<span class=built_in>setw</span>(<span class=number>2</span>) &lt;&lt; <span class=built_in>static_cast</span>&lt;<span class=type>int</span>&gt;(<span class=built_in>static_cast</span>&lt;<span class=type>unsigned</span> <span class=type>char</span>&gt;(input[i]));</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>return</span> hexStream.<span class=built_in>str</span>();</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=function><span class=type>int</span> <span class=title>main</span><span class=params>()</span> </span>{</span><br><span class=line>    <span class=type>int</span> n = <span class=number>1152</span>;</span><br><span class=line></span><br><span class=line>    map_data = (uint8 *) <span class=built_in>malloc</span>(n);</span><br><span class=line></span><br><span class=line>    <span class=type>int</span> rounds = <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>        rounds++;</span><br><span class=line></span><br><span class=line>        <span class=built_in>srand</span>(<span class=number>0xDEADBEEF</span>);</span><br><span class=line>        <span class=built_in>memcpy</span>(map_data, map_data_orig, n);</span><br><span class=line>        <span class=comment>// 测试用例</span></span><br><span class=line>        vector&lt;pair&lt;<span class=type>int</span>, <span class=type>int</span>&gt;&gt; fruits;</span><br><span class=line></span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; rounds; ++i) {</span><br><span class=line>            <span class=type>int</span> y = <span class=built_in>rand</span>() % <span class=number>20</span>;</span><br><span class=line>            <span class=type>int</span> x = <span class=built_in>rand</span>() % <span class=number>20</span>;</span><br><span class=line>            fruits.<span class=built_in>push_back</span>({x, y});</span><br><span class=line><span class=comment>//            cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; "\n";</span></span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=function>SnakePathFinder <span class=title>pathFinder</span><span class=params>(fruits)</span></span>;</span><br><span class=line></span><br><span class=line>        vector&lt;uint8&gt; v;</span><br><span class=line></span><br><span class=line>        v.<span class=built_in>push_back</span>(<span class=number>0x11</span>);</span><br><span class=line>        v.<span class=built_in>push_back</span>(<span class=number>0x12</span>);</span><br><span class=line></span><br><span class=line>        string path = pathFinder.<span class=built_in>findOptimalPath</span>(<span class=number>10</span>, <span class=number>10</span>, RIGHT);</span><br><span class=line></span><br><span class=line>        <span class=keyword>for</span> (<span class=type>char</span> p : path) {</span><br><span class=line>            <span class=keyword>if</span>(p == <span class=string>'D'</span>)</span><br><span class=line>            {</span><br><span class=line>                <span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>;i&lt;n;i++)</span><br><span class=line>                {</span><br><span class=line>                    map_data[i] += <span class=number>30</span>;</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>            }</span><br><span class=line>            <span class=keyword>else</span> <span class=keyword>if</span>(p == <span class=string>'A'</span>){</span><br><span class=line>                <span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>;i&lt;n;i++)</span><br><span class=line>                {</span><br><span class=line>                    tmp_map[i] = map_data[i];</span><br><span class=line></span><br><span class=line>                }</span><br><span class=line>                <span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>;i&lt;n;i++)</span><br><span class=line>                {</span><br><span class=line>                    map_data[i] = tmp_map[(i<span class=number>+6</span>)%n];</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>            <span class=keyword>else</span> <span class=keyword>if</span>(p == <span class=string>'S'</span>)</span><br><span class=line>            {</span><br><span class=line>                <span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>;i&lt;n;i++){</span><br><span class=line>                    map_data[i]=(map_data[i]&gt;&gt;<span class=number>5</span>)|(map_data[i]&lt;&lt;<span class=number>3</span>);</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>            <span class=keyword>else</span> <span class=keyword>if</span>(p == <span class=string>'W'</span>){</span><br><span class=line>                <span class=keyword>for</span>(<span class=type>int</span> i=<span class=number>0</span>;i&lt;n;i++){</span><br><span class=line>                    map_data[i]-=<span class=number>102</span>;</span><br><span class=line>                }</span><br><span class=line></span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        MD5 md5 = <span class=built_in>MD5</span>(map_data, n);</span><br><span class=line>        string hexd = md<span class=number>5.</span><span class=built_in>toStr</span>();</span><br><span class=line></span><br><span class=line>        cout &lt;&lt; <span class=string>"round:"</span> &lt;&lt; rounds &lt;&lt; <span class=string>" way: "</span> &lt;&lt; path &lt;&lt; <span class=string>" md5: "</span> &lt;&lt; hexd &lt;&lt; <span class=string>" "</span>;</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (hexd == <span class=string>"9c06c08f882d7981e91d663364ce5e2e"</span>) {</span><br><span class=line>            cout &lt;&lt; <span class=string>"found it"</span> &lt;&lt;  <span class=string>"\n"</span>;</span><br><span class=line>            cout &lt;&lt; <span class=built_in>charArrayToHex</span>(map_data, n);</span><br><span class=line>            <span class=built_in>exit</span>(<span class=number>0</span>);</span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            cout &lt;&lt; <span class=string>"nop\n"</span>;</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (rounds &gt; <span class=number>1000</span>) <span class=keyword>break</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>}</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line>round:<span class=number>1</span> way: W md5: <span class=number>62</span>c753a165784d502246b51539f63797 nop</span><br><span class=line>round:<span class=number>2</span> way: WAS md5: ddf7a36ef6ee6dfc6dc91aad5d0dd21d nop</span><br><span class=line>round:<span class=number>3</span> way: WASA md5: <span class=number>0</span>f27f5aff365ec905bd9a<span class=number>5e4</span>c60cd8b3 nop</span><br><span class=line>round:<span class=number>4</span> way: WASAWD md5: <span class=number>9581209074985</span>da9fa69047ce954c589 nop</span><br><span class=line>round:<span class=number>5</span> way: WASAWDSA md5: <span class=number>6</span>d87d9bc85ccf<span class=number>44e938</span>dcb242d6baee3 nop</span><br><span class=line>round:<span class=number>6</span> way: WASAWDSAW md5: <span class=number>30e6</span>d405dd4d<span class=number>5e5</span>af6d41f7ec1b1ab43 nop</span><br><span class=line>round:<span class=number>7</span> way: WASAWDSAWD md5: <span class=number>587264015</span>d204347a510bf2c72723097 nop</span><br><span class=line>round:<span class=number>8</span> way: WASAWDSAWDS md5: <span class=number>6e3</span>ab<span class=number>0e912</span>c<span class=number>25e56</span>c4283a011f2d2207 nop</span><br><span class=line>round:<span class=number>9</span> way: WASAWDSAWDSAW md5: <span class=number>0</span>a7b22abe33900efc2ae7f25f9950bb5 nop</span><br><span class=line>round:<span class=number>10</span> way: WASAWDSAWDSAWDS md5: <span class=number>9</span>c06c08f882d<span class=number>7981e91</span>d663364ce<span class=number>5e2</span>e found it</span><br><span class=line><span class=number>48894</span>c240855574881ec18020000488d6c2420488d7c2420b<span class=number>94e000000</span>b8ccccccccf3ab488b8c2438020000c7450400000000c74524b979379eb804000000486bc000c744054857333163b804000000486bc001c7440548306d332eb804000000486bc002c744054820322051b804000000486bc003c744054857427338b804000000486bc000b904000000486bc900488b95100200008b040289440d78b804000000486bc001b904000000486bc901488b95100200008b040289440d78b804000000486bc002b904000000486bc902488b95100200008b040289440d78b804000000486bc003b904000000486bc903488b95100200008b040289440d78c785a400000000000000eb<span class=number>0e8</span>b85a4000000ffc08985a400000083bda4000000200f83db000000b804000000486bc000b904000000486bc9018b4c0d78c<span class=number>1e104</span>ba04000000486bd2018b541578c1ea0533caba04000000486bd201034c15788b<span class=number>550483e2038</span>bd28b549548448b45044403c2418bd033ca034c05788bc1b904000000486bc90089440d788b45248b4d0403c88bc1894504b804000000486bc001b904000000486bc9008b4c0d78c<span class=number>1e104</span>ba04000000486bd2008b541578c1ea0533caba04000000486bd200034c15788b5504c1ea0b<span class=number>83e2038</span>bd28b549548448b45044403c2418bd033ca034c05788bc1b904000000486bc90189440d<span class=number>78e90</span>affffffc785c400000000000000eb<span class=number>0e8</span>b85c4000000ffc08985c400000083bdc4000000200f83db000000b804000000486bc002b904000000486bc9038b4c0d78c<span class=number>1e104</span>ba04000000486bd2038b541578c1ea0533caba04000000486bd203034c15788b<span class=number>550483e2038</span>bd28b549548448b45044403c2418bd033ca034c05788bc1b904000000486bc90289440d788b45248b4d0403c88bc1894504b804000000486bc003b904000000486bc9028b4c0d78c<span class=number>1e104</span>ba04000000486bd2028b541578c1ea0533caba04000000486bd202034c15788b5504c1ea0b<span class=number>83e2038</span>bd28b549548448b45044403c2418bd033ca034c05788bc1b904000000486bc90389440d<span class=number>78e90</span>affffffb804000000486bc000b904000000486bc9028b4c0d788b44057833c1b904000000486bc90089440d78b804000000486bc001b904000000486bc9038b4c0d788b44057833c1b904000000486bc90189440d78b804000000486bc003b904000000486bc9008b4c0d788b44057833c1b904000000486bc90389440d78b804000000486bc001b904000000486bc9028b4c0d788b44057833c1b904000000486bc90289440d78c<span class=number>685e800000098</span>c<span class=number>685e9000000</span>a0c685ea000000d9c685eb00000098c685ec000000bac685ed00000097c685ee0000001bc685ef00000071c685f00000009bc685f100000081c685f200000044c685f30000002fc685f400000055c685f5000000b8c685f600000037c685f7000000dfc7851401000000000000eb<span class=number>0e8</span>b8514010000ffc089851401000083bd14010000107d25486385140100000fbe44057848638d140100000fbe8c0de80000003bc1740432c0eb04ebc4b001488bf890909090909090909090909090909090488bc7488da5f80100005f5dc3</span><br></pre></td></tr></table></figure><p>然后吧解出来内容直接用 IDA 分析，是个魔改 XTea + 异或，主要魔改点就是四个密文，前两个 delta 从 0开始加起，后两组的 delta 从 32 * delta 开始算起</p><p><img lazyload="" alt=image-20241103202351128 data-src=https://s3.carbo.ink/img/imgs/image-20241103202351128.png></p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#<span class=keyword>include</span><span class=string>&lt;stdio.h&gt;</span></span></span><br><span class=line></span><br><span class=line><span class=function><span class=type>int</span> <span class=title>main</span><span class=params>()</span> </span>{</span><br><span class=line>    <span class=type>unsigned</span> <span class=type>int</span> enc[<span class=number>4</span>] = {<span class=number>0x98d9a098</span>,</span><br><span class=line>                           <span class=number>0x711b97ba</span>,</span><br><span class=line>                           <span class=number>0x2f44819b</span>,</span><br><span class=line>                           <span class=number>0xdf37b855</span>};</span><br><span class=line>    <span class=type>int</span> n = <span class=number>4</span>;</span><br><span class=line>    <span class=type>unsigned</span> <span class=type>int</span> key[<span class=number>4</span>] = {<span class=number>0x63313357</span>,</span><br><span class=line>                           <span class=number>0x2e336d30</span>,</span><br><span class=line>                           <span class=number>0x51203220</span>,</span><br><span class=line>                           <span class=number>0x38734257</span>};</span><br><span class=line>    <span class=type>int</span> i, j;</span><br><span class=line>    <span class=type>long</span> sum = <span class=number>0</span>, delta = <span class=number>0x9E3779B9</span>;</span><br><span class=line>    enc[<span class=number>2</span>] ^= enc[<span class=number>1</span>];</span><br><span class=line>    enc[<span class=number>3</span>] ^= enc[<span class=number>0</span>];</span><br><span class=line>    enc[<span class=number>1</span>] ^= enc[<span class=number>3</span>];</span><br><span class=line>    enc[<span class=number>0</span>] ^= enc[<span class=number>2</span>];</span><br><span class=line>    <span class=keyword>for</span> (i = <span class=number>0</span>; i &lt; n; i += <span class=number>2</span>) {</span><br><span class=line>        sum = (<span class=number>32</span> * delta * (i / <span class=number>2</span> + <span class=number>1</span>));</span><br><span class=line>        <span class=keyword>for</span> (j = <span class=number>0</span>; j &lt; <span class=number>32</span>; j++) {</span><br><span class=line>            enc[i + <span class=number>1</span>] -= (((enc[i] &gt;&gt; <span class=number>5</span>) ^ (<span class=number>16</span> * enc[i])) + enc[i]) ^ (key[((sum &gt;&gt; <span class=number>11</span>) &amp; <span class=number>3</span>)] + sum);<span class=comment>//容易魔改</span></span><br><span class=line>            sum -= delta;</span><br><span class=line>            enc[i] -= (((enc[i + <span class=number>1</span>] &gt;&gt; <span class=number>5</span>) ^ (<span class=number>16</span> * enc[i + <span class=number>1</span>])) + enc[i + <span class=number>1</span>]) ^ (key[(sum &amp; <span class=number>3</span>)] + sum);<span class=comment>//容易魔改</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>for</span> (i = <span class=number>0</span>; i &lt; n; i++) {</span><br><span class=line>        <span class=keyword>for</span> (j = <span class=number>0</span>; j &lt;= <span class=number>3</span>; j++) {</span><br><span class=line>            <span class=built_in>printf</span>(<span class=string>"%c"</span>, (enc[i] &gt;&gt; (j * <span class=number>8</span>)) &amp; <span class=number>0xFF</span>);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// flag{G0@d_Snake}</span></span><br></pre></td></tr></table></figure><h3 id=mips><a href=#mips class=headerlink title=mips></a>mips</h3><p>一个魔改 qemu 题<br>题目给了一个 mips 架构的 qemu-user-static，mips 本来是可以直接运行的，出题人给个模拟器，那么肯定是有怪的，观察到 emu 被出题人去符号了，所以先查字符串搜索到这是一个 qemu 6.2.0 的 user-static，然后拉一份源码自行编译 bindiff</p><p>试过了许多优化等级，发现只有 <code>-O0</code> 的时候，符号还原率还有文件大小和题目给出的最相似<br>编译命令 <code>../configure --extra-cflags="-O0" --target-list=mips-linux-user</code></p><p>然后 bindiff 就还原出了大部分的符号</p><p><img lazyload="" alt=image-20241103203055451 data-src=https://s3.carbo.ink/img/imgs/image-20241103203055451.png></p><p>一开始想用 <code>-g</code> 选项直接调试 mips_bin，但是发现 原本的调试功能被作者去掉了，于是去分析</p><img lazyload="" alt=image-20241103203226913 data-src=https://s3.carbo.ink/img/imgs/image-20241103203226913.png style=zoom:50%><p>在 <code>0x000000000034B7A3</code> 下找到了原本的 <code>gdbserver_start</code>，然后 patch 模拟器，打开调试功能</p><img lazyload="" alt=image-20241103203326393 data-src=https://s3.carbo.ink/img/imgs/image-20241103203326393.png style=zoom:50%> <img lazyload="" alt=image-20241103203402143 data-src=https://s3.carbo.ink/img/imgs/image-20241103203402143.png style=zoom:50%><p>然后使用 <code>./emu -g 1234 mips_bin2</code> 打开gdb服务器，ida附加调试</p><p>程序中还有一个 fork 会影响分析，虽然可以 patch 掉但是会导致 flag 验证结果错误。在分析过程中会发现一个比较简单的假 flag，如果不用模拟器，这个 flag 就是对的，那么想到应该是模拟器上做了手脚，单步调试，最后发现在 syscall 之前 输出内容并没有被修改，那么只能想到是 qemu 中的 do_syscall 被修改了</p><img lazyload="" alt=image-20241103203959414 data-src=https://s3.carbo.ink/img/imgs/image-20241103203959414.png style=zoom:50%><p>write 的调用号是 0xFA4<br><img lazyload="" alt=image-20241103204057973 data-src=https://s3.carbo.ink/img/imgs/image-20241103204057973.png></p><p>果不其然，这里有额外的逻辑<br>通过交叉引用找到加密的逻辑</p><img lazyload="" alt=image-20241103204208954 data-src=https://s3.carbo.ink/img/imgs/image-20241103204208954.png style=zoom:80%><p><code>sub_33D48E</code> 是一个魔改的 RC4，其中还有一点花指令，让反编译不正常，修复后主要魔改在 RC4 最后一步的异或上</p><p><img lazyload="" alt=image-20241103204313464 data-src=https://s3.carbo.ink/img/imgs/image-20241103204313464.png></p><p>然后是一个简单异或，异或的值在 qemu 中处理 fork() 指令的函数 do_fork() 中被修改了，所以说如果之前把 fork() patch掉了也会导致没法解出来</p><img lazyload="" alt=image-20241103204415794 data-src=https://s3.carbo.ink/img/imgs/image-20241103204415794.png style=zoom:50%><p><code>sub_33D886</code> 是一个换位函数，这里吧密文的 7,11 和 12,16 位进行了交换<br>在了解所有加密逻辑后，写一个解密脚本</p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>&lt;iostream&gt;</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"defs.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>&lt;cstdint&gt;</span></span></span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>char</span> a1[<span class=number>60</span>] = {</span><br><span class=line>        <span class=number>0xA8</span>, <span class=number>0xAC</span>, <span class=number>0x36</span>, <span class=number>0x6A</span>, <span class=number>0xC4</span>, <span class=number>0x0A</span>, <span class=number>0x9A</span>, <span class=number>0xDC</span>, <span class=number>0x12</span>, <span class=number>0x48</span>, <span class=number>0xF2</span>, <span class=number>0x60</span>, <span class=number>0xCB</span>, <span class=number>0xCC</span>, <span class=number>0x3A</span>, <span class=number>0x5E</span>,</span><br><span class=line>        <span class=number>0xF2</span>, <span class=number>0x63</span>, <span class=number>0x9C</span>, <span class=number>0x94</span>, <span class=number>0xF5</span>, <span class=number>0x48</span>, <span class=number>0xCD</span>, <span class=number>0x17</span>, <span class=number>0x82</span>, <span class=number>0xCD</span>, <span class=number>0xF7</span>, <span class=number>0x71</span>, <span class=number>0x9F</span>, <span class=number>0x36</span>, <span class=number>0xB4</span>, <span class=number>0x88</span>,</span><br><span class=line>        <span class=number>0xAF</span>, <span class=number>0x5F</span>, <span class=number>0xDD</span>, <span class=number>0x64</span>, <span class=number>0x85</span>, <span class=number>0x96</span>, <span class=number>0xF7</span>, <span class=number>0x5E</span>, <span class=number>0xC4</span>, <span class=number>0x09</span>, <span class=number>0xAD</span>, <span class=number>0xDD</span>, <span class=number>0xAB</span>, <span class=number>0x16</span>, <span class=number>0x99</span>, <span class=number>0x60</span>,</span><br><span class=line>        <span class=number>0x9B</span>, <span class=number>0xDE</span>, <span class=number>0xF5</span>, <span class=number>0x53</span>, <span class=number>0xC3</span>, <span class=number>0x21</span>, <span class=number>0xFC</span>, <span class=number>0x80</span>, <span class=number>0xF8</span>, <span class=number>0x10</span>, <span class=number>0xC7</span>, <span class=number>0x26</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>char</span> byte_4020[<span class=number>6</span>] = {</span><br><span class=line>        <span class=number>0x4F</span>, <span class=number>0x7D</span>, <span class=number>0x8E</span>, <span class=number>0x2B</span>, <span class=number>0x31</span>, <span class=number>0x9C</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>int</span> enced[<span class=number>24</span>] = {</span><br><span class=line>        <span class=number>0x000000C4</span>, <span class=number>0x000000EE</span>, <span class=number>0x0000003C</span>, <span class=number>0x000000BB</span>, <span class=number>0x000000E7</span>, <span class=number>0x000000FD</span>, <span class=number>0x00000067</span>, <span class=number>0x0000001D</span>,</span><br><span class=line>        <span class=number>0x000000F8</span>, <span class=number>0x00000097</span>, <span class=number>0x00000068</span>, <span class=number>0x0000009D</span>, <span class=number>0x0000000B</span>, <span class=number>0x0000007F</span>, <span class=number>0x000000C7</span>, <span class=number>0x00000080</span>,</span><br><span class=line>        <span class=number>0x000000DF</span>, <span class=number>0x000000F9</span>, <span class=number>0x0000004B</span>, <span class=number>0x000000A0</span>, <span class=number>0x00000046</span>, <span class=number>0x00000091</span>, <span class=number>0x00000000</span>, <span class=number>0x00000000</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=type>unsigned</span> <span class=type>char</span> byte_B9CA60[<span class=number>32</span>] = {</span><br><span class=line>        <span class=number>0xDE</span>, <span class=number>0xAD</span>, <span class=number>0xBE</span>, <span class=number>0xEF</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>,</span><br><span class=line>        <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span>, <span class=number>0x00</span></span><br><span class=line>};</span><br><span class=line></span><br><span class=line><span class=function><span class=type>uint8_t</span> <span class=title>reverse_operation</span><span class=params>(<span class=type>uint8_t</span> v3)</span> </span>{</span><br><span class=line>    <span class=type>uint8_t</span> temp = v3;</span><br><span class=line></span><br><span class=line>    <span class=type>uint8_t</span> part1 = (temp &amp; <span class=number>0xC0</span>) ^ <span class=number>0xC0</span>;  <span class=comment>// High bits</span></span><br><span class=line>    <span class=type>uint8_t</span> part2 = (temp &amp; <span class=number>0x3F</span>) ^ <span class=number>0x3B</span>;  <span class=comment>// Low bits</span></span><br><span class=line></span><br><span class=line>    <span class=type>uint8_t</span> middle = (part1 &gt;&gt; <span class=number>6</span>) | (part2 &lt;&lt; <span class=number>2</span>);</span><br><span class=line>    <span class=type>uint8_t</span> v2 = (middle &gt;&gt; <span class=number>7</span>) | (middle &lt;&lt; <span class=number>1</span>);</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> v2;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=function><span class=type>char</span> *__fastcall <span class=title>decrypt</span><span class=params>(<span class=type>unsigned</span> <span class=type>char</span> *a1)</span></span></span><br><span class=line><span class=function></span>{</span><br><span class=line>    <span class=type>int</span> v1; <span class=comment>// edx</span></span><br><span class=line>    <span class=type>unsigned</span> __int8 v3; <span class=comment>// [rsp+15h] [rbp-17Bh]</span></span><br><span class=line>    <span class=type>int</span> i; <span class=comment>// [rsp+18h] [rbp-178h]</span></span><br><span class=line>    <span class=type>int</span> v5; <span class=comment>// [rsp+1Ch] [rbp-174h]</span></span><br><span class=line>    <span class=type>unsigned</span> <span class=type>int</span> v6; <span class=comment>// [rsp+20h] [rbp-170h]</span></span><br><span class=line>    <span class=type>int</span> i_22; <span class=comment>// [rsp+24h] [rbp-16Ch]</span></span><br><span class=line>    <span class=type>int</span> j_t12; <span class=comment>// [rsp+28h] [rbp-168h]</span></span><br><span class=line>    <span class=type>int</span> j; <span class=comment>// [rsp+2Ch] [rbp-164h]</span></span><br><span class=line>    <span class=type>int</span> v10; <span class=comment>// [rsp+30h] [rbp-160h]</span></span><br><span class=line>    <span class=type>int</span> v11; <span class=comment>// [rsp+34h] [rbp-15Ch]</span></span><br><span class=line>    <span class=type>int</span> v12; <span class=comment>// [rsp+3Ch] [rbp-154h]</span></span><br><span class=line>    <span class=type>const</span> <span class=type>char</span> *v13; <span class=comment>// [rsp+40h] [rbp-150h]</span></span><br><span class=line>    <span class=type>char</span> *v14; <span class=comment>// [rsp+48h] [rbp-148h]</span></span><br><span class=line>    __int8 sbox[<span class=number>256</span>]; <span class=comment>// [rsp+80h] [rbp-110h] BYREF</span></span><br><span class=line>    __int16 v16; <span class=comment>// [rsp+180h] [rbp-10h]</span></span><br><span class=line>    <span class=type>unsigned</span> __int64 v17; <span class=comment>// [rsp+188h] [rbp-8h]</span></span><br><span class=line></span><br><span class=line>    <span class=built_in>memset</span>(sbox, <span class=number>0</span>, <span class=built_in>sizeof</span>(sbox));</span><br><span class=line>    v16 = <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>for</span> ( i = <span class=number>0</span>; i &lt;= <span class=number>255</span>; ++i )</span><br><span class=line>        sbox[i] = i;</span><br><span class=line>    v5 = <span class=number>0</span>;</span><br><span class=line>    v6 = <span class=number>0</span>;</span><br><span class=line>    v13 = <span class=string>"6105t3"</span>;</span><br><span class=line>    <span class=keyword>do</span></span><br><span class=line>    {</span><br><span class=line>        v10 = (<span class=type>unsigned</span> __int8)sbox[v6];</span><br><span class=line>        v11 = (<span class=type>unsigned</span> __int8)(v13++)[(<span class=type>int</span>)(<span class=number>2</span> * (v6 / <span class=number>6</span> - (((<span class=number>2863311531u</span> * (<span class=type>unsigned</span> __int64)v6) &gt;&gt; <span class=number>32</span>) &amp; <span class=number>0xFFFFFFFC</span>)))];</span><br><span class=line>        v5 += v10 + v11;</span><br><span class=line>        v1 = v6++;</span><br><span class=line>        sbox[v1] = sbox[(<span class=type>unsigned</span> __int8)v5];</span><br><span class=line>        sbox[(<span class=type>unsigned</span> __int8)v5] = v10;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>while</span> ( v6 != <span class=number>256</span> );</span><br><span class=line>    i_22 = <span class=number>0</span>;</span><br><span class=line>    j_t12 = <span class=number>0</span>;</span><br><span class=line>    v14 = (<span class=type>char</span> *) <span class=built_in>malloc</span>(<span class=number>256LL</span>);</span><br><span class=line>    <span class=keyword>for</span> ( j = <span class=number>0</span>; j != <span class=number>22</span>; ++j )</span><br><span class=line>    {</span><br><span class=line>        v12 = (<span class=type>unsigned</span> __int8)sbox[(<span class=type>unsigned</span> __int8)++i_22];</span><br><span class=line>        j_t12 += v12;</span><br><span class=line>        sbox[(<span class=type>unsigned</span> __int8)i_22] = sbox[(<span class=type>unsigned</span> __int8)j_t12];</span><br><span class=line>        sbox[(<span class=type>unsigned</span> __int8)j_t12] = v12;</span><br><span class=line><span class=comment>//        v3 = ((((a1[j] &lt;&lt; 7) | (a1[j] &gt;&gt; 1)) &lt;&lt; 6) ^ 0xC0 | (((a1[j] &lt;&lt; 7) | (a1[j] &gt;&gt; 1)) &gt;&gt; 2) ^ 0x3B) ^ 0xBE;</span></span><br><span class=line><span class=comment>//        v14[j] = sbox[(sbox[i_22] + v12)] ^ byte_B9CA60[j &amp; 3] ^ (((((16 * (((32 * v3) | (v3 &gt;&gt; 3)) ^ 0xAD)) | ((((32 * v3) | (v3 &gt;&gt; 3)) ^ 0xAD) &gt;&gt; 4)) ^ 0xDE) &gt;&gt; 5) | (8 * (((16 * (((32 * v3) | (v3 &gt;&gt; 3)) ^ 0xAD)) | ((((32 * v3) | (v3 &gt;&gt; 3)) ^ 0xAD) &gt;&gt; 4)) ^ 0xDE)));</span></span><br><span class=line></span><br><span class=line>        uint8 step1 = a1[j] ^ sbox[(<span class=type>unsigned</span> __int8)(sbox[(<span class=type>unsigned</span> __int8)i_22] + v12)] ^ byte_B9CA60[j &amp; <span class=number>3</span>];</span><br><span class=line></span><br><span class=line>        uint8 s1_p1 = step1 &gt;&gt; <span class=number>3</span> | step1 &lt;&lt; <span class=number>5</span>;</span><br><span class=line>        s1_p1 ^= <span class=number>0xDE</span>;</span><br><span class=line>        s1_p1 = s1_p1 &lt;&lt; <span class=number>4</span> | s1_p1 &gt;&gt; <span class=number>4</span>;</span><br><span class=line>        s1_p1 ^= <span class=number>0xAD</span>;</span><br><span class=line>        s1_p1 = s1_p1 &lt;&lt; <span class=number>3</span> | s1_p1 &gt;&gt; <span class=number>5</span>;</span><br><span class=line></span><br><span class=line>        uint8 v3 = s1_p1;</span><br><span class=line>        v3 ^= <span class=number>0xBE</span>;</span><br><span class=line></span><br><span class=line>        uint8 dt = <span class=built_in>reverse_operation</span>(v3);</span><br><span class=line></span><br><span class=line>        <span class=built_in>printf</span>(<span class=string>"%c"</span>, dt);</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>return</span> v14;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=function><span class=type>int</span> <span class=title>main</span><span class=params>()</span> </span>{</span><br><span class=line></span><br><span class=line>    uint32 tmp = enced[<span class=number>12</span>];</span><br><span class=line>    enced[<span class=number>12</span>] = enced[<span class=number>16</span>];</span><br><span class=line>    enced[<span class=number>16</span>] = tmp;</span><br><span class=line></span><br><span class=line>    tmp = enced[<span class=number>7</span>];</span><br><span class=line>    enced[<span class=number>7</span>] = enced[<span class=number>11</span>];</span><br><span class=line>    enced[<span class=number>11</span>] = tmp;</span><br><span class=line></span><br><span class=line>    uint8 css[<span class=number>24</span>];</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>22</span>; ++i) {</span><br><span class=line>        enced[i] ^= <span class=number>0xA</span>;</span><br><span class=line>        css[i] = (uint8) enced[i];</span><br><span class=line>    }</span><br><span class=line>    <span class=built_in>decrypt</span>(css);</span><br><span class=line>    <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// flag{QeMu_r3v3rs3in9_h@ck6}</span></span><br></pre></td></tr></table></figure></div><div class="post-copyright-info-container border-box"><div class="copyright-info-content border-box"><div class="copyright-info-top border-box"><div class="copyright-post-title border-box text-ellipsis">2024 强网杯 - Reverse</div><div class="copyright-post-link border-box text-ellipsis">2024/11/07/2024qiangwang/</div></div><div class="copyright-info-bottom border-box"><div class="copyright-post-author bottom-item"><div class=type>作者</div><div class=content>carbofish</div></div><div class="post-time bottom-item"><div class=type>发布于</div><div class=content>2024-11-07 19:00</div></div><div class="post-license bottom-item"><div class=type>许可</div><div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0"><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><i class="fa-brands fa-creative-commons"></i> <i class="fa-brands fa-creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc"></i> <i class="fa-brands fa-creative-commons-sa"></i></a></div></div></div><i class="copyright-bg fa-solid fa-copyright"></i></div><div class="copy-copyright-info flex-center tooltip" data-tooltip-content=复制版权信息 data-tooltip-offset-y=-2px><i class="fa-solid fa-copy"></i></div></div><div class="post-bottom-tags-and-share border-box"><div><ul class="post-tags-box border-box"><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/Reverse/ >Reverse</a></li></ul></div><div></div></div><div class="post-nav border-box"><div class=prev-post><a class=prev rel=prev href=/2024/11/11/2024n1ctf/ title="2024 N1CTF - Reverse"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">2024 N1CTF - Reverse</span> <span class=post-nav-item>上一篇</span></span></a></div><div class=next-post><a class=next rel=next href=/2024/10/17/ida_python/ title="IDAPython 小记"><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">IDAPython 小记</span> <span class=post-nav-item>下一篇</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comments-container border-box"><div id=comments-anchor class="comment-area-title border-box"><i class="fas fa-comments"></i>&nbsp;评论</div><div class="comment-plugin-fail border-box"><span class=fail-tip>评论插件加载失败</span> <button class="reload keep-button">点击重新加载</button></div><div class="comment-plugin-loading flex-center border-box"><i class="loading-icon fa-solid fa-spinner fa-spin"></i> <span class=load-tip>正在加载评论插件</span></div><script data-pjax>window.KeepCommentPlugin={},window.KeepCommentPlugin.hideLoading=()=>{document.querySelector(".comments-container .comment-plugin-loading").style.display="none"},window.KeepCommentPlugin.loadFailHandle=()=>{window.KeepCommentPlugin.hideLoading();var e=document.querySelector(".comments-container .comment-plugin-fail");e.style.display="flex",e.querySelector(".reload").addEventListener("click",()=>{window.location.reload()})}</script><div class=waline-comment-container><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline-meta.css><div id=waline-comment></div><script data-pjax>window.KeepCommentPlugin.walineOptions=JSON.parse("{}".replace(/&#34;/g,'"')),window.KeepCommentPlugin.walineOptions.el="#waline-comment",window.KeepCommentPlugin.walineOptions.comment=".post-comments-count",window.KeepCommentPlugin.walineOptions.serverURL="https://comment.carbo.ink/",window.KeepCommentPlugin.walineOptions.lang="zh-CN",window.KeepCommentPlugin.walineOptions.reaction=!0</script><script data-pjax async type=module>import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('true' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }</script></div></div></div></div><div class="pc-post-toc right-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#boxx><span class=nav-text>boxx</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%96%AF%E5%86%85%E5%85%8B><span class=nav-text>斯内克</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#mips><span class=nav-text>mips</span></a></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom border-box"><footer class="footer border-box"><div class="copyright-info info-item">&copy;&nbsp;<span>2024</span>&nbsp;-&nbsp;2025 &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href=/ >carbofish</a></div><div class="theme-info info-item">由&nbsp;<a target=_blank href=https://hexo.io>Hexo</a>&nbsp;驱动&nbsp;&&nbsp;主题&nbsp;<a class=keep-version target=_blank href=https://github.com/XPoet/hexo-theme-keep>Keep</a></div><div class="count-info info-item"><span class="count-item border-box word"><span class="item-type border-box">总字数</span> <span class="item-value border-box word">55.5k</span> </span><span class="count-item border-box uv"><span class="item-type border-box">访客数</span> <span class="item-value border-box uv" id=vercount_value_site_uv></span> </span><span class="count-item border-box pv"><span class="item-type border-box">访问量</span> <span class="item-value border-box pv" id=vercount_value_site_pv></span></span></div></footer></div></div><div class="post-tools right-toc"><div class="post-tools-container border-box"><ul class="post-tools-list border-box"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class=post-comments-count></span></li><li class="tools-item flex-center full-screen"><i class="fa-solid fa-expand"></i></li></ul></div></div><div class=side-tools><div class="side-tools-container border-box"><ul class="side-tools-list side-tools-show-handle border-box"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-toggle-theme-mode flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list border-box"><li class="tools-item toggle-show-toc-tablet flex-center"><i class="fas fa-list"></i></li><li class="tools-item go-to-comments-tablet flex-center"><i class="fas fa-comment"></i></li><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center show-arrow"><i class="arrow fas fa-arrow-up"></i> <span class=percent></span></li></ul></div></div><div class=zoom-in-image-mask><img class=zoom-in-image></div><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-input-field-pre><i class="fas fa-keyboard"></i></span><div class=search-input-container><input autocomplete=off autocorrect=off autocapitalize=off placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=close-popup-btn><i class="fas fa-times"></i></span></div><div id=search-result><div id=no-result><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><div class=tablet-post-toc-mask><div class=tablet-post-toc><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#boxx><span class=nav-text>boxx</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%96%AF%E5%86%85%E5%85%8B><span class=nav-text>斯内克</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#mips><span class=nav-text>mips</span></a></li></ol></div></div></div></div></main><script src=/js/utils.js></script><script src=/js/header-shrink.js></script><script src=/js/back2top.js></script><script src=/js/toggle-theme.js></script><script src=/js/code-block.js></script><script src=/js/main.js></script><script src=/js/libs/anime.min.js></script><script src=/js/local-search.js></script><script src=/js/lazyload.js></script><div class=pjax><script src=/js/post/post-helper.js></script><script src=/js/post/toc.js></script><script src=/js/post/copyright-info.js></script></div><script src=/js/mermaid.min.js></script><script data-pjax>window.mermaid&&mermaid.init()</script><script src=/js/libs/pjax.min.js></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.initExecute()})})</script></body></html>