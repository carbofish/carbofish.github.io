<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Hexo Theme Keep"><meta name=description content="Hexo Theme Keep"><meta name=author content=carbofish><title>NP管理器DEX加固解混淆 | Carbo</title><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/logo.png><link rel=stylesheet href=/font/css/fontawesome.min.css><link rel=stylesheet href=/font/css/regular.min.css><link rel=stylesheet href=/font/css/solid.min.css><link rel=stylesheet href=/font/css/brands.min.css><script class=keep-theme-configurations>let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"example.com",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={base_info:{primary_color:"#1abc9c",title:"Carbo",author:"carbofish",avatar:"/images/avatar.png",logo:"/images/logo.png",favicon:"/images/logo.png"},menu:{home:"/ || fa-solid fa-home",tags:"/tags || fa-solid fa-tags",links:"/links || fa-solid fa-link",about:"/about || fa-solid fa-user-graduate"},first_screen:{enable:!0,background_img:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",background_img_dark:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",description:"白雪却嫌春色晚，欲穿庭树作飞花。",hitokoto:!1},social_contact:{enable:!1,links:{github:null,weixin:null,qq:"https://github.com/XPoet",weibo:null,zhihu:null,twitter:null,x:null,facebook:null,email:null}},scroll:{progress_bar:!0,percent:!0,hide_header:!0},home:{announcement:null,category:!0,tag:!0,post_datetime:"updated"},post:{author_badge:{enable:!1,level_badge:!0,custom_badge:["One","Two","Three"]},word_count:{wordcount:!0,min2read:!0},datetime_format:"YYYY-MM-DD HH:mm:ss",copyright_info:!0,share:!1,reward:{enable:!1,img_link:null,text:null,icon:null}},code_block:{tools:{enable:!0,style:"default"},highlight_theme:"default"},toc:{enable:!0,number:!1,expand_all:!1,init_open:!0,layout:"right"},website_count:{busuanzi_count:{enable:!0,site_uv:!0,site_pv:!0,page_pv:!0}},local_search:{enable:!0,preload:!0},comment:{enable:!0,use:"waline",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.36"},waline:{server_url:"https://comment.carbo.ink/",reaction:!0,version:"3.3.2",option:{dark:"auto"}},giscus:{repo:null,repo_id:null,category:"Announcements",category_id:null,reactions_enabled:!1},artalk:{server:null},disqus:{shortname:null}},rss:{enable:!1},lazyload:{enable:!0},cdn:{enable:!1,provider:"unpkg"},pjax:{enable:!0},footer:{since:2024,word_count:!0,site_deploy:{enable:!1,provider:"github",url:null},record:{enable:!1,list:[{code:null,link:null}]}},inject:{enable:!1,css:[null],js:[null]},root:"",source_data:{links:[{name:"5m10v3",link:"https://5m10v3.top",avatar:"https://5m10v3.top/images/1.jpg",description:"进击的二进制人"},{name:"PangBai",link:"https://pangbai.work/",avatar:"http://pangbai.work/images/avatar.jpg",description:"Bangbai | d180"},{name:"void2eye",link:"https://void2eye.fun/",avatar:"https://void2eye.fun/img/808.png",description:"政治家"},{name:"C3ngH",link:"https://c3ngh.top",avatar:"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg",description:"包罗万象哥"},{name:"A1ic3",link:"https://a1ic3.cn/",avatar:"https://a1ic3.cn/images/avatar1.jpg",description:"小密码王"},{name:"enllus1on",link:"https://enllus1on.github.io/",description:"Pwn神",avatar:"https://enllus1on.github.io/images/kano.jpg"},{name:"AsaL1n",link:"https://asal1n.github.io/",avatar:"https://asal1n.github.io/img/head.jpg",description:"血怒哥"},{name:"Straw",link:"https://straw-233.github.io/",avatar:"https://straw-233.github.io/avatar/meinasi.png",description:"午门痴"},{name:"CHHHCHHOH",link:"http://www.chhhchhoh.cn/",avatar:"https://s2.loli.net/2024/10/20/9EXmLyYuU6b5tVh.png",description:"吃了乙酸的乙醇不会梦到乙酸乙酯"},{name:"Lunatic",link:"https://goodlunatic.github.io/",avatar:"https://www.nssctf.cn/files/2024/4/28/7f130a1387.png",description:"Mind and Hand :)"},{name:"Fup1p1",link:"https://www.fup1p1.cn/",avatar:"https://www.nssctf.cn/files/2024/4/29/524400904c.jpeg",description:"逆向寻真理"},{name:"X1ao",link:"https://www.x1aoblog.top/",avatar:"http://www.x1aoblog.top/upload/mmexport1681277516546.png",description:"大密码王"},{name:"Xux",link:"https://www.xuxblog.top",avatar:"https://avatars.githubusercontent.com/u/82816273?s=64&v=4",description:"神仙 Web 👴"},{name:"Woodwhale",avatar:"https://www.woodwhale.cn/woodwhale.png",link:"https://www.woodwhale.cn",description:"全栈神"},{name:"Xunflash",avatar:"https://www.xunflash.top/icon.png",link:"https://www.xunflash.top/",description:"澳爷"},{name:"bi0x",avatar:"https://blog.bi0x.com/img/avatar.png",link:"https://blog.bi0x.com/",description:"字节👴"},{name:"huanghunr",link:"https://blog.huanghunr.top",avatar:"https://pic.imgdb.cn/item/670b4202d29ded1a8c807e7e.jpg",description:"喵喵喵?!还没想好"},{name:"温婳霂",link:"https://somokel.github.io",avatar:"https://s2.loli.net/2024/10/21/GixfX61nsPMkN4r.jpg",description:"春祺夏安，秋绥冬宁。"}]},version:"4.2.2"},KEEP.language_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},KEEP.language_code_block={copy:"复制代码",copied:"已复制",fold:"折叠代码块",folded:"已折叠"},KEEP.language_copy_copyright={copy:"复制版权信息",copied:"已复制",title:"原文标题",author:"原文作者",link:"原文链接"}</script><meta name=generator content="Hexo 7.3.0"><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body><div class=progress-bar-container><span class=scroll-progress-bar></span> <span class=pjax-progress-bar></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container border-box"><div class="page-main-content border-box"><div class=page-main-content-top><header class=header-wrapper><div class="border-box header-content"><div class="left flex-start border-box"><a class="logo-image border-box" href=/ ><img src=/images/logo.png> </a><a class="site-name border-box" href=/ >Carbo</a></div><div class="right border-box"><div class="pc border-box"><ul class="menu-list border-box"><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/ ><i class="menu-text-color menu-icon fa-solid fa-home"></i> 首页</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/tags><i class="menu-text-color menu-icon fa-solid fa-tags"></i> 标签</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/links><i class="menu-text-color menu-icon fa-solid fa-link"></i> 友链</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/about><i class="menu-text-color menu-icon fa-solid fa-user-graduate"></i> 关于</a></li><li class="menu-item search search-popup-trigger"><i class="menu-text-color fas search fa-search"></i></li></ul></div><div class="mobile border-box flex-start"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class=menu-bar-middle></div></div></div></div></div><div class=header-drawer><ul class="drawer-menu-list border-box"><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/ ><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i> </span>首页</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/tags><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i> </span>标签</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/links><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-link"></i> </span>友链</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/about><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-user-graduate"></i> </span>关于</a></label></li></ul></div><div class=window-mask></div></header></div><div class="page-main-content-middle border-box"><div class="main-content border-box"><div class=fade-in-down-animation><div class="post-page-container border-box"><div class="post-content-container border-box"><div class="post-content-bottom border-box"><div class=post-title>NP管理器DEX加固解混淆</div><div class="post-header border-box"><div class="avatar-box border-box"><img src=/images/avatar.png></div><div class=info-box><div class="author border-box"><span class=name>carbofish</span></div><div class="meta-info border-box"><div class="post-meta-info-container border-box post"><div class="post-meta-info border-box"><span class="meta-info-item post-create-date"><i class="icon fa-solid fa-calendar-plus"></i>&nbsp; <span class=datetime>2024-10-06 15:12:45</span> </span><span class="meta-info-item post-update-date"><i class="icon fa-solid fa-file-pen"></i>&nbsp; <span class=datetime data-updated="Mon Nov 18 2024 16:47:53 GMT+0800">2024-11-18 16:47:53</span> </span><span class="post-tag meta-info-item border-box"><ul class=post-tag-ul><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/Reverse/ >Reverse</a></li><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/NP/ >NP</a></li><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/Java/ >Java</a></li><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/Obfuscation/ >Obfuscation</a></li></ul></span><span class="meta-info-item post-wordcount"><i class="icon fas fa-file-word"></i>&nbsp;<span>3.3k 字</span> </span><span class="meta-info-item post-min2read"><i class="icon fas fa-clock"></i>&nbsp;<span>16 分钟</span> </span><span class="meta-info-item post-pv"><i class="icon fas fa-eye"></i>&nbsp;<span id=vercount_value_page_pv></span></span></div></div></div></div></div><div class="post-content keep-markdown-body"><p>通过一道SCTF的安卓题记一次反混淆</p><p><code>静态调用混淆</code> <code>动态调用混淆</code> <code>引用混淆</code> <code>字符串混淆</code> <code>数字混淆</code> <code>控制流混淆</code></p><span id=more></span><p>最近在打 sctf 的时候，遇到了一题安卓题，用的 NP 管理器的控制流混淆，用了 switch 来打乱程序的执行流，还有一些比较麻烦的混淆，如果一步步调试的话可能工作量比较大，于是想到了利用 ASM 框架和混淆特征，来实现一个 NP混淆的反混淆器</p><h3 id=Dex-转-Jar><a href=#Dex-转-Jar class=headerlink title="Dex 转 Jar"></a>Dex 转 Jar</h3><p>虽然 Dex 可以转成 smali 后修改再编译回去，但是笔者没有找到像 OW2 ASM 那样成熟的字节码编辑框架，所以最后选择了 先用 d2j-dex2jar 转换成 jar 后在用 ASM 去反混淆</p><p>我选择了 Github 上一个比较成熟的 Java 反混淆器，虽然没有为 NP定制的 Transformer，但是好在写自定义的 Transformer 比较方便<br><a class=link target=_blank rel=noopener href=https://github.com/java-deobfuscator/deobfuscator>https://github.com/java-deobfuscator/deobfuscator<i class="fas fa-external-link-alt"></i></a></p><p>然后使用 d2j-dex2jar 把 dex 转换成 jar，开始编写反混淆器</p><h3 id=反混淆部分><a href=#反混淆部分 class=headerlink title=反混淆部分></a>反混淆部分</h3><h4 id=控制流混淆><a href=#控制流混淆 class=headerlink title=控制流混淆></a>控制流混淆</h4><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061625741.png></p><p>这个会在每个 case 结束前对 var0 进行赋值，来让人难以推断下一个 case是什么，而且一般还与数字混淆配合在一起<br>比如 这种静态变量 组合运算<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061626214.png><br>还有调用静态函数获取值<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061626815.png><br>还有先把下一个 case 的值计算完之后存在局部变量里，然后跳转前再读取出来的<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061628316.png><br>这里的 var7_23 读取了上面运算出来的值<br>控制流混淆笔者没有什么好的办法，而且提前算出来的一些数字似乎会有一些 case 是不可达的，但是分析后发现函数要实现功能这些块应该是肯定会执行的不到的<br>目前的方法是对 switch 建立一个 label 索引表，然后把对 var7_23 赋值的内容根据索引表找出下一跳的 Label，然后把 goto 的内容修改为索引表中的 Label，最后去掉 switch，让反编译器去优化控制流</p><h4 id=数字混淆><a href=#数字混淆 class=headerlink title=数字混淆></a>数字混淆</h4><p>上面分析控制流混淆的时候已经分析过了三种数字混淆，初次之外还有<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061631354.png><br>这种在嵌套在其他表达式中的数字混淆<br>对于数组混淆笔者的解决办法是利用 VM 去执行，这样可以最大程度上避免精度造成的问题</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre></td><td class=code><pre><span class=line><span class=type>Integer</span> <span class=variable>num1</span> <span class=operator>=</span> getTargetInteger((FieldInsnNode) start);  </span><br><span class=line><span class=type>Integer</span> <span class=variable>num2</span> <span class=operator>=</span> getTargetInteger((FieldInsnNode) getNextN(start, <span class=number>1</span>));  </span><br><span class=line><span class=type>MethodNode</span> <span class=variable>calcMethod</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">MethodNode</span>(Opcodes.ACC_PUBLIC | Opcodes.ACC_STATIC, <span class=string>"carbo_calc"</span>, <span class=string>"()Ljava/lang/Integer;"</span>, <span class=literal>null</span>, <span class=literal>null</span>);  </span><br><span class=line>calcMethod.visitCode();  </span><br><span class=line>calcMethod.visitLdcInsn(num1);  </span><br><span class=line>calcMethod.visitLdcInsn(num2);  </span><br><span class=line>calcMethod.visitInsn(getNextN(start, <span class=number>2</span>).getOpcode());  </span><br><span class=line>calcMethod.visitLdcInsn(Utils.getIntValue(getNextN(start, <span class=number>3</span>)));  </span><br><span class=line>calcMethod.visitInsn(getNextN(start, <span class=number>4</span>).getOpcode());  </span><br><span class=line>calcMethod.visitInsn(IRETURN);  </span><br><span class=line>mathClz.methods.add(calcMethod);  </span><br><span class=line><span class=type>Integer</span> <span class=variable>result</span> <span class=operator>=</span> vm.execute(mathClz, calcMethod).getReturnValue().asInt();  </span><br><span class=line>mathClz.methods.clear();</span><br></pre></td></tr></table></figure><h4 id=FakeJump-不可达跳转混淆><a href=#FakeJump-不可达跳转混淆 class=headerlink title="FakeJump 不可达跳转混淆"></a>FakeJump 不可达跳转混淆</h4><p>还有一些这种静态变量组成的计算式 组成的条件跳转，其中参杂着一些假的跳转<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061633806.png><br>举个例子，分别找到这两个静态变量的值，然后得到算式<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061635896.png><br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061636965.png><br><code>-909 | 639 * 5237 = -901</code><br>计算出来后的值 -901 不满足跳转条件，这里就是一个不可达的区块，很容易干扰阅读</p><h4 id=变量引用混淆><a href=#变量引用混淆 class=headerlink title=变量引用混淆></a>变量引用混淆</h4><p>NP为了隐藏调用的变量，在 np.protect 下生成了几个类根据传入的参数通过反射获取变量或者调用方法<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061639032.png></p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061641441.png></p><p>这里还有一些 byte[] 组成的字符串，我们先写一个方法来把这里数字还原成字符串<br>先来分析这种 byte[] 形式字符串的字节码特征，我们使用 Recaf 反编译</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>new</span> <span class="title class_">java</span>/lang/String <span class=comment>// 初始化一个 String Object</span></span><br><span class=line>dup </span><br><span class=line>bipush <span class=number>6</span> <span class=comment>// 往栈顶压入数字 6</span></span><br><span class=line>newarray <span class=type>byte</span> <span class=comment>// 一个 TypeInsnNode，申明数组</span></span><br><span class=line>dup </span><br><span class=line>iconst_0 <span class=comment>// 数组下标 0</span></span><br><span class=line>bipush <span class=number>73</span> <span class=comment>// 数组第一个元素的的值</span></span><br><span class=line>i2b <span class=comment>// 把栈顶的 73 转换为 byte 类型，等同于 (byte)73</span></span><br><span class=line>bastore <span class=comment>// 等于是存入数组</span></span><br><span class=line>dup </span><br><span class=line>iconst_1 </span><br><span class=line>bipush <span class=number>108</span></span><br><span class=line>i2b </span><br><span class=line>bastore </span><br><span class=line>dup </span><br><span class=line>iconst_2 </span><br><span class=line>bipush <span class=number>79</span></span><br><span class=line>i2b </span><br><span class=line>bastore </span><br><span class=line>dup </span><br><span class=line>iconst_3 </span><br><span class=line>bipush <span class=number>84</span></span><br><span class=line>i2b </span><br><span class=line>bastore </span><br><span class=line>dup </span><br><span class=line>iconst_4 </span><br><span class=line>bipush <span class=number>68</span></span><br><span class=line>i2b </span><br><span class=line>bastore </span><br><span class=line>dup </span><br><span class=line>iconst_5 </span><br><span class=line>bipush <span class=number>121</span></span><br><span class=line>i2b </span><br><span class=line>bastore </span><br><span class=line>invokespecial java/lang/String.&lt;init&gt; ([B)V <span class=comment>// 调用 new String(xxx)</span></span><br><span class=line>astore v1 <span class=comment>// 保存到 v1 变量里</span></span><br><span class=line><span class=keyword>goto</span> B</span><br></pre></td></tr></table></figure><p>然后就可以写一个方法根据特征还原 String 类</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">fixNPByteString</span><span class=params>(AbstractInsnNode start, MethodNode methodNode, <span class=type>boolean</span> checkFlag)</span> <span class=keyword>throws</span> UnsupportedEncodingException {  </span><br><span class=line>  </span><br><span class=line>        <span class=type>AbstractInsnNode</span> <span class=variable>check</span> <span class=operator>=</span> start;  </span><br><span class=line>        <span class=keyword>if</span> (!(check <span class=keyword>instanceof</span> TypeInsnNode &amp;&amp; check.getOpcode() == NEW &amp;&amp; ((TypeInsnNode) check).desc.equals(<span class=string>"java/lang/String"</span>))) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>        check = getNextN(start, <span class=number>1</span>);  </span><br><span class=line>        <span class=keyword>if</span> (!(check <span class=keyword>instanceof</span> InsnNode &amp;&amp; check.getOpcode() == DUP)) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>        check = getNextN(start, <span class=number>2</span>);  </span><br><span class=line>        <span class=keyword>if</span> (!(check <span class=keyword>instanceof</span> IntInsnNode &amp;&amp; check.getOpcode() == BIPUSH) &amp;&amp; !(check <span class=keyword>instanceof</span> InsnNode &amp;&amp; check.getOpcode() &gt;= ICONST_0 &amp;&amp; check.getOpcode() &lt;= ICONST_5)) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>        <span class=keyword>if</span> (checkFlag) <span class=keyword>return</span> <span class=literal>true</span>;  </span><br><span class=line>        <span class=type>int</span> <span class=variable>length</span> <span class=operator>=</span> -<span class=number>1</span>;  </span><br><span class=line>        <span class=keyword>if</span> (check <span class=keyword>instanceof</span> IntInsnNode) length = ((IntInsnNode) check).operand;  </span><br><span class=line>        <span class=keyword>else</span> length = check.getOpcode() - ICONST_0;  </span><br><span class=line>        check = start;  </span><br><span class=line>        toRemove = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class=line>        toRemove.addAll(Arrays.asList(  </span><br><span class=line>                check,  </span><br><span class=line>                getNextN(check, <span class=number>1</span>),  </span><br><span class=line>                getNextN(check, <span class=number>2</span>),  </span><br><span class=line>                getNextN(check, <span class=number>3</span>)  </span><br><span class=line>        ));  </span><br><span class=line>        check = getNextN(start, <span class=number>4</span>);  </span><br><span class=line>        <span class=type>byte</span>[] bytes = <span class=keyword>new</span> <span class="title class_">byte</span>[length];  </span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i &lt; length; i++) {  </span><br><span class=line>            toRemove.addAll(Arrays.asList(  </span><br><span class=line>                    check,  </span><br><span class=line>                    getNextN(check, <span class=number>1</span>),  </span><br><span class=line>                    getNextN(check, <span class=number>2</span>),  </span><br><span class=line>                    getNextN(check, <span class=number>3</span>),  </span><br><span class=line>                    getNextN(check, <span class=number>4</span>)  </span><br><span class=line>            ));  </span><br><span class=line>            <span class=type>int</span> <span class=variable>bit</span> <span class=operator>=</span> -<span class=number>1</span>;  </span><br><span class=line>            <span class=keyword>if</span> (getNextN(check, <span class=number>2</span>) <span class=keyword>instanceof</span> IntInsnNode) {  </span><br><span class=line>                bit = ((IntInsnNode) getNextN(check, <span class=number>2</span>)).operand;  </span><br><span class=line>            } <span class=keyword>else</span> {  </span><br><span class=line>                bit = check.getOpcode() - ICONST_0;  </span><br><span class=line>            }  </span><br><span class=line>            bytes[i] = (<span class=type>byte</span>) bit;  </span><br><span class=line>            check = getNextN(check, <span class=number>5</span>);  </span><br><span class=line>        }  </span><br><span class=line>        <span class=type>String</span> <span class=variable>s</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">String</span>(bytes, <span class=string>"UTF-8"</span>);  </span><br><span class=line><span class=comment>//        System.out.println(String.format("Got a string.. %s", s));  </span></span><br><span class=line>        <span class=keyword>if</span> (!(check <span class=keyword>instanceof</span> MethodInsnNode &amp;&amp; ((MethodInsnNode) check).owner.equals(<span class=string>"java/lang/String"</span>)  </span><br><span class=line>                &amp;&amp; ((MethodInsnNode) check).name.equals(<span class=string>"&lt;init&gt;"</span>))) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>        toRemove.add(check);  </span><br><span class=line>        methodNode.instructions.insertBefore(check, <span class=keyword>new</span> <span class="title class_">LdcInsnNode</span>(s));  </span><br><span class=line>        toRemove.forEach(insn -&gt; {methodNode.instructions.remove(insn);});  </span><br><span class=line>        <span class=keyword>return</span> <span class=literal>true</span>;  </span><br><span class=line>    }</span><br></pre></td></tr></table></figure><p>效果<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061651176.png></p><p>可以根据每个 case 的字符串个数判断这是 一个 String 对象还是一个 变量引用<br>然后就可以写一个方法把它们转换回 FieldInsnNode</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>public</span> Map&lt;Integer, FieldResult&gt; <span class="title function_">getFieldMap</span><span class=params>(Map&lt;LabelNode, Integer&gt; iLmap, MethodNode methodNode)</span> {  </span><br><span class=line>    <span class=type>boolean</span> <span class=variable>foundSwitch</span> <span class=operator>=</span> <span class=literal>false</span>;  </span><br><span class=line>    Map&lt;Integer, FieldResult&gt; result = <span class=keyword>new</span> <span class="title class_">HashMap</span>&lt;&gt;();  </span><br><span class=line>    <span class=keyword>for</span> (AbstractInsnNode insn : methodNode.instructions) {  </span><br><span class=line>        <span class=keyword>if</span> (insn <span class=keyword>instanceof</span> LookupSwitchInsnNode) foundSwitch = <span class=literal>true</span>;  </span><br><span class=line>        <span class=keyword>if</span> (!foundSwitch) <span class=keyword>continue</span>;  </span><br><span class=line>        <span class=keyword>if</span> (insn <span class=keyword>instanceof</span> LabelNode) {  </span><br><span class=line>            <span class=type>LabelNode</span> <span class=variable>thisLabel</span> <span class=operator>=</span> (LabelNode) insn;  </span><br><span class=line>            <span class=keyword>if</span> (iLmap.containsKey(thisLabel)) {  </span><br><span class=line>                <span class=comment>// 开始往下寻找  </span></span><br><span class=line>                ArrayList&lt;String&gt; ldcList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;&gt;();  </span><br><span class=line>                <span class=type>AbstractInsnNode</span> <span class=variable>ptr</span> <span class=operator>=</span> insn.getNext();  </span><br><span class=line>                <span class=keyword>while</span> (ptr != <span class=literal>null</span> &amp;&amp; !(ptr <span class=keyword>instanceof</span> LabelNode)) {  </span><br><span class=line>                    <span class=keyword>if</span> (ptr <span class=keyword>instanceof</span> LdcInsnNode) ldcList.add((String) ((LdcInsnNode) ptr).cst);  </span><br><span class=line>                    ptr = ptr.getNext();  </span><br><span class=line>                }  </span><br><span class=line>                <span class=keyword>if</span> (!ldcList.isEmpty()) {  </span><br><span class=line>                    <span class=keyword>if</span> (ldcList.size() == <span class=number>1</span>) {  </span><br><span class=line>                        <span class=comment>// 字符串对象  </span></span><br><span class=line>                        result.put(iLmap.get(thisLabel), <span class=keyword>new</span> <span class="title class_">FieldResult</span>(ldcList.get(<span class=number>0</span>)));  </span><br><span class=line>                        System.out.printf(<span class=string>"Found new field %s\n"</span>, ldcList.get(<span class=number>0</span>));  </span><br><span class=line>                    } <span class=keyword>else</span> {  </span><br><span class=line>                        <span class=type>String</span> <span class=variable>desc</span> <span class=operator>=</span> ldcList.get(<span class=number>2</span>);  </span><br><span class=line>                        <span class=type>StringBuilder</span> <span class=variable>param</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();  </span><br><span class=line>                        <span class=keyword>if</span> (desc.startsWith(<span class=string>"["</span>)) desc = desc;  </span><br><span class=line>                        <span class=keyword>else</span> <span class=keyword>if</span> (typeMap.containsKey(desc)) desc = typeMap.get(desc);  </span><br><span class=line>                        <span class=keyword>else</span> {  </span><br><span class=line>                            desc = String.format(<span class=string>"L%s;"</span>, desc.replace(<span class=string>"."</span>, <span class=string>"/"</span>));  </span><br><span class=line>                        }  </span><br><span class=line>                        <span class=type>FieldInsnNode</span> <span class=variable>fieldInsnNode</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FieldInsnNode</span>(  </span><br><span class=line>                                GETSTATIC,  </span><br><span class=line>                                ldcList.get(<span class=number>0</span>).replace(<span class=string>"."</span>, <span class=string>"/"</span>),  </span><br><span class=line>                                ldcList.get(<span class=number>1</span>),  </span><br><span class=line>                                desc  </span><br><span class=line>                        );  </span><br><span class=line>                        System.out.printf(<span class=string>"Found new field: %s %s %s\n"</span>, ldcList.get(<span class=number>0</span>), ldcList.get(<span class=number>1</span>), desc);  </span><br><span class=line>                        result.put(iLmap.get(thisLabel), <span class=keyword>new</span> <span class="title class_">FieldResult</span>(fieldInsnNode));  </span><br><span class=line>                    }  </span><br><span class=line>                }  </span><br><span class=line>            }  </span><br><span class=line>        }  </span><br><span class=line>    }  </span><br><span class=line>    <span class=keyword>return</span> result;  </span><br><span class=line>}</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">patchNPField</span><span class=params>(AbstractInsnNode start, MethodNode methodNode, ClassNode classNode, <span class=type>boolean</span> checkFlag)</span> {  </span><br><span class=line>    <span class=keyword>if</span> (!isNPFieldCall(start)) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>    <span class=type>AbstractInsnNode</span> <span class=variable>check</span> <span class=operator>=</span> start;  </span><br><span class=line>    <span class=type>MethodInsnNode</span> <span class=variable>method</span> <span class=operator>=</span> (MethodInsnNode) check;  </span><br><span class=line>    check = check.getPrevious();  </span><br><span class=line>  </span><br><span class=line>    <span class=keyword>if</span> (!Utils.isInteger(check)) <span class=keyword>return</span> <span class=literal>false</span>;  </span><br><span class=line>    <span class=keyword>if</span> (checkFlag) <span class=keyword>return</span> <span class=literal>true</span>;  </span><br><span class=line>  </span><br><span class=line>    <span class=type>int</span> <span class=variable>val</span> <span class=operator>=</span> Utils.getIntValue(check);  </span><br><span class=line>  </span><br><span class=line>    <span class=keyword>if</span> (NPFieldMap.containsKey(val)) {  </span><br><span class=line>        <span class=type>FieldResult</span> <span class=variable>fieldResult</span> <span class=operator>=</span> NPFieldMap.get(val);  </span><br><span class=line>        List&lt;AbstractInsnNode&gt; toRemove = Arrays.asList(  </span><br><span class=line>                start.getPrevious()  </span><br><span class=line>        );  </span><br><span class=line>  </span><br><span class=line>        <span class=keyword>if</span> (fieldResult.type.equals(<span class=string>"str"</span>)) {  </span><br><span class=line>            methodNode.instructions.set(start, <span class=keyword>new</span> <span class="title class_">LdcInsnNode</span>(fieldResult.strObj));  </span><br><span class=line>            System.out.printf(<span class=string>"Fixed a string field %s\n"</span>, fieldResult.strObj);  </span><br><span class=line>        } <span class=keyword>else</span> {  </span><br><span class=line>            <span class=type>FieldInsnNode</span> <span class=variable>fieldInsnNode</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FieldInsnNode</span>(GETSTATIC, fieldResult.fieldInsnNode.owner, fieldResult.fieldInsnNode.name, fieldResult.fieldInsnNode.desc);  </span><br><span class=line>            methodNode.instructions.set(start, fieldInsnNode);  </span><br><span class=line>            System.out.printf(<span class=string>"Fixed a field %s %s %s\n"</span>, fieldResult.fieldInsnNode.owner, fieldResult.fieldInsnNode.name, fieldResult.fieldInsnNode.desc);  </span><br><span class=line>        }  </span><br><span class=line>  </span><br><span class=line>        toRemove.forEach(insn -&gt; methodNode.instructions.remove(insn));  </span><br><span class=line>    } <span class=keyword>else</span> {  </span><br><span class=line>        System.out.printf(<span class=string>"%d not in the field map...\n"</span>, val);  </span><br><span class=line>    }  </span><br><span class=line>  </span><br><span class=line>    <span class=keyword>return</span> <span class=literal>true</span>;  </span><br><span class=line>  </span><br><span class=line>}</span><br></pre></td></tr></table></figure><p>效果<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061658813.png></p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061659000.png><br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061659375.png></p><h4 id=方法调用混淆><a href=#方法调用混淆 class=headerlink title=方法调用混淆></a>方法调用混淆</h4><p>和上面的方法引用一样，先吧数字值和对应的方法调用对应起来<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061701763.png></p><p>然后与方法混淆不同的是，原本函数调用的参数被魔改成了一个 Object 数组传递过去，想要还原得先吧 Object 数组解析出来，然后恢复原本的函数调用</p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061707836.png></p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br></pre></td><td class=code><pre><span class=line>ldc <span class=number>72724</span> <span class=comment>// 第一个参数 72724</span></span><br><span class=line>aconst_null  <span class=comment>// 第二个参数 null</span></span><br><span class=line>iconst_1 <span class=comment>// Object 数组长度</span></span><br><span class=line>anewarray java/lang/Object <span class=comment>// 申明新建数组</span></span><br><span class=line>dup </span><br><span class=line>iconst_0 <span class=comment>// 元素下标</span></span><br><span class=line>getstatic kotlinx/coroutines/channels/ۨ۠ۤ۟.۟۠ۨۧۢ I <span class=comment>// FieldInsnNode 获取那个</span></span><br><span class=line>sipush -<span class=number>26811</span> <span class=comment>// 对应上面那个被异或的值</span></span><br><span class=line>ixor <span class=comment>// 异或</span></span><br><span class=line>invokestatic java/lang/Integer.valueOf (I)Ljava/lang/Integer; <span class=comment>// 转换成 int 类型</span></span><br><span class=line>aastore <span class=comment>// 数组保存</span></span><br><span class=line>invokestatic np/protect/\u06E5ۣۢۢ.n (ILjava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; <span class=comment>// 调用这个方法</span></span><br><span class=line>checkcast java/lang/Boolean</span><br><span class=line>invokevirtual java/lang/Boolean.booleanValue ()Z</span><br><span class=line>istore i23</span><br><span class=line>ldc <span class=number>72724</span></span><br><span class=line>aconst_null </span><br><span class=line>iconst_1 </span><br><span class=line>anewarray java/lang/Object</span><br><span class=line>dup </span><br><span class=line>iconst_0 </span><br><span class=line>getstatic kotlinx/coroutines/channels/ۨ۠ۤ۟.۟۠ۨۧۢ I</span><br><span class=line>sipush -<span class=number>26811</span></span><br><span class=line>ixor </span><br><span class=line>invokestatic java/lang/Integer.valueOf (I)Ljava/lang/Integer;</span><br><span class=line>aastore </span><br><span class=line>invokestatic np/protect/\u06E5ۣۢۢ.n (ILjava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;</span><br><span class=line>checkcast java/lang/Boolean</span><br><span class=line>invokevirtual java/lang/Boolean.booleanValue ()Z</span><br><span class=line>istore i24</span><br></pre></td></tr></table></figure><p>和上面的变量引用混淆一样，建立一个对应表后可以根据传递的第一个参数来还原<br>这张图可以很明显的看出删减的内容<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061713189.png><br>还原前<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061714198.png><br>还原后<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061714725.png></p><h3 id=总结><a href=#总结 class=headerlink title=总结></a>总结</h3><p>反混淆结果</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br><span class=line>225</span><br><span class=line>226</span><br><span class=line>227</span><br><span class=line>228</span><br><span class=line>229</span><br><span class=line>230</span><br><span class=line>231</span><br><span class=line>232</span><br><span class=line>233</span><br><span class=line>234</span><br><span class=line>235</span><br><span class=line>236</span><br><span class=line>237</span><br><span class=line>238</span><br><span class=line>239</span><br><span class=line>240</span><br><span class=line>241</span><br><span class=line>242</span><br><span class=line>243</span><br><span class=line>244</span><br><span class=line>245</span><br><span class=line>246</span><br><span class=line>247</span><br><span class=line>248</span><br><span class=line>249</span><br><span class=line>250</span><br><span class=line>251</span><br><span class=line>252</span><br><span class=line>253</span><br><span class=line>254</span><br><span class=line>255</span><br><span class=line>256</span><br><span class=line>257</span><br><span class=line>258</span><br><span class=line>259</span><br><span class=line>260</span><br><span class=line>261</span><br><span class=line>262</span><br><span class=line>263</span><br><span class=line>264</span><br><span class=line>265</span><br><span class=line>266</span><br><span class=line>267</span><br><span class=line>268</span><br><span class=line>269</span><br><span class=line>270</span><br><span class=line>271</span><br><span class=line>272</span><br><span class=line>273</span><br><span class=line>274</span><br><span class=line>275</span><br><span class=line>276</span><br><span class=line>277</span><br><span class=line>278</span><br><span class=line>279</span><br><span class=line>280</span><br><span class=line>281</span><br><span class=line>282</span><br><span class=line>283</span><br><span class=line>284</span><br><span class=line>285</span><br><span class=line>286</span><br><span class=line>287</span><br><span class=line>288</span><br><span class=line>289</span><br><span class=line>290</span><br><span class=line>291</span><br><span class=line>292</span><br><span class=line>293</span><br><span class=line>294</span><br><span class=line>295</span><br><span class=line>296</span><br><span class=line>297</span><br><span class=line>298</span><br><span class=line>299</span><br><span class=line>300</span><br><span class=line>301</span><br><span class=line>302</span><br><span class=line>303</span><br><span class=line>304</span><br><span class=line>305</span><br><span class=line>306</span><br><span class=line>307</span><br><span class=line>308</span><br><span class=line>309</span><br><span class=line>310</span><br><span class=line>311</span><br><span class=line>312</span><br><span class=line>313</span><br><span class=line>314</span><br><span class=line>315</span><br><span class=line>316</span><br><span class=line>317</span><br><span class=line>318</span><br><span class=line>319</span><br><span class=line>320</span><br><span class=line>321</span><br><span class=line>322</span><br><span class=line>323</span><br><span class=line>324</span><br><span class=line>325</span><br><span class=line>326</span><br><span class=line>327</span><br><span class=line>328</span><br><span class=line>329</span><br><span class=line>330</span><br><span class=line>331</span><br><span class=line>332</span><br><span class=line>333</span><br><span class=line>334</span><br><span class=line>335</span><br><span class=line>336</span><br><span class=line>337</span><br><span class=line>338</span><br><span class=line>339</span><br><span class=line>340</span><br><span class=line>341</span><br><span class=line>342</span><br><span class=line>343</span><br><span class=line>344</span><br><span class=line>345</span><br><span class=line>346</span><br><span class=line>347</span><br><span class=line>348</span><br><span class=line>349</span><br><span class=line>350</span><br><span class=line>351</span><br><span class=line>352</span><br><span class=line>353</span><br><span class=line>354</span><br><span class=line>355</span><br><span class=line>356</span><br><span class=line>357</span><br><span class=line>358</span><br><span class=line>359</span><br><span class=line>360</span><br><span class=line>361</span><br><span class=line>362</span><br><span class=line>363</span><br><span class=line>364</span><br><span class=line>365</span><br><span class=line>366</span><br><span class=line>367</span><br><span class=line>368</span><br><span class=line>369</span><br><span class=line>370</span><br><span class=line>371</span><br><span class=line>372</span><br><span class=line>373</span><br><span class=line>374</span><br><span class=line>375</span><br><span class=line>376</span><br><span class=line>377</span><br><span class=line>378</span><br><span class=line>379</span><br><span class=line>380</span><br><span class=line>381</span><br><span class=line>382</span><br><span class=line>383</span><br><span class=line>384</span><br><span class=line>385</span><br><span class=line>386</span><br><span class=line>387</span><br><span class=line>388</span><br><span class=line>389</span><br><span class=line>390</span><br><span class=line>391</span><br><span class=line>392</span><br><span class=line>393</span><br><span class=line>394</span><br><span class=line>395</span><br><span class=line>396</span><br><span class=line>397</span><br><span class=line>398</span><br><span class=line>399</span><br><span class=line>400</span><br><span class=line>401</span><br><span class=line>402</span><br><span class=line>403</span><br><span class=line>404</span><br><span class=line>405</span><br><span class=line>406</span><br><span class=line>407</span><br><span class=line>408</span><br><span class=line>409</span><br><span class=line>410</span><br><span class=line>411</span><br><span class=line>412</span><br><span class=line>413</span><br><span class=line>414</span><br><span class=line>415</span><br><span class=line>416</span><br><span class=line>417</span><br><span class=line>418</span><br><span class=line>419</span><br><span class=line>420</span><br><span class=line>421</span><br><span class=line>422</span><br><span class=line>423</span><br><span class=line>424</span><br><span class=line>425</span><br><span class=line>426</span><br><span class=line>427</span><br><span class=line>428</span><br><span class=line>429</span><br><span class=line>430</span><br><span class=line>431</span><br><span class=line>432</span><br><span class=line>433</span><br><span class=line>434</span><br><span class=line>435</span><br><span class=line>436</span><br><span class=line>437</span><br><span class=line>438</span><br><span class=line>439</span><br><span class=line>440</span><br><span class=line>441</span><br><span class=line>442</span><br><span class=line>443</span><br><span class=line>444</span><br><span class=line>445</span><br><span class=line>446</span><br><span class=line>447</span><br><span class=line>448</span><br><span class=line>449</span><br><span class=line>450</span><br><span class=line>451</span><br><span class=line>452</span><br><span class=line>453</span><br><span class=line>454</span><br><span class=line>455</span><br><span class=line>456</span><br><span class=line>457</span><br><span class=line>458</span><br><span class=line>459</span><br><span class=line>460</span><br><span class=line>461</span><br><span class=line>462</span><br><span class=line>463</span><br><span class=line>464</span><br><span class=line>465</span><br><span class=line>466</span><br><span class=line>467</span><br><span class=line>468</span><br><span class=line>469</span><br><span class=line>470</span><br><span class=line>471</span><br><span class=line>472</span><br><span class=line>473</span><br><span class=line>474</span><br><span class=line>475</span><br><span class=line>476</span><br><span class=line>477</span><br><span class=line>478</span><br><span class=line>479</span><br><span class=line>480</span><br><span class=line>481</span><br><span class=line>482</span><br><span class=line>483</span><br><span class=line>484</span><br><span class=line>485</span><br><span class=line>486</span><br><span class=line>487</span><br><span class=line>488</span><br><span class=line>489</span><br><span class=line>490</span><br><span class=line>491</span><br><span class=line>492</span><br><span class=line>493</span><br><span class=line>494</span><br><span class=line>495</span><br><span class=line>496</span><br><span class=line>497</span><br><span class=line>498</span><br><span class=line>499</span><br><span class=line>500</span><br><span class=line>501</span><br><span class=line>502</span><br><span class=line>503</span><br><span class=line>504</span><br><span class=line>505</span><br><span class=line>506</span><br><span class=line>507</span><br><span class=line>508</span><br><span class=line>509</span><br><span class=line>510</span><br><span class=line>511</span><br><span class=line>512</span><br><span class=line>513</span><br><span class=line>514</span><br><span class=line>515</span><br><span class=line>516</span><br><span class=line>517</span><br><span class=line>518</span><br><span class=line>519</span><br><span class=line>520</span><br><span class=line>521</span><br><span class=line>522</span><br><span class=line>523</span><br><span class=line>524</span><br><span class=line>525</span><br><span class=line>526</span><br><span class=line>527</span><br><span class=line>528</span><br><span class=line>529</span><br><span class=line>530</span><br><span class=line>531</span><br><span class=line>532</span><br><span class=line>533</span><br><span class=line>534</span><br><span class=line>535</span><br><span class=line>536</span><br><span class=line>537</span><br><span class=line>538</span><br><span class=line>539</span><br><span class=line>540</span><br><span class=line>541</span><br><span class=line>542</span><br><span class=line>543</span><br><span class=line>544</span><br><span class=line>545</span><br><span class=line>546</span><br><span class=line>547</span><br><span class=line>548</span><br><span class=line>549</span><br><span class=line>550</span><br><span class=line>551</span><br><span class=line>552</span><br><span class=line>553</span><br><span class=line>554</span><br><span class=line>555</span><br><span class=line>556</span><br><span class=line>557</span><br><span class=line>558</span><br><span class=line>559</span><br><span class=line>560</span><br><span class=line>561</span><br><span class=line>562</span><br><span class=line>563</span><br><span class=line>564</span><br><span class=line>565</span><br><span class=line>566</span><br><span class=line>567</span><br><span class=line>568</span><br><span class=line>569</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>package</span> com.example.bbandroid;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> androidx.cardview.widget.ۤۦ۠ۧ;</span><br><span class=line><span class=keyword>import</span> androidx.constraintlayout.core.motion.parse.۟ۥۡۦ۟;</span><br><span class=line><span class=keyword>import</span> androidx.constraintlayout.core.widgets.analyzer.۟ۡۧ۠ۢ;</span><br><span class=line><span class=keyword>import</span> androidx.core.view.autofill.۟ۢۦۧۥ;</span><br><span class=line><span class=keyword>import</span> androidx.legacy.coreutils.۟ۥۤۦۤ;</span><br><span class=line><span class=keyword>import</span> androidx.lifecycle.viewmodel.۟ۦۡ۟ۥ;</span><br><span class=line><span class=keyword>import</span> androidx.localbroadcastmanager.ۥۣۡ۠;</span><br><span class=line><span class=keyword>import</span> androidx.startup.ۣ۟ۧ۠ۧ;</span><br><span class=line><span class=keyword>import</span> androidx.vectordrawable.۟ۡ۠ۤۨ;</span><br><span class=line><span class=keyword>import</span> androidx.versionedparcelable.۟ۧۤ۟ۧ;</span><br><span class=line><span class=keyword>import</span> com.google.android.material.appbar.ۣ۟ۧ۠;</span><br><span class=line><span class=keyword>import</span> com.google.android.material.datepicker.ۦۣۧۥ;</span><br><span class=line><span class=keyword>import</span> com.google.android.material.imageview.ۣ۟۟ۨۥ;</span><br><span class=line><span class=keyword>import</span> com.google.android.material.theme.ۢۧ۟ۢ;</span><br><span class=line><span class=keyword>import</span> com.google.android.material.transition.platform.۟۠۟ۧۡ;</span><br><span class=line><span class=keyword>import</span> java.util.Arrays;</span><br><span class=line><span class=keyword>import</span> kotlin.comparisons.۟ۦۤ۠ۢ;</span><br><span class=line><span class=keyword>import</span> kotlin.enums.۟ۥۧۡ۠;</span><br><span class=line><span class=keyword>import</span> kotlin.internal.jdk8.ۦۤۤۡ;</span><br><span class=line><span class=keyword>import</span> kotlinx.coroutines.android.ۥۣ۠۟;</span><br><span class=line><span class=keyword>import</span> kotlinx.coroutines.sync.ۦۨۦۤ;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">strange</span> {</span><br><span class=line>   <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>char</span>[] ALPHABET;</span><br><span class=line>   <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>int</span>[] LOOKUP;</span><br><span class=line>   <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>short</span>[] <span class=type>short</span>;</span><br><span class=line></span><br><span class=line>   <span class=keyword>static</span> {</span><br><span class=line>      <span class=type>int</span> <span class=variable>var0</span> <span class=operator>=</span> <span class=number>1754379</span>;</span><br><span class=line>      <span class=type>char</span>[] var3 = <span class=literal>null</span>;</span><br><span class=line>      <span class=type>int</span>[] var4 = <span class=literal>null</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var1</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var2</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>      <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>         <span class=keyword>switch</span> (var0) {</span><br><span class=line>            <span class=keyword>case</span> <span class=number>56419</span>:</span><br><span class=line>               <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">ArithmeticException</span>(<span class=string>"divide by zero"</span>);</span><br><span class=line>            <span class=keyword>case</span> <span class=number>56544</span>:</span><br><span class=line>               var3 = ALPHABET;</span><br><span class=line>               var0 = <span class=number>1747810</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1747810</span>:</span><br><span class=line>               <span class=keyword>if</span> (var2 &lt; var3.length) {</span><br><span class=line>                  ۟ۡۧ۠ۢ.ۣ۟ۧۧ۟();</span><br><span class=line>                  var0 = <span class=number>1754375</span>;</span><br><span class=line>                  <span class=keyword>continue</span>;</span><br><span class=line>               }</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1752551</span>:</span><br><span class=line>               ۢۧ۟ۢ.ۣ۟ۥۢۤ();</span><br><span class=line>               <span class=type>String</span> <span class=variable>var9</span> <span class=operator>=</span> <span class=string>"ۣۤ"</span>;</span><br><span class=line>               var0 = <span class=number>56447</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1748613</span>:</span><br><span class=line>               var0 = <span class=number>1755336</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1748796</span>:</span><br><span class=line>               LOOKUP[<span class=number>61</span>] = <span class=number>0</span>;</span><br><span class=line>               var0 = <span class=number>1753508</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1749574</span>:</span><br><span class=line>               LOOKUP[var3[var2]] = var2;</span><br><span class=line>               var0 = <span class=number>1749729</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1749729</span>:</span><br><span class=line>               var1 = var2 + <span class=number>1</span>;</span><br><span class=line>               ۦۤۤۡ.ۨۥۢ۟ = <span class=number>7</span>;</span><br><span class=line>               var0 = <span class=number>1749729</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1750562</span>:</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1750625</span>:</span><br><span class=line>               var0 = <span class=number>56544</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1750813</span>:</span><br><span class=line>               var4 = <span class=keyword>new</span> <span class="title class_">int</span>[<span class=number>256</span>];</span><br><span class=line>               <span class=type>String</span> <span class=variable>var8</span> <span class=operator>=</span> <span class=string>"ۧۨۧ"</span>;</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1751554</span>:</span><br><span class=line>               var0 = <span class=number>1754379</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1751648</span>:</span><br><span class=line>               ALPHABET = ۦۣۧۥ.ۣۣۡ۟(<span class=type>short</span>, <span class=number>0</span>, <span class=number>64</span>, <span class=number>3052</span>).toCharArray();</span><br><span class=line>               ۟ۥۡۦ۟.ۣ۟ۡ۟۠();</span><br><span class=line>               var0 = <span class=number>1754379</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1752648</span>:</span><br><span class=line>               var0 = <span class=number>1751554</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1753508</span>:</span><br><span class=line>               <span class=keyword>if</span> (oOo0.isPortInUse(<span class=number>27042</span>)) {</span><br><span class=line>                  var0 = <span class=number>56419</span>;</span><br><span class=line>                  <span class=keyword>continue</span>;</span><br><span class=line>               }</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1751775</span>:</span><br><span class=line>               var0 = <span class=number>1755624</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1754375</span>:</span><br><span class=line>               Arrays.fill(var4, -<span class=number>1</span>);</span><br><span class=line>               <span class=type>String</span> <span class=variable>var7</span> <span class=operator>=</span> <span class=string>"ۣۡ۟"</span>;</span><br><span class=line>               var0 = <span class=number>1748613</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1754379</span>:</span><br><span class=line>               <span class=type>short</span> = <span class=keyword>new</span> <span class="title class_">short</span>[]{</span><br><span class=line>                  <span class=number>2946</span>,</span><br><span class=line>                  <span class=number>2947</span>,</span><br><span class=line>                  <span class=number>2972</span>,</span><br><span class=line>                  <span class=number>2973</span>,</span><br><span class=line>                  <span class=number>2974</span>,</span><br><span class=line>                  <span class=number>2975</span>,</span><br><span class=line>                  <span class=number>2968</span>,</span><br><span class=line>                  <span class=number>2984</span>,</span><br><span class=line>                  <span class=number>2985</span>,</span><br><span class=line>                  <span class=number>2986</span>,</span><br><span class=line>                  <span class=number>2987</span>,</span><br><span class=line>                  <span class=number>2980</span>,</span><br><span class=line>                  <span class=number>2981</span>,</span><br><span class=line>                  <span class=number>2982</span>,</span><br><span class=line>                  <span class=number>2983</span>,</span><br><span class=line>                  <span class=number>2976</span>,</span><br><span class=line>                  <span class=number>2948</span>,</span><br><span class=line>                  <span class=number>2949</span>,</span><br><span class=line>                  <span class=number>2950</span>,</span><br><span class=line>                  <span class=number>2951</span>,</span><br><span class=line>                  <span class=number>2944</span>,</span><br><span class=line>                  <span class=number>3001</span>,</span><br><span class=line>                  <span class=number>3002</span>,</span><br><span class=line>                  <span class=number>3005</span>,</span><br><span class=line>                  <span class=number>3006</span>,</span><br><span class=line>                  <span class=number>3007</span>,</span><br><span class=line>                  <span class=number>3000</span>,</span><br><span class=line>                  <span class=number>3011</span>,</span><br><span class=line>                  <span class=number>3003</span>,</span><br><span class=line>                  <span class=number>2996</span>,</span><br><span class=line>                  <span class=number>2997</span>,</span><br><span class=line>                  <span class=number>2998</span>,</span><br><span class=line>                  <span class=number>2957</span>,</span><br><span class=line>                  <span class=number>2958</span>,</span><br><span class=line>                  <span class=number>2989</span>,</span><br><span class=line>                  <span class=number>2990</span>,</span><br><span class=line>                  <span class=number>2991</span>,</span><br><span class=line>                  <span class=number>2959</span>,</span><br><span class=line>                  <span class=number>2952</span>,</span><br><span class=line>                  <span class=number>2953</span>,</span><br><span class=line>                  <span class=number>2954</span>,</span><br><span class=line>                  <span class=number>2955</span>,</span><br><span class=line>                  <span class=number>2945</span>,</span><br><span class=line>                  <span class=number>2969</span>,</span><br><span class=line>                  <span class=number>2970</span>,</span><br><span class=line>                  <span class=number>3034</span>,</span><br><span class=line>                  <span class=number>3035</span>,</span><br><span class=line>                  <span class=number>3028</span>,</span><br><span class=line>                  <span class=number>3029</span>,</span><br><span class=line>                  <span class=number>3015</span>,</span><br><span class=line>                  <span class=number>2971</span>,</span><br><span class=line>                  <span class=number>2964</span>,</span><br><span class=line>                  <span class=number>2965</span>,</span><br><span class=line>                  <span class=number>2966</span>,</span><br><span class=line>                  <span class=number>3036</span>,</span><br><span class=line>                  <span class=number>3037</span>,</span><br><span class=line>                  <span class=number>3038</span>,</span><br><span class=line>                  <span class=number>3039</span>,</span><br><span class=line>                  <span class=number>3032</span>,</span><br><span class=line>                  <span class=number>3033</span>,</span><br><span class=line>                  <span class=number>2977</span>,</span><br><span class=line>                  <span class=number>2978</span>,</span><br><span class=line>                  <span class=number>2979</span>,</span><br><span class=line>                  <span class=number>3004</span></span><br><span class=line>               };</span><br><span class=line>               var0 = <span class=number>1751648</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1754662</span>:</span><br><span class=line>               LOOKUP = var4;</span><br><span class=line>               ۣ۟۟ۨۥ.ۤۢۡ = <span class=number>22</span>;</span><br><span class=line>               <span class=type>String</span> <span class=variable>var6</span> <span class=operator>=</span> <span class=string>"ۣۡ۟"</span>;</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1755336</span>:</span><br><span class=line>               var0 = <span class=number>56544</span>;</span><br><span class=line>               var2 = <span class=number>0</span>;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1755560</span>:</span><br><span class=line>               <span class=type>String</span> <span class=variable>var5</span> <span class=operator>=</span> <span class=string>"ۥۥۨ"</span>;</span><br><span class=line>               var0 = <span class=number>1750562</span>;</span><br><span class=line>               var2 = var1;</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1755624</span>:</span><br><span class=line>               <span class=keyword>return</span>;</span><br><span class=line>            <span class=keyword>default</span>:</span><br><span class=line>               <span class=keyword>continue</span>;</span><br><span class=line>         }</span><br><span class=line></span><br><span class=line>         var0 = <span class=number>1755560</span>;</span><br><span class=line>      }</span><br><span class=line>   }</span><br><span class=line></span><br><span class=line>   <span class=keyword>public</span> <span class="title function_">strange</span><span class=params>()</span> {</span><br><span class=line>      <span class=type>int</span> <span class=variable>var1</span> <span class=operator>=</span> <span class=number>56474</span>;</span><br><span class=line>      <span class=type>Integer</span> <span class=variable>var2</span> <span class=operator>=</span> <span class=literal>null</span>;</span><br><span class=line></span><br><span class=line>      <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>         <span class=keyword>switch</span> (var1) {</span><br><span class=line>            <span class=keyword>case</span> <span class=number>56474</span>:</span><br><span class=line>               <span class=keyword>if</span> (۟ۦۡ۟ۥ.۟ۥۥۥۧ() &lt;= <span class=number>0</span>) {</span><br><span class=line>                  ۤۦ۠ۧ.۠ۦۨ();</span><br><span class=line>                  var1 = <span class=number>56474</span>;</span><br><span class=line>                  <span class=keyword>break</span>;</span><br><span class=line>               }</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1754440</span>:</span><br><span class=line>               <span class=type>String</span> <span class=variable>var4</span> <span class=operator>=</span> <span class=string>"ۥۣۨ"</span>;</span><br><span class=line>               var1 = <span class=number>1751618</span>;</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1746751</span>:</span><br><span class=line>               System.out.println(var2);</span><br><span class=line>               <span class=type>String</span> <span class=variable>var3</span> <span class=operator>=</span> <span class=string>"ۥۣۨ"</span>;</span><br><span class=line>               var1 = <span class=number>1752736</span>;</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1748859</span>:</span><br><span class=line>               var2 = Integer.valueOf(۟ۢۦۧۥ.ۣۣ۟۟ۧ(<span class=string>"LV4FmlkaVyEOjznZ4"</span>));</span><br><span class=line>               var1 = <span class=number>1746784</span> + (۟۠۟ۧۡ.۟ۦۣۡۨ | ۦۨۦۤ.ۥۣۣ۟);</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1750817</span>:</span><br><span class=line>               var1 = <span class=number>56474</span>;</span><br><span class=line>               <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1752736</span>:</span><br><span class=line>               <span class=keyword>return</span>;</span><br><span class=line>         }</span><br><span class=line>      }</span><br><span class=line>   }</span><br><span class=line></span><br><span class=line>   <span class=keyword>public</span> <span class=keyword>static</span> String <span class="title function_">encode</span><span class=params>(<span class=type>byte</span>[] var0)</span> {</span><br><span class=line>      <span class=type>boolean</span> <span class=variable>var24</span> <span class=operator>=</span> <span class=literal>false</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var18</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var20</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var19</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var11</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var10</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var16</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var17</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var14</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var13</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>char</span>[] var26 = <span class=literal>null</span>;</span><br><span class=line>      <span class=type>byte</span> <span class=variable>var2</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>char</span> <span class=variable>var5</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>byte</span> <span class=variable>var6</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>char</span> <span class=variable>var4</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>char</span> <span class=variable>var3</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>char</span> <span class=variable>var1</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var9</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var8</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var21</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var15</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var12</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>      <span class=type>int</span> <span class=variable>var7</span> <span class=operator>=</span> <span class=number>1748833</span>;</span><br><span class=line>      <span class=type>StringBuilder</span> <span class=variable>var28</span> <span class=operator>=</span> <span class=literal>null</span>;</span><br><span class=line>      <span class=type>boolean</span> <span class=variable>var23</span> <span class=operator>=</span> <span class=literal>false</span>;</span><br><span class=line></span><br><span class=line>      <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>         label246:</span><br><span class=line>         <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>            label244:</span><br><span class=line>            <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>               label242:</span><br><span class=line>               <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                  label238:</span><br><span class=line>                  <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                     label223:</span><br><span class=line>                     <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                        label219:</span><br><span class=line>                        <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                           label213:</span><br><span class=line>                           <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                              label203:</span><br><span class=line>                              <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                                 label197:</span><br><span class=line>                                 <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                                    label191:</span><br><span class=line>                                    <span class=keyword>while</span> (<span class=literal>true</span>) {</span><br><span class=line>                                       <span class=keyword>switch</span> (var7) {</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>56356</span>:</span><br><span class=line>                                             var7 = <span class=number>56474</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>56390</span>:</span><br><span class=line>                                             var7 = <span class=number>2</span> + var9;</span><br><span class=line>                                             <span class=keyword>if</span> (var7 &lt; var0.length) {</span><br><span class=line>                                                <span class=type>byte</span> <span class=variable>var42</span> <span class=operator>=</span> var0[var7];</span><br><span class=line>                                                var7 = <span class=number>255</span> &amp; var42;</span><br><span class=line>                                                <span class=type>String</span> <span class=variable>var69</span> <span class=operator>=</span> <span class=string>"ۢۨۢ"</span>;</span><br><span class=line>                                                <span class=keyword>break</span> label246;</span><br><span class=line>                                             }</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751682</span>:</span><br><span class=line>                                             ۥۣۡ۠.۟ۥۣ۠ۤ();</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var68</span> <span class=operator>=</span> <span class=string>"ۥ۟ۨ"</span>;</span><br><span class=line>                                             var7 = <span class=number>1752490</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>56543</span>:</span><br><span class=line>                                             var17 = var10 + <span class=number>1</span>;</span><br><span class=line>                                             var7 = <span class=number>1751655</span>;</span><br><span class=line>                                             var14 = var11;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>56570</span>:</span><br><span class=line>                                             var7 = <span class=number>1747931</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1746752</span>:</span><br><span class=line>                                             <span class=keyword>break</span> label197;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747714</span>:</span><br><span class=line>                                             <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">ArithmeticException</span>(<span class=string>"divide by zero"</span>);</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747808</span>:</span><br><span class=line>                                             <span class=type>StringBuilder</span> <span class=variable>var66</span> <span class=operator>=</span> var28.append(var1);</span><br><span class=line>                                             var7 = var9 + <span class=number>3</span>;</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var67</span> <span class=operator>=</span> <span class=string>"ۦۢۥ"</span>;</span><br><span class=line>                                             <span class=keyword>break</span> label238;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747874</span>:</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747931</span>:</span><br><span class=line>                                             ۥۣ۠۟.ۣۦ۠ۥ = <span class=number>11</span>;</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var65</span> <span class=operator>=</span> <span class=string>"ۦۣۨ"</span>;</span><br><span class=line>                                             var7 = var8;</span><br><span class=line>                                             <span class=keyword>break</span> label219;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747927</span>:</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var64</span> <span class=operator>=</span> <span class=string>"ۦۧ۠"</span>;</span><br><span class=line>                                             <span class=type>int</span> <span class=variable>var49</span> <span class=operator>=</span> <span class=number>1750597</span>;</span><br><span class=line>                                             var14 = var14;</span><br><span class=line>                                             var7 = <span class=number>1750597</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1747928</span>:</span><br><span class=line>                                             var7 = var0.length;</span><br><span class=line>                                             var21 = var7;</span><br><span class=line>                                             <span class=type>int</span> <span class=variable>var48</span> <span class=operator>=</span> <span class=number>1753416</span>;</span><br><span class=line>                                             var12 = <span class=number>0</span>;</span><br><span class=line>                                             var15 = var7;</span><br><span class=line>                                             var7 = var48;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1748645</span>:</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1754570</span>:</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var63</span> <span class=operator>=</span> <span class=string>"ۢۨ"</span>;</span><br><span class=line>                                             var7 = var9;</span><br><span class=line>                                             <span class=keyword>break</span> label238;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1748799</span>:</span><br><span class=line>                                             var7 = <span class=number>1748645</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1748833</span>:</span><br><span class=line>                                             var23 = <span class=keyword>new</span> <span class="title class_">MainActivity</span>().initSth();</span><br><span class=line>                                             var24 = oOo0.isPortInUse(<span class=number>27042</span>);</span><br><span class=line>                                             var7 = <span class=number>1750815</span>;</span><br><span class=line>                                             var23 = var24;</span><br><span class=line>                                             var24 = var23;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1749603</span>:</span><br><span class=line>                                             var3 = var26[<span class=number>63</span> &amp; var14];</span><br><span class=line>                                             var7 = <span class=number>1751588</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1749672</span>:</span><br><span class=line>                                             var7 = <span class=number>1755465</span>;</span><br><span class=line>                                             var4 = (<span class=type>char</span>)var6;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1749852</span>:</span><br><span class=line>                                             var7 = var11 &amp; var16 | var11 ^ var16;</span><br><span class=line>                                             <span class=type>int</span> <span class=variable>var47</span> <span class=operator>=</span> <span class=number>1747927</span>;</span><br><span class=line>                                             var13 = var10;</span><br><span class=line>                                             var14 = var7;</span><br><span class=line>                                             var7 = var47;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1749853</span>:</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753663</span>:</span><br><span class=line>                                             ۣ۟ۧ۠ۧ.ۨۦۣ۠ = <span class=number>67</span>;</span><br><span class=line>                                             var7 = <span class=number>1746971</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1750568</span>:</span><br><span class=line>                                             var12++;</span><br><span class=line>                                             var7 = <span class=number>56356</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1750597</span>:</span><br><span class=line>                                             <span class=keyword>break</span> label203;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1750662</span>:</span><br><span class=line>                                             var7 = <span class=number>1748833</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1750815</span>:</span><br><span class=line>                                             <span class=keyword>if</span> (var23) {</span><br><span class=line>                                                var7 = <span class=number>1747714</span>;</span><br><span class=line>                                                <span class=keyword>continue</span>;</span><br><span class=line>                                             }</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753607</span>:</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var61</span> <span class=operator>=</span> <span class=string>"ۥۣۢ"</span>;</span><br><span class=line>                                             var7 = var9;</span><br><span class=line>                                             <span class=keyword>break</span> label238;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751493</span>:</span><br><span class=line>                                             var2 = <span class=number>61</span>;</span><br><span class=line>                                             <span class=keyword>if</span> (var13 &lt; <span class=number>2</span>) {</span><br><span class=line>                                                var5 = var26[var14 &gt;&gt; (۟ۥۧۡ۠.۟ۢۧۢۧ ^ <span class=number>74</span>) &amp; <span class=number>63</span>];</span><br><span class=line>                                                var2 = <span class=number>61</span>;</span><br><span class=line>                                                <span class=type>int</span> <span class=variable>var46</span> <span class=operator>=</span> <span class=number>1754629</span>;</span><br><span class=line>                                                var11 = var11;</span><br><span class=line>                                                var7 = var46;</span><br><span class=line>                                                <span class=keyword>continue</span>;</span><br><span class=line>                                             }</span><br><span class=line>                                             <span class=keyword>break</span> label203;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751530</span>:</span><br><span class=line>                                             ۟ۦۤ۠ۢ.ۣ۟ۡۧ۠();</span><br><span class=line>                                             var7 = <span class=number>56543</span>;</span><br><span class=line>                                             var10 = var19;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751561</span>:</span><br><span class=line>                                             var19 = var8 + <span class=number>1</span>;</span><br><span class=line>                                             var7 = <span class=number>1751530</span>;</span><br><span class=line>                                             var11 = var18;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751563</span>:</span><br><span class=line>                                             var7 = <span class=number>1753452</span>;</span><br><span class=line>                                             var12 = <span class=number>0</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751588</span>:</span><br><span class=line>                                             ۟ۧۤ۟ۧ.ۣ۟۟ۧۧ();</span><br><span class=line>                                             var7 = <span class=number>1751561</span>;</span><br><span class=line>                                             var1 = var3;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751653</span>:</span><br><span class=line>                                             <span class=keyword>if</span> (var9 &lt; var0.length) {</span><br><span class=line>                                                var7 = (var0[var9] &amp; <span class=number>255</span>) &lt;&lt; <span class=number>16</span>;</span><br><span class=line>                                                var7 &amp;= -<span class=number>16777216</span> ^ var7;</span><br><span class=line>                                                <span class=type>int</span> <span class=variable>var45</span> <span class=operator>=</span> <span class=number>1752639</span>;</span><br><span class=line>                                                var18 = var7;</span><br><span class=line>                                                var7 = var45;</span><br><span class=line>                                                <span class=keyword>continue</span>;</span><br><span class=line>                                             }</span><br><span class=line>                                             <span class=keyword>break</span> label213;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1751655</span>:</span><br><span class=line>                                             ۟ۥۤۦۤ.۟ۢۨ۟ۨ = <span class=number>8</span>;</span><br><span class=line>                                             var7 = <span class=number>1747874</span>;</span><br><span class=line>                                             var13 = var17;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752489</span>:</span><br><span class=line>                                             <span class=keyword>return</span> var28.toString();</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752490</span>:</span><br><span class=line>                                             var26 = ALPHABET;</span><br><span class=line>                                             <span class=type>StringBuilder</span> <span class=variable>var59</span> <span class=operator>=</span> var28.append(var26[var14 &gt;&gt; <span class=number>18</span> &amp; <span class=number>63</span>]);</span><br><span class=line>                                             var59 = var28.append(var26[var14 &gt;&gt; <span class=number>12</span> &amp; <span class=number>63</span>]);</span><br><span class=line>                                             var7 = var20;</span><br><span class=line>                                             <span class=keyword>break</span> label242;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752580</span>:</span><br><span class=line>                                             var28 = <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();</span><br><span class=line>                                             var7 = <span class=number>1755468</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752616</span>:</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var58</span> <span class=operator>=</span> <span class=string>"ۧۨۧ"</span>;</span><br><span class=line>                                             var7 = var16;</span><br><span class=line>                                             <span class=keyword>break</span> label246;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752639</span>:</span><br><span class=line>                                             var7 = <span class=number>1</span> + var9;</span><br><span class=line>                                             <span class=keyword>if</span> (var7 &gt;= var0.length) {</span><br><span class=line>                                                <span class=keyword>break</span> label244;</span><br><span class=line>                                             }</span><br><span class=line></span><br><span class=line>                                             var7 = (var0[var7] &amp; (۟ۡ۠ۤۨ.ۥۥۡۤ ^ <span class=number>108</span>)) &lt;&lt; <span class=number>8</span>;</span><br><span class=line>                                             <span class=keyword>break</span> label242;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752709</span>:</span><br><span class=line>                                             var7 = <span class=number>1749672</span>;</span><br><span class=line>                                             var6 = <span class=number>61</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753416</span>:</span><br><span class=line>                                             <span class=keyword>if</span> (!var24) {</span><br><span class=line>                                                var7 = var21 + <span class=number>1</span>;</span><br><span class=line>                                                <span class=type>String</span> <span class=variable>var57</span> <span class=operator>=</span> <span class=string>"ۤۡۨ"</span>;</span><br><span class=line>                                                <span class=keyword>break</span> label223;</span><br><span class=line>                                             }</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>56474</span>:</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1752710</span>:</span><br><span class=line>                                             var7 = <span class=number>1753452</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753452</span>:</span><br><span class=line>                                             <span class=keyword>if</span> (var12 &lt; var28.length()) {</span><br><span class=line>                                                <span class=type>char</span> <span class=variable>var32</span> <span class=operator>=</span> var28.charAt(var12);</span><br><span class=line>                                                var28.setCharAt(var12, (<span class=type>char</span>)(var32 &amp; ~var15 | ~var32 &amp; var15));</span><br><span class=line>                                                var7 = <span class=number>1750568</span>;</span><br><span class=line>                                                <span class=keyword>continue</span>;</span><br><span class=line>                                             }</span><br><span class=line>                                             <span class=keyword>break</span> label197;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753484</span>:</span><br><span class=line>                                             <span class=keyword>break</span> label213;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753513</span>:</span><br><span class=line>                                             <span class=type>String</span> <span class=variable>var56</span> <span class=operator>=</span> <span class=string>"ۨۢ"</span>;</span><br><span class=line>                                             var7 = var13;</span><br><span class=line>                                             <span class=keyword>break</span> label219;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753544</span>:</span><br><span class=line>                                             <span class=keyword>break</span> label244;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1753545</span>:</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1754662</span>:</span><br><span class=line>                                             var7 = <span class=number>1755465</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1754376</span>:</span><br><span class=line>                                             var7 = var18 ^ var20 | var18 &amp; var20;</span><br><span class=line>                                             <span class=type>int</span> <span class=variable>var22</span> <span class=operator>=</span> <span class=number>1748799</span>;</span><br><span class=line>                                             var11 = var7;</span><br><span class=line>                                             var10 = var8;</span><br><span class=line>                                             var7 = var22;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1754629</span>:</span><br><span class=line>                                             var7 = <span class=number>1752616</span>;</span><br><span class=line>                                             var4 = var5;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1754656</span>:</span><br><span class=line>                                             var7 = <span class=number>1751653</span>;</span><br><span class=line>                                             var9 = <span class=number>0</span>;</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1755374</span>:</span><br><span class=line>                                             <span class=keyword>break</span> label191;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1755465</span>:</span><br><span class=line>                                             <span class=type>StringBuilder</span> <span class=variable>var27</span> <span class=operator>=</span> var28.append(var4);</span><br><span class=line>                                             <span class=keyword>if</span> (var13 &gt;= <span class=number>1</span>) {</span><br><span class=line>                                                var1 = (<span class=type>char</span>)var2;</span><br><span class=line>                                                <span class=keyword>break</span> label191;</span><br><span class=line>                                             }</span><br><span class=line></span><br><span class=line>                                             ۣ۟ۧ۠.۟ۢۥۢ();</span><br><span class=line>                                             var1 = (<span class=type>char</span>)var2;</span><br><span class=line>                                             <span class=keyword>break</span>;</span><br><span class=line>                                          <span class=keyword>case</span> <span class=number>1755468</span>:</span><br><span class=line>                                             var8 = <span class=number>0</span>;</span><br><span class=line>                                             <span class=keyword>break</span>;</span><br><span class=line>                                          <span class=keyword>default</span>:</span><br><span class=line>                                             <span class=keyword>continue</span>;</span><br><span class=line>                                       }</span><br><span class=line></span><br><span class=line>                                       <span class=type>String</span> <span class=variable>var55</span> <span class=operator>=</span> <span class=string>"ۧۨۡ"</span>;</span><br><span class=line>                                       var7 = var15;</span><br><span class=line>                                       <span class=keyword>break</span> label223;</span><br><span class=line>                                    }</span><br><span class=line></span><br><span class=line>                                    var7 = <span class=number>1747808</span>;</span><br><span class=line>                                 }</span><br><span class=line></span><br><span class=line>                                 var7 = <span class=number>1748679</span>;</span><br><span class=line>                              }</span><br><span class=line></span><br><span class=line>                              <span class=type>String</span> <span class=variable>var62</span> <span class=operator>=</span> <span class=string>"ۥۧۧ"</span>;</span><br><span class=line>                              var7 = <span class=number>1748769</span>;</span><br><span class=line>                           }</span><br><span class=line></span><br><span class=line>                           var7 = <span class=number>1747928</span>;</span><br><span class=line>                        }</span><br><span class=line></span><br><span class=line>                        <span class=type>int</span> <span class=variable>var50</span> <span class=operator>=</span> <span class=number>1753547</span>;</span><br><span class=line>                        var8 = var7;</span><br><span class=line>                        var7 = <span class=number>1753547</span>;</span><br><span class=line>                     }</span><br><span class=line></span><br><span class=line>                     <span class=type>int</span> <span class=variable>var43</span> <span class=operator>=</span> <span class=number>1754656</span>;</span><br><span class=line>                     var15 = var7;</span><br><span class=line>                     var7 = <span class=number>1754656</span>;</span><br><span class=line>                  }</span><br><span class=line></span><br><span class=line>                  <span class=type>int</span> <span class=variable>var51</span> <span class=operator>=</span> <span class=number>1752580</span>;</span><br><span class=line>                  var9 = var7;</span><br><span class=line>                  var7 = <span class=number>1752580</span>;</span><br><span class=line>               }</span><br><span class=line></span><br><span class=line>               <span class=type>int</span> <span class=variable>var44</span> <span class=operator>=</span> <span class=number>1754376</span>;</span><br><span class=line>               var20 = var7;</span><br><span class=line>               var7 = var44;</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            var7 = <span class=number>1751561</span>;</span><br><span class=line>         }</span><br><span class=line></span><br><span class=line>         <span class=type>int</span> <span class=variable>var52</span> <span class=operator>=</span> <span class=number>1750753</span>;</span><br><span class=line>         var16 = var7;</span><br><span class=line>         var7 = <span class=number>1750753</span>;</span><br><span class=line>      }</span><br><span class=line>   }</span><br><span class=line>}</span><br></pre></td></tr></table></figure><p>反混淆结束后可以勉强看出 Java 层是一个换表的 Base64，同时 Base64 表是被异或处理过的<br>同时推荐使用 Recaf，可以把所有非 ASCII 码表的字符重命名，生成一份 Mapping，对逆向有很大的帮助</p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061721653.png></p><p>码表操作<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061722387.png></p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061723899.png></p><p><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061723110.png></p><p>执行后可以得到码表 <code>nopqrstDEFGHIJKLhijklUVQRST/WXYZabABCcdefgmuv6789+wxyz012345MNOP</code></p><p>这里的 var15 经过追踪得到是 传入数组的长度<br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061735907.png><br><img lazyload="" alt=image.png data-src=https://s3.carbo.ink/img/old_imgs/202410061731431.png></p><p>这里的 <code>var32 &amp; ~var15 | ~var32 &amp; var15</code> 其实就是 <code>var32 ^ var15</code> 被拆开了 其实是等价的<br>最终 Java 层的功能就是 换表base64 + 每个字符异或上输入字符串的长度</p></div><div class="post-copyright-info-container border-box"><div class="copyright-info-content border-box"><div class="copyright-info-top border-box"><div class="copyright-post-title border-box text-ellipsis">NP管理器DEX加固解混淆</div><div class="copyright-post-link border-box text-ellipsis">2024/10/06/np_obfuscation/</div></div><div class="copyright-info-bottom border-box"><div class="copyright-post-author bottom-item"><div class=type>作者</div><div class=content>carbofish</div></div><div class="post-time bottom-item"><div class=type>发布于</div><div class=content>2024-10-06 15:12</div></div><div class="post-license bottom-item"><div class=type>许可</div><div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0"><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><i class="fa-brands fa-creative-commons"></i> <i class="fa-brands fa-creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc"></i> <i class="fa-brands fa-creative-commons-sa"></i></a></div></div></div><i class="copyright-bg fa-solid fa-copyright"></i></div><div class="copy-copyright-info flex-center tooltip" data-tooltip-content=复制版权信息 data-tooltip-offset-y=-2px><i class="fa-solid fa-copy"></i></div></div><div class="post-bottom-tags-and-share border-box"><div><ul class="post-tags-box border-box"><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/Reverse/ >Reverse</a></li><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/NP/ >NP</a></li><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/Java/ >Java</a></li><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/Obfuscation/ >Obfuscation</a></li></ul></div><div></div></div><div class="post-nav border-box"><div class=prev-post><a class=prev rel=prev href=/2024/10/12/deollvm/ title="OLLVM 解混淆学习"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">OLLVM 解混淆学习</span> <span class=post-nav-item>上一篇</span></span></a></div><div class=next-post><a class=next rel=next href=/2024/10/06/encode_decode/ title=常见加密解密编码算法><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">常见加密解密编码算法</span> <span class=post-nav-item>下一篇</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comments-container border-box"><div id=comments-anchor class="comment-area-title border-box"><i class="fas fa-comments"></i>&nbsp;评论</div><div class="comment-plugin-fail border-box"><span class=fail-tip>评论插件加载失败</span> <button class="reload keep-button">点击重新加载</button></div><div class="comment-plugin-loading flex-center border-box"><i class="loading-icon fa-solid fa-spinner fa-spin"></i> <span class=load-tip>正在加载评论插件</span></div><script data-pjax>window.KeepCommentPlugin={},window.KeepCommentPlugin.hideLoading=()=>{document.querySelector(".comments-container .comment-plugin-loading").style.display="none"},window.KeepCommentPlugin.loadFailHandle=()=>{window.KeepCommentPlugin.hideLoading();var e=document.querySelector(".comments-container .comment-plugin-fail");e.style.display="flex",e.querySelector(".reload").addEventListener("click",()=>{window.location.reload()})}</script><div class=waline-comment-container><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline-meta.css><div id=waline-comment></div><script data-pjax>window.KeepCommentPlugin.walineOptions=JSON.parse("{}".replace(/&#34;/g,'"')),window.KeepCommentPlugin.walineOptions.el="#waline-comment",window.KeepCommentPlugin.walineOptions.comment=".post-comments-count",window.KeepCommentPlugin.walineOptions.serverURL="https://comment.carbo.ink/",window.KeepCommentPlugin.walineOptions.lang="zh-CN",window.KeepCommentPlugin.walineOptions.reaction=!0</script><script data-pjax async type=module>import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('true' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }</script></div></div></div></div><div class="pc-post-toc right-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#Dex-%E8%BD%AC-Jar><span class=nav-text>Dex 转 Jar</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%8D%E6%B7%B7%E6%B7%86%E9%83%A8%E5%88%86><span class=nav-text>反混淆部分</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86><span class=nav-text>控制流混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%95%B0%E5%AD%97%E6%B7%B7%E6%B7%86><span class=nav-text>数字混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#FakeJump-%E4%B8%8D%E5%8F%AF%E8%BE%BE%E8%B7%B3%E8%BD%AC%E6%B7%B7%E6%B7%86><span class=nav-text>FakeJump 不可达跳转混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%8F%98%E9%87%8F%E5%BC%95%E7%94%A8%E6%B7%B7%E6%B7%86><span class=nav-text>变量引用混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E6%B7%B7%E6%B7%86><span class=nav-text>方法调用混淆</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%80%BB%E7%BB%93><span class=nav-text>总结</span></a></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom border-box"><footer class="footer border-box"><div class="copyright-info info-item">&copy;&nbsp;<span>2024</span>&nbsp;-&nbsp;2025 &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href=/ >carbofish</a></div><div class="theme-info info-item">由&nbsp;<a target=_blank href=https://hexo.io>Hexo</a>&nbsp;驱动&nbsp;&&nbsp;主题&nbsp;<a class=keep-version target=_blank href=https://github.com/XPoet/hexo-theme-keep>Keep</a></div><div class="count-info info-item"><span class="count-item border-box word"><span class="item-type border-box">总字数</span> <span class="item-value border-box word">55.5k</span> </span><span class="count-item border-box uv"><span class="item-type border-box">访客数</span> <span class="item-value border-box uv" id=vercount_value_site_uv></span> </span><span class="count-item border-box pv"><span class="item-type border-box">访问量</span> <span class="item-value border-box pv" id=vercount_value_site_pv></span></span></div></footer></div></div><div class="post-tools right-toc"><div class="post-tools-container border-box"><ul class="post-tools-list border-box"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class=post-comments-count></span></li><li class="tools-item flex-center full-screen"><i class="fa-solid fa-expand"></i></li></ul></div></div><div class=side-tools><div class="side-tools-container border-box"><ul class="side-tools-list side-tools-show-handle border-box"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-toggle-theme-mode flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list border-box"><li class="tools-item toggle-show-toc-tablet flex-center"><i class="fas fa-list"></i></li><li class="tools-item go-to-comments-tablet flex-center"><i class="fas fa-comment"></i></li><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center show-arrow"><i class="arrow fas fa-arrow-up"></i> <span class=percent></span></li></ul></div></div><div class=zoom-in-image-mask><img class=zoom-in-image></div><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-input-field-pre><i class="fas fa-keyboard"></i></span><div class=search-input-container><input autocomplete=off autocorrect=off autocapitalize=off placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=close-popup-btn><i class="fas fa-times"></i></span></div><div id=search-result><div id=no-result><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><div class=tablet-post-toc-mask><div class=tablet-post-toc><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#Dex-%E8%BD%AC-Jar><span class=nav-text>Dex 转 Jar</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%8D%E6%B7%B7%E6%B7%86%E9%83%A8%E5%88%86><span class=nav-text>反混淆部分</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86><span class=nav-text>控制流混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%95%B0%E5%AD%97%E6%B7%B7%E6%B7%86><span class=nav-text>数字混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#FakeJump-%E4%B8%8D%E5%8F%AF%E8%BE%BE%E8%B7%B3%E8%BD%AC%E6%B7%B7%E6%B7%86><span class=nav-text>FakeJump 不可达跳转混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%8F%98%E9%87%8F%E5%BC%95%E7%94%A8%E6%B7%B7%E6%B7%86><span class=nav-text>变量引用混淆</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E6%B7%B7%E6%B7%86><span class=nav-text>方法调用混淆</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%80%BB%E7%BB%93><span class=nav-text>总结</span></a></li></ol></div></div></div></div></main><script src=/js/utils.js></script><script src=/js/header-shrink.js></script><script src=/js/back2top.js></script><script src=/js/toggle-theme.js></script><script src=/js/code-block.js></script><script src=/js/main.js></script><script src=/js/libs/anime.min.js></script><script src=/js/local-search.js></script><script src=/js/lazyload.js></script><div class=pjax><script src=/js/post/post-helper.js></script><script src=/js/post/toc.js></script><script src=/js/post/copyright-info.js></script></div><script src=/js/mermaid.min.js></script><script data-pjax>window.mermaid&&mermaid.init()</script><script src=/js/libs/pjax.min.js></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.initExecute()})})</script></body></html>