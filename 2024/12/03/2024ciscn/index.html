<!DOCTYPE html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=keywords content="Hexo Theme Keep"><meta name=description content="Hexo Theme Keep"><meta name=author content=carbofish><title>2024 å›½èµ› Reverse æ–¹å‘ | Carbo</title><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/logo.png><link rel=stylesheet href=/font/css/fontawesome.min.css><link rel=stylesheet href=/font/css/regular.min.css><link rel=stylesheet href=/font/css/solid.min.css><link rel=stylesheet href=/font/css/brands.min.css><script class=keep-theme-configurations>let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"example.com",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={base_info:{primary_color:"#1abc9c",title:"Carbo",author:"carbofish",avatar:"/images/avatar.jpg",logo:"/images/logo.png",favicon:"/images/logo.png"},menu:{home:"/ || fa-solid fa-home",tags:"/tags || fa-solid fa-tags",links:"/links || fa-solid fa-link",about:"/about || fa-solid fa-user-graduate"},first_screen:{enable:!0,background_img:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",background_img_dark:"https://s3.carbo.ink/img/wallpaper/115959359_p0_r.jpg",description:"ç™½é›ªå´å«Œæ˜¥è‰²æ™šï¼Œæ¬²ç©¿åº­æ ‘ä½œé£èŠ±ã€‚",hitokoto:!1},social_contact:{enable:!1,links:{github:null,weixin:null,qq:"https://github.com/XPoet",weibo:null,zhihu:null,twitter:null,x:null,facebook:null,email:null}},scroll:{progress_bar:!0,percent:!0,hide_header:!0},home:{announcement:null,category:!0,tag:!0,post_datetime:"updated"},post:{author_badge:{enable:!1,level_badge:!0,custom_badge:["One","Two","Three"]},word_count:{wordcount:!0,min2read:!0},datetime_format:"YYYY-MM-DD HH:mm:ss",copyright_info:!0,share:!1,reward:{enable:!1,img_link:null,text:null,icon:null}},code_block:{tools:{enable:!0,style:"default"},highlight_theme:"default"},toc:{enable:!0,number:!1,expand_all:!1,init_open:!0,layout:"right"},website_count:{busuanzi_count:{enable:!0,site_uv:!0,site_pv:!0,page_pv:!0}},local_search:{enable:!0,preload:!0},comment:{enable:!0,use:"waline",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.36"},waline:{server_url:"https://comment.carbo.ink/",reaction:!0,version:"3.3.2",option:{dark:"auto"}},giscus:{repo:null,repo_id:null,category:"Announcements",category_id:null,reactions_enabled:!1},artalk:{server:null},disqus:{shortname:null}},rss:{enable:!1},lazyload:{enable:!0},cdn:{enable:!1,provider:"unpkg"},pjax:{enable:!0},footer:{since:2024,word_count:!0,site_deploy:{enable:!1,provider:"github",url:null},record:{enable:!1,list:[{code:null,link:null}]}},inject:{enable:!1,css:[null],js:[null]},root:"",source_data:{links:[{name:"PangBai",link:"https://pangbai.work/",avatar:"http://pangbai.work/images/avatar.jpg",description:"Bangbai | d180"},{name:"void2eye",link:"https://void2eye.fun/",avatar:"https://void2eye.fun/img/808.png",description:"æ”¿æ²»å®¶"},{name:"C3ngH",link:"https://c3ngh.top",avatar:"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg",description:"åŒ…ç½—ä¸‡è±¡å“¥"},{name:"A1ic3",link:"https://a1ic3.cn/",avatar:"https://a1ic3.cn/images/avatar1.jpg",description:"å°å¯†ç ç‹"},{name:"enllus1on",link:"https://enllus1on.github.io/",description:"Pwnç¥",avatar:"https://enllus1on.github.io/images/kano.jpg"},{name:"AsaL1n",link:"https://asal1n.github.io/",avatar:"https://asal1n.github.io/img/head.jpg",description:"è¡€æ€’å“¥"},{name:"Straw",link:"https://straw-233.github.io/",avatar:"https://straw-233.github.io/avatar/meinasi.png",description:"åˆé—¨ç—´"},{name:"CHHHCHHOH",link:"http://www.chhhchhoh.cn/",avatar:"https://s2.loli.net/2024/10/20/9EXmLyYuU6b5tVh.png",description:"åƒäº†ä¹™é…¸çš„ä¹™é†‡ä¸ä¼šæ¢¦åˆ°ä¹™é…¸ä¹™é…¯"},{name:"Lunatic",link:"https://goodlunatic.github.io/",avatar:"https://www.nssctf.cn/files/2024/4/28/7f130a1387.png",description:"Mind and Hand :)"},{name:"Fup1p1",link:"https://www.fup1p1.cn/",avatar:"https://www.nssctf.cn/files/2024/4/29/524400904c.jpeg",description:"é€†å‘å¯»çœŸç†"},{name:"X1ao",link:"https://www.x1aoblog.top/",avatar:"http://www.x1aoblog.top/upload/mmexport1681277516546.png",description:"å¤§å¯†ç ç‹"},{name:"Xux",link:"https://www.xuxblog.top",avatar:"https://avatars.githubusercontent.com/u/82816273?s=64&v=4",description:"ç¥ä»™ Web ğŸ‘´"},{name:"Woodwhale",avatar:"https://www.woodwhale.cn/woodwhale.png",link:"https://www.woodwhale.cn",description:"å…¨æ ˆç¥"},{name:"Xunflash",avatar:"https://www.xunflash.top/icon.png",link:"https://www.xunflash.top/",description:"æ¾³çˆ·"},{name:"bi0x",avatar:"https://blog.bi0x.com/img/avatar.png",link:"https://blog.bi0x.com/",description:"å­—èŠ‚ğŸ‘´"},{name:"huanghunr",link:"https://blog.huanghunr.top",avatar:"https://pic.imgdb.cn/item/670b4202d29ded1a8c807e7e.jpg",description:"å–µå–µå–µ?!è¿˜æ²¡æƒ³å¥½"},{name:"æ¸©å©³éœ‚",link:"https://somokel.github.io",avatar:"https://s2.loli.net/2024/10/21/GixfX61nsPMkN4r.jpg",description:"æ˜¥ç¥ºå¤å®‰ï¼Œç§‹ç»¥å†¬å®ã€‚"}]},version:"4.2.2"},KEEP.language_ago={second:"%s ç§’å‰",minute:"%s åˆ†é’Ÿå‰",hour:"%s å°æ—¶å‰",day:"%s å¤©å‰",week:"%s å‘¨å‰",month:"%s ä¸ªæœˆå‰",year:"%s å¹´å‰"},KEEP.language_code_block={copy:"å¤åˆ¶ä»£ç ",copied:"å·²å¤åˆ¶",fold:"æŠ˜å ä»£ç å—",folded:"å·²æŠ˜å "},KEEP.language_copy_copyright={copy:"å¤åˆ¶ç‰ˆæƒä¿¡æ¯",copied:"å·²å¤åˆ¶",title:"åŸæ–‡æ ‡é¢˜",author:"åŸæ–‡ä½œè€…",link:"åŸæ–‡é“¾æ¥"}</script><meta name=generator content="Hexo 7.3.0"><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body><div class=progress-bar-container><span class=scroll-progress-bar></span> <span class=pjax-progress-bar></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container border-box"><div class="page-main-content border-box"><div class=page-main-content-top><header class=header-wrapper><div class="border-box header-content"><div class="left flex-start border-box"><a class="logo-image border-box" href=/ ><img src=/images/logo.png> </a><a class="site-name border-box" href=/ >Carbo</a></div><div class="right border-box"><div class="pc border-box"><ul class="menu-list border-box"><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/ ><i class="menu-text-color menu-icon fa-solid fa-home"></i> é¦–é¡µ</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/tags><i class="menu-text-color menu-icon fa-solid fa-tags"></i> æ ‡ç­¾</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/links><i class="menu-text-color menu-icon fa-solid fa-link"></i> å‹é“¾</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href=/about><i class="menu-text-color menu-icon fa-solid fa-user-graduate"></i> å…³äº</a></li><li class="menu-item search search-popup-trigger"><i class="menu-text-color fas search fa-search"></i></li></ul></div><div class="mobile border-box flex-start"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class=menu-bar-middle></div></div></div></div></div><div class=header-drawer><ul class="drawer-menu-list border-box"><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/ ><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i> </span>é¦–é¡µ</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/tags><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i> </span>æ ‡ç­¾</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/links><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-link"></i> </span>å‹é“¾</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href=/about><span class="menu-icon-wrap border-box flex-center"><i class="drawer-menu-text-color menu-icon fa-solid fa-user-graduate"></i> </span>å…³äº</a></label></li></ul></div><div class=window-mask></div></header></div><div class="page-main-content-middle border-box"><div class="main-content border-box"><div class=fade-in-down-animation><div class="post-page-container border-box"><div class="post-content-container border-box"><div class="post-content-bottom border-box"><div class=post-title>2024 å›½èµ› Reverse æ–¹å‘</div><div class="post-header border-box"><div class="avatar-box border-box"><img src=/images/avatar.jpg></div><div class=info-box><div class="author border-box"><span class=name>carbofish</span></div><div class="meta-info border-box"><div class="post-meta-info-container border-box post"><div class="post-meta-info border-box"><span class="meta-info-item post-create-date"><i class="icon fa-solid fa-calendar-plus"></i>&nbsp; <span class=datetime>2024-12-03 15:12:45</span> </span><span class="meta-info-item post-update-date"><i class="icon fa-solid fa-file-pen"></i>&nbsp; <span class=datetime data-updated="Fri Jan 10 2025 21:59:45 GMT+0800">2025-01-10 21:59:45</span> </span><span class="post-tag meta-info-item border-box"><ul class=post-tag-ul><li class=tag-item><span class=tag-separator><i class="icon fas fa-hashtag"></i></span><a href=/tags/Reverse/ >Reverse</a></li></ul></span><span class="meta-info-item post-wordcount"><i class="icon fas fa-file-word"></i>&nbsp;<span>1.4k å­—</span> </span><span class="meta-info-item post-min2read"><i class="icon fas fa-clock"></i>&nbsp;<span>7 åˆ†é’Ÿ</span> </span><span class="meta-info-item post-pv"><i class="icon fas fa-eye"></i>&nbsp;<span id=busuanzi_value_page_pv></span></span></div></div></div></div></div><div class="post-content keep-markdown-body"><p><code>2024 å›½èµ› Reverse æ–¹å‘</code></p><span id=more></span><h3 id=Reverse><a href=#Reverse class=headerlink title=Reverse></a>Reverse</h3><h4 id=rand0m><a href=#rand0m class=headerlink title=rand0m></a>rand0m</h4><p>å¾—åˆ°ä¸€ä¸ª rand0m.pyd å’Œ generate.pyï¼Œrand0m.pyd è¢«å»ç¬¦å·äº†ï¼Œå…ˆéšä¾¿å†™ä¸€ä¸ª pyï¼Œç„¶åç”¨ python3.12 çš„ cython ç¼–è¯‘</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>def</span> <span class="title function_">check</span>(<span class=params>flag</span>):</span><br><span class=line>    a = <span class=number>1</span> * <span class=number>1</span></span><br><span class=line>    b = <span class=number>2</span> * <span class=number>2</span></span><br><span class=line>    c = <span class=number>2</span> ^ <span class=number>3</span></span><br><span class=line>    a = [<span class=number>0</span>] * <span class=number>6</span></span><br><span class=line>    b = <span class=number>0</span></span><br><span class=line>    <span class=keyword>while</span> b:</span><br><span class=line>        <span class=built_in>print</span>(<span class=string>"11"</span>)</span><br><span class=line>        b -= <span class=number>1</span></span><br><span class=line>    rand0m(flag) </span><br><span class=line>    <span class=keyword>return</span> a + b + c + flag</span><br><span class=line></span><br><span class=line><span class=keyword>def</span> <span class="title function_">rand0m</span>(<span class=params>x</span>):</span><br><span class=line>    <span class=keyword>return</span> x ^ <span class=number>123</span></span><br><span class=line></span><br><span class=line>__test__ = {}</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>from</span> setuptools <span class=keyword>import</span> setup, Extension</span><br><span class=line><span class=keyword>from</span> Cython.Build <span class=keyword>import</span> cythonize</span><br><span class=line></span><br><span class=line>ext_module = [</span><br><span class=line>    Extension(</span><br><span class=line>        name = <span class=string>"test"</span>,</span><br><span class=line>        sources=[<span class=string>"test.py"</span>],</span><br><span class=line>        extra_compile_args=[<span class=string>"/Zi"</span>],</span><br><span class=line>        extra_link_args=[<span class=string>"/DEBUG"</span>]</span><br><span class=line>    )</span><br><span class=line>]</span><br><span class=line></span><br><span class=line>setup(</span><br><span class=line>    name=<span class=string>"test"</span>,</span><br><span class=line>    ext_modules=cythonize(ext_module, annotate=<span class=literal>True</span>),</span><br><span class=line>)</span><br></pre></td></tr></table></figure><p><code>python build.py build_ext --inplace</code>ï¼Œç”¨ç¼–è¯‘åçš„ pyd å»å’Œ rand0m.pyd bindiff æ¢å¤ç¬¦å·</p><img lazyload="" alt=image-20241215171704163 data-src=https://s3.carbo.ink/img/2024/12/6e3c664db1de4d4b0544b7c238433ae8.png style=zoom:50%><p>ç¬¬äºŒæ­¥å»æ‰¾é‚£ä¸ªå…¨å±€è°ƒç”¨è¡¨ <code>_pyx_mstate_global</code>ï¼Œæ¢å¤ç¬¦å·åæ‰¾åˆ° <code>_Pyx_InitStrings_0</code>ï¼Œé‡Œé¢æœ‰ è°ƒç”¨è¡¨çš„åˆå§‹åŒ–ï¼Œå…ˆå†™å‡ ä¸ªç»“æ„ä½“å¯¼å…¥ ida</p><figure class="highlight cpp"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>typedef</span> <span class=keyword>struct</span> {</span><br><span class=line>    __int64 *__pyx_0;</span><br><span class=line>    __int64 *__pyx_1;</span><br><span class=line>    __int64 *__pyx_2;</span><br><span class=line>    __int64 *__pyx_3;</span><br><span class=line>    __int64 *__pyx_4;</span><br><span class=line>    __int64 *__pyx_5;</span><br><span class=line>    __int64 *__pyx_6;</span><br><span class=line>    __int64 *__pyx_7;</span><br><span class=line>    __int64 *__pyx_8;</span><br><span class=line>    __int64 *__pyx_9;</span><br><span class=line>    __int64 *__pyx_10;</span><br><span class=line>    __int64 *__pyx_11;</span><br><span class=line>    __int64 *__pyx_12;</span><br><span class=line>    __int64 *__pyx_13;</span><br><span class=line>    __int64 *__pyx_14;</span><br><span class=line>    __int64 *__pyx_15;</span><br><span class=line>    __int64 *__pyx_16;</span><br><span class=line>    __int64 *__pyx_17;</span><br><span class=line>    __int64 *__pyx_18;</span><br><span class=line>    __int64 *__pyx_19;</span><br><span class=line>    __int64 *__pyx_20;</span><br><span class=line>    __int64 *__pyx_21;</span><br><span class=line>    __int64 *__pyx_22;</span><br><span class=line>    __int64 *__pyx_23;</span><br><span class=line>    __int64 *__pyx_24;</span><br><span class=line>    __int64 *__pyx_25;</span><br><span class=line>    __int64 *__pyx_26;</span><br><span class=line>    __int64 *__pyx_27;</span><br><span class=line>    __int64 *__pyx_28;</span><br><span class=line>    __int64 *__pyx_29;</span><br><span class=line>    __int64 *__pyx_30;</span><br><span class=line>    __int64 *__pyx_31;</span><br><span class=line>    __int64 *__pyx_32;</span><br><span class=line>    __int64 *__pyx_33;</span><br><span class=line>    __int64 *__pyx_34;</span><br><span class=line>    __int64 *__pyx_35;</span><br><span class=line>    __int64 *__pyx_36;</span><br><span class=line>    __int64 *__pyx_37;</span><br><span class=line>    __int64 *__pyx_38;</span><br><span class=line>    __int64 *__pyx_39;</span><br><span class=line>} __pyx_mstate_me;</span><br><span class=line></span><br><span class=line><span class=keyword>struct</span> <span class="title class_">__Pyx_StringTabEntry</span></span><br><span class=line>{</span><br><span class=line>    __int64 p, s, n, encoding;</span><br><span class=line>    __int8 is_unicode, is_str, intern;</span><br><span class=line>    __int8 b1, b2, b3, b4, b5;</span><br><span class=line>};</span><br></pre></td></tr></table></figure><p>å¯¼å…¥åæ‰‹åŠ¨è®¾ç½®ç±»å‹ï¼Œå¯ä»¥æ¢å¤å¤§éƒ¨åˆ† _Pyx_InitStrings_0</p><img lazyload="" alt=image-20241215172041103 data-src=https://s3.carbo.ink/img/2024/12/28ca2946861cdb7814d3199e3d1fa4e5.png style=zoom:80%><p>ä¹‹åæ‰‹åŠ¨ é‡å»ºç»“æ„ä½“</p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>typedef</span> <span class=keyword>struct</span> {</span><br><span class=line>    __int64 *__pyx_d;</span><br><span class=line>    __int64 *__pyx_b;</span><br><span class=line>    __int64 *__pyx_cython_runtime;</span><br><span class=line>    __int64 *__pyx_empty_tuple;</span><br><span class=line>    __int64 *__pyx_empty_bytes;</span><br><span class=line>    __int64 *__pyx_empty_unicode;</span><br><span class=line>    __int64 *__pyx_CyFunctionType;</span><br><span class=line>    __int64 *__pyx_wenhao;</span><br><span class=line>    __int64 *__pyx_asyncio_coroutines;</span><br><span class=line>    __int64 *__pyx_check;</span><br><span class=line>    __int64 *__pyx__class_getitem__;</span><br><span class=line>    __int64 *__pyx_cline_in_traceback;</span><br><span class=line>    __int64 *__pyx_delta;</span><br><span class=line>    __int64 *__pyx_enc;</span><br><span class=line>    __int64 *__pyx_flag;</span><br><span class=line>    __int64 *__pyx_i;</span><br><span class=line>    __int64 *__pyx__is_coroutine;</span><br><span class=line>    __int64 *__pyx___main__;</span><br><span class=line>    __int64 *__pyx___name__;</span><br><span class=line>    __int64 *__pyx_rand0m;</span><br><span class=line>    __int64 *__pyx_rand0m_pyx;</span><br><span class=line>    __int64 *__pyx_range;</span><br><span class=line>    __int64 *__pyx_ret;</span><br><span class=line>    __int64 *__pyx_right;</span><br><span class=line>    __int64 *__pyx_seed;</span><br><span class=line>    __int64 *__pyx_sum;</span><br><span class=line>    __int64 *__pyx___test__;</span><br><span class=line>    __int64 *__pyx_tmp;</span><br><span class=line>    __int64 *__pyx_x;</span><br><span class=line>} __pyx_mstate_me_2;</span><br></pre></td></tr></table></figure><p>ä¹‹åå¯ä»¥å¼€å§‹åˆ†æäº†</p><p>å…ˆçœ‹ rand0m ä¸‹çš„ rand0m æ–¹æ³•</p><p>æ‰¾åˆ°ç»‘å®šçš„å‡½æ•°å</p><img lazyload="" alt=image-20241215172555432 data-src=https://s3.carbo.ink/img/2024/12/71aa4443c57e44f8480d62bb062c991b.png style=zoom:67%><p>è¿™é‡Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è½¬intçš„å‡½æ•° ç­‰äº int(v0, 16)</p><img lazyload="" alt=image-20241215172655455 data-src=https://s3.carbo.ink/img/2024/12/137ccd3b734fcf481bcb8c2ebda78e72.png style=zoom:80%><p>è¿™é‡Œè¿™ä¸ª v8 è¿™ä¹ˆå¥‡æ€ªå…¶å®æ˜¯è¢«ä¸Šé¢æˆ‘ä»¬é‡å»ºçš„è°ƒç”¨è¡¨ç»“æ„ä½“å½±å“äº†ï¼Œè¿™é‡Œæˆ‘ä»¬è¦å»æ‰¾å…¨å±€åˆå§‹åŒ–æ•´æ•°çš„åœ°æ–¹ <code>_Pyx_CreateStringTabAndInitStrings</code></p><p><img lazyload="" alt=image-20241215172903680 data-src=https://s3.carbo.ink/img/2024/12/59e5bc9272892341864d794a0f35dd95.png></p><p><img lazyload="" alt=image-20241215173028946 data-src=https://s3.carbo.ink/img/2024/12/af0bf0492c562aaa37f137d379785fda.png></p><p>ä¹Ÿå¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯ int(v0, 16)</p><p>æ˜ç™½è¿™äº›ä¹‹åæ¥ä¸‹æ¥åªè¦å¾ªè§„è¹ˆçŸ©çš„ä¸€ç‚¹ç‚¹åˆ†æå°±å¥½äº†</p><p><img lazyload="" alt=image-20241215173110636 data-src=https://s3.carbo.ink/img/2024/12/57a69eff5c6073f1b67e361683763d74.png></p><p>è¿™ä¸¤å¥ç¿»è¯‘è¿‡æ¥å°±æ˜¯</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>def</span> <span class="title function_">rand0m_fake</span>(<span class=params>x</span>):</span><br><span class=line>    v6 = x ^ <span class=number>0x9e3779b9</span></span><br><span class=line>    v3 = x &gt;&gt; <span class=number>5</span></span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241215173221796 data-src=https://s3.carbo.ink/img/2024/12/746de3faa2b5a20e0134930449257ceb.png></p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>v22 = (x &lt;&lt; <span class=number>4</span>) &amp; <span class=number>0xfa3affff</span></span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ rand0m åˆ†æå®Œå°±æ˜¯</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>def</span> <span class="title function_">rand0m_fake</span>(<span class=params>x</span>):</span><br><span class=line>    v25 = ((x &lt;&lt; <span class=number>4</span>) &amp; <span class=number>0xfa3affff</span>) + (x &gt;&gt; <span class=number>28</span>)</span><br><span class=line>    v27 = (x ^ <span class=number>0x9e3779b9</span>) &gt;&gt; <span class=number>11</span></span><br><span class=line>    v27 = v27 ** <span class=number>65537</span></span><br><span class=line>    v27 %= <span class=number>0xfffffffd</span></span><br><span class=line>    <span class=keyword>return</span> (v27, v25)</span><br></pre></td></tr></table></figure><p>åœ¨åˆ†æ check å‡½æ•°</p><p><img lazyload="" alt=image-20241215173415982 data-src=https://s3.carbo.ink/img/2024/12/b5fd91e20c079ceedac0d81c412073fb.png></p><p>è¿™é‡Œæ–°å»ºä¸€ä¸ªé•¿åº¦ä¸º 8 çš„å¯†æ–‡åˆ—è¡¨ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•è®¾ç½®å€¼åå¾—åˆ°</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>nums = [<span class=number>0x12287f38</span>, <span class=number>0x98d24b3a</span>, <span class=number>0x4a30f74d</span>, <span class=number>0xe0f1db77</span>, <span class=number>0x23a1268</span>, <span class=number>0xadf38403</span>, <span class=number>0x88108807</span>, <span class=number>0xd8499bb6</span>]</span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241215173521660 data-src=https://s3.carbo.ink/img/2024/12/9a7062e1f81f0b2807a1fff9fdebb4bf.png></p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡ åˆ†æä»¥ä¸‹å°±æ˜¯8ä¸ª8ä¸ªåˆ‡ç‰‡å»åŠ å¯†</p><p><img lazyload="" alt=image-20241215173606915 data-src=https://s3.carbo.ink/img/2024/12/efb6b85857b77b11a83ac410ba69934c.png></p><p>ç„¶åè·å¾—ç»“æœåç”¨ <code>PyObject_RichCompare</code> å»å’Œå¯†æ–‡æ¯”è¾ƒ</p><p>æ€»ä½“å°±æ˜¯æ¯æ¬¡æˆªå–8ä¸ªè·å¾—ä¸¤ä¸ªå¯†æ–‡ï¼Œç„¶åæ¯”è¾ƒï¼Œç”¨ z3 å»è§£</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>for</span> i <span class=keyword>in</span> <span class=built_in>range</span>(<span class=number>0</span>, <span class=number>8</span>, <span class=number>2</span>):</span><br><span class=line>    nums = [<span class=number>0x12287f38</span>, <span class=number>0x98d24b3a</span>, <span class=number>0x4a30f74d</span>, <span class=number>0xe0f1db77</span>, <span class=number>0x23a1268</span>, <span class=number>0xadf38403</span>, <span class=number>0x88108807</span>, <span class=number>0xd8499bb6</span>]</span><br><span class=line></span><br><span class=line>    res = [nums[i + <span class=number>1</span>], nums[i]]</span><br><span class=line></span><br><span class=line>    a = BitVec(<span class=string>"data"</span>, <span class=number>32</span>)</span><br><span class=line>    s = Solver()</span><br><span class=line>    dt = ((a &lt;&lt; <span class=number>4</span>) &amp; <span class=number>0xfa3affff</span>) + (a &gt;&gt; <span class=number>28</span>)</span><br><span class=line></span><br><span class=line>    s.add(And(res[<span class=number>1</span>] - <span class=number>0x10</span> &lt;= dt, dt &lt;= res[<span class=number>1</span>] + <span class=number>0x10</span>))</span><br><span class=line></span><br><span class=line>    <span class=keyword>while</span> s.check() == sat:</span><br><span class=line>        module = s.model()</span><br><span class=line>        result = module[a].as_long()</span><br><span class=line>        </span><br><span class=line>        chec = rand0m.rand0m(<span class=built_in>hex</span>(result)[<span class=number>2</span>:])</span><br><span class=line>        <span class=keyword>if</span> chec[<span class=number>0</span>] == res[<span class=number>0</span>] <span class=keyword>and</span> chec[<span class=number>1</span>] == res[<span class=number>1</span>]:</span><br><span class=line>            <span class=built_in>print</span>(<span class=string>f"<span class=subst>{result:#x}</span> <span class=subst>{chec[<span class=number>0</span>]:#x}</span> <span class=subst>{chec[<span class=number>1</span>]:#x}</span>"</span>)</span><br><span class=line>            <span class=keyword>break</span></span><br><span class=line>        s.add(a != result)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¥‡å¶æ•°æœ‰è¯¯å·®ï¼Œæ‰€æœ‰æ”¾å¤§ä¸€ç‚¹ï¼Œç„¶åå¯ä»¥è§£å‡ºæ¥ flag</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line>0x813a97f3 0x98d24b3a 0x12287f38</span><br><span class=line>0xd4b34f74 0xe0f1db77 0x4a30f74d</span><br><span class=line>0x802ba126 0xadf38403 0x23a1268</span><br><span class=line>0x78950880 0xd8499bb6 0x88108807</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥ä»¥ä¸‹å¯ä»¥å¾—åˆ° flag</p><p><code>flag{813a97f3d4b34f74802ba12678950880}</code></p><h4 id=cython><a href=#cython class=headerlink title=cython></a>cython</h4><p>exe è§£åŒ…åæœ‰ä¸€ä¸ª pyc å’Œ ä¸€ä¸ª pydï¼Œpyc æœ‰ä¸æ”¯æŒçš„ opcode æ‰€ä»¥ç›´æ¥çœ‹å­—èŠ‚ç </p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>for</span> i <span class=keyword>in</span> <span class=built_in>range</span>(<span class=built_in>len</span>(flag1) - <span class=number>3</span>):</span><br><span class=line>    b = (<span class=built_in>ord</span>(flag1[i]) &lt;&lt; <span class=number>24</span>) | (<span class=built_in>ord</span>(flag1[i + <span class=number>1</span>]) &lt;&lt; <span class=number>16</span>) | (<span class=built_in>ord</span>(flag1[i + <span class=number>2</span>]) &lt;&lt; <span class=number>8</span>) | <span class=built_in>ord</span>(flag1[i + <span class=number>3</span>])</span><br><span class=line>    value.append(b)</span><br><span class=line>    i += <span class=number>4</span></span><br><span class=line></span><br><span class=line>key = [<span class=number>102</span>, <span class=number>108</span>, <span class=number>97</span>, <span class=number>103</span>] </span><br><span class=line>flag_encrypt = []</span><br><span class=line></span><br><span class=line><span class=built_in>print</span>(value)</span><br><span class=line></span><br><span class=line><span class=keyword>for</span> i <span class=keyword>in</span> <span class=built_in>range</span>(<span class=number>6</span>):</span><br><span class=line>    res = ez.encrypt(value[i], value[i + <span class=number>1</span>], key[i % <span class=built_in>len</span>(key)])</span><br><span class=line>    flag_encrypt.append(res)</span><br><span class=line></span><br><span class=line>ck = ez.check(flag_encrypt)</span><br></pre></td></tr></table></figure><p>ç¿»è¯‘è¿‡æ¥å°±æ˜¯è¿™ä¸ª</p><p>ä¹‹åé€†å‘ ez.pyd å‰é¢éƒ¨åˆ†åŒä¸Šï¼Œæ¢å¤ç¬¦å·åé‡å»ºè°ƒç”¨è¡¨</p><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>typedef</span> <span class=keyword>struct</span> {</span><br><span class=line>    __int64 *__pyx_d;</span><br><span class=line>    __int64 *__pyx_b;</span><br><span class=line>    __int64 *__pyx_cython_runtime;</span><br><span class=line>    __int64 *__pyx_empty_tuple;</span><br><span class=line>    __int64 *__pyx_empty_bytes;</span><br><span class=line>    __int64 *__pyx_empty_unicode;</span><br><span class=line>    __int64 *__pyx_CyFunctionType;</span><br><span class=line>    __int64 *__pyx_kp_s_11;</span><br><span class=line>    __int64 *__pyx_V0;</span><br><span class=line>    __int64 *__pyx_V1;</span><br><span class=line>    __int64 *__pyx_wenhao;</span><br><span class=line>    __int64 *__pyx_asyncio_coroutines;</span><br><span class=line>    __int64 *__pyx_c_uint32;</span><br><span class=line>    __int64 *__pyx_check;</span><br><span class=line>    __int64 *__pyx__class_getitem__;</span><br><span class=line>    __int64 *__pyx_cline_in_traceback;</span><br><span class=line>    __int64 *__pyx_ctypes;</span><br><span class=line>    __int64 *__pyx_data;</span><br><span class=line>    __int64 *__pyx_delta;</span><br><span class=line>    __int64 *__pyx_encrypt;</span><br><span class=line>    __int64 *__pyx_ez;</span><br><span class=line>    __int64 *__pyx_ez_py;</span><br><span class=line>    __int64 *__pyx_flag_encrypt;</span><br><span class=line>    __int64 *__pyx_i;</span><br><span class=line>    __int64 *__pyx___import__;</span><br><span class=line>    __int64 *__pyx__is_coroutine;</span><br><span class=line>    __int64 *__pyx_key;</span><br><span class=line>    __int64 *__pyx___main__;</span><br><span class=line>    __int64 *__pyx___name__;</span><br><span class=line>    __int64 *__pyx_range;</span><br><span class=line>    __int64 *__pyx___test__;</span><br><span class=line>    __int64 *__pyx_total;</span><br><span class=line>    __int64 *__pyx_zero_v;</span><br><span class=line>    __int64 *__pyx_v1;</span><br><span class=line>    __int64 *__pyx_value;</span><br><span class=line>} __pyx_mstate_me_2;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>struct</span> <span class="title class_">__Pyx_StringTabEntry</span></span><br><span class=line>{</span><br><span class=line>    __int64 p, s, n, encoding;</span><br><span class=line>    __int8 is_unicode, is_str, intern;</span><br><span class=line>    __int8 b1, b2, b3, b4, b5;</span><br><span class=line>};</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ†æ encrypt</p><p>å…¶å®å°±æ˜¯ä¸€ä¸ªé­”æ”¹ xteaï¼Œé­”æ”¹äº† delta è½®æ•° è¿˜æœ‰ç§»ä½æ•°</p><p><img lazyload="" alt=image-20241215174633527 data-src=https://s3.carbo.ink/img/2024/12/99b76666e060499473840ac86c89c419.png></p><p>è¿™é‡Œå°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>ctypes.uint32_t(v0).value</span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241215174800199 data-src=https://s3.carbo.ink/img/2024/12/eae5d686eb01c5452c1a99c5489373eb.png></p><p>è¿™é‡Œç¿»è¯‘è¿‡æ¥æ˜¯</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>v0 += (((v1 &lt;&lt; <span class=number>3</span>) ^ (v1 &gt;&gt; <span class=number>6</span>)) + v1) ^ (<span class=built_in>sum</span> + key[<span class=built_in>sum</span> &amp; <span class=number>3</span>]);</span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241215174855166 data-src=https://s3.carbo.ink/img/2024/12/26adde878c621b3f3ec4e53ec4791ecc.png></p><p>è¿™é‡Œç¿»è¯‘è¿‡æ¥æ˜¯</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>v1 += (((v0 &lt;&lt; <span class=number>3</span>) ^ (v0 &gt;&gt; <span class=number>6</span>)) + v0) ^ (<span class=built_in>sum</span> + key[(<span class=built_in>sum</span> &gt;&gt; <span class=number>11</span>) &amp; <span class=number>3</span>]);</span><br></pre></td></tr></table></figure><p><img lazyload="" alt=image-20241215175010327 data-src=https://s3.carbo.ink/img/2024/12/ea801b02b20c41625a66d99bef6c60d9.png></p><p>è¿™é‡Œ åŠ äº† deltaï¼Œç„¶åå°±å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬è§£å¯†äº†</p><figure class="highlight cpp"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre></td><td class=code><pre><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"defs.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"stdio.h"</span></span></span><br><span class=line><span class=meta>#<span class=keyword>include</span> <span class=string>"stdint.h"</span></span></span><br><span class=line></span><br><span class=line><span class=function><span class=type>void</span> <span class=title>decipher</span><span class=params>(<span class=type>unsigned</span> <span class=type>int</span> num_rounds, <span class=type>uint32_t</span> v[<span class=number>2</span>], <span class=type>uint32_t</span> <span class=type>const</span> key[<span class=number>4</span>])</span></span></span><br><span class=line><span class=function></span>{</span><br><span class=line>    <span class=type>unsigned</span> <span class=type>int</span> i;</span><br><span class=line>    <span class=type>uint32_t</span> v0 = v[<span class=number>0</span>], v1 = v[<span class=number>1</span>], delta = <span class=number>0x54646454</span>, sum = delta * num_rounds;</span><br><span class=line>    <span class=keyword>for</span> (i = <span class=number>0</span>; i &lt; num_rounds; i++)</span><br><span class=line>    {</span><br><span class=line>        v1 -= (((v0 &lt;&lt; <span class=number>3</span>) ^ (v0 &gt;&gt; <span class=number>6</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class=number>11</span>) &amp; <span class=number>3</span>]);</span><br><span class=line>        sum -= delta;</span><br><span class=line>        v0 -= (((v1 &lt;&lt; <span class=number>3</span>) ^ (v1 &gt;&gt; <span class=number>6</span>)) + v1) ^ (sum + key[sum &amp; <span class=number>3</span>]);</span><br><span class=line>    }</span><br><span class=line>    v[<span class=number>0</span>] = v0;</span><br><span class=line>    v[<span class=number>1</span>] = v1;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=function><span class=type>int</span> <span class=title>main</span><span class=params>()</span></span></span><br><span class=line><span class=function></span>{</span><br><span class=line>    uint32 v[] = {</span><br><span class=line>            <span class=number>874806256</span>, <span class=number>3846097014</span>, <span class=number>2954414927</span>, <span class=number>947032420</span>, <span class=number>142915619</span>, <span class=number>250019369</span></span><br><span class=line>    };</span><br><span class=line></span><br><span class=line>    uint32 key[] = {</span><br><span class=line>            <span class=number>102</span>, <span class=number>108</span>, <span class=number>97</span>, <span class=number>103</span></span><br><span class=line>    };</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>6</span>; i += <span class=number>2</span>) {</span><br><span class=line>        <span class=built_in>decipher</span>(<span class=number>64</span>, v + i, key);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    uint8 *ptr = (uint8 *) v;</span><br><span class=line></span><br><span class=line>    <span class=keyword>for</span> (<span class=type>int</span> i = <span class=number>0</span>; i &lt; <span class=number>24</span>; i += <span class=number>4</span>) {</span><br><span class=line>        <span class=built_in>printf</span>(<span class=string>"%c%c%c%c"</span>, ptr[i + <span class=number>3</span>], ptr[i + <span class=number>2</span>], ptr[i + <span class=number>1</span>], ptr[i]);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>}</span><br></pre></td></tr></table></figure><p><code>flag{bfXtvbVZfRfeqoSXWD}</code></p><h4 id=dump><a href=#dump class=headerlink title=dump></a>dump</h4><p>åˆ°æ‰‹ä¸€ä¸ª re.exeï¼Œéšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿å‘ç°ä¼šæ ¹æ®ä½ è¾“å…¥çš„å†…å®¹ç»™å‡ºåŠ å¯†çš„å†…å®¹</p><p><img lazyload="" alt=image-20241215175656889 data-src=https://s3.carbo.ink/img/2024/12/aef72a5689efe1b18d36d375b5ffcae8.png></p><p>å‘ç°æ˜¯ä¸€ä¸ªå•å­—èŠ‚åŠ å¯†ï¼Œç›´æ¥è¾“å…¥æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ä¸²å¯¼å‡ºè¡¨</p><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line>0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!<span class=comment>#$%&amp;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~ </span></span><br><span class=line></span><br><span class=line>001c1d000000000000001e1f202122232425262728292a2b2c2d2e2f303132333435363702030405060708090a0b0c0d0e0f101112131415161718191a1b000000000000000000000000000000000100000000000000000038003900</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>import</span> binascii</span><br><span class=line></span><br><span class=line>s = <span class=string>"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~ "</span></span><br><span class=line>d = <span class=built_in>list</span>(binascii.unhexlify(<span class=string>"001c1d000000000000001e1f202122232425262728292a2b2c2d2e2f303132333435363702030405060708090a0b0c0d0e0f101112131415161718191a1b000000000000000000000000000000000100000000000000000038003900"</span>))</span><br><span class=line></span><br><span class=line>mp = {}</span><br><span class=line></span><br><span class=line>idx = <span class=number>0</span></span><br><span class=line><span class=keyword>for</span> i <span class=keyword>in</span> <span class=built_in>range</span>(<span class=built_in>len</span>(d)):</span><br><span class=line>    mp[d[i]] = s[i]</span><br><span class=line></span><br><span class=line>data = <span class=built_in>open</span>(<span class=string>"flag"</span>, <span class=string>"rb"</span>).read()</span><br><span class=line></span><br><span class=line><span class=keyword>for</span> i <span class=keyword>in</span> data:</span><br><span class=line>    <span class=built_in>print</span>(mp[i], end=<span class=string>""</span>)</span><br></pre></td></tr></table></figure><p><code>flag{MTczMDc~MzQ2Ng==}</code></p><p>è¿™ä¸ª ~ æ˜¯å› ä¸ºå¯†æ–‡é‡Œæ˜¯ 00ï¼Œè€ŒåŠ å¯†åæ˜¯ 00 å¤ªå¤šäº†ä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ª flag åŒ…è£¹çš„å†…å®¹å¾ˆåƒ base64ï¼Œå…ˆéšä¾¿å¡«ä¸€ä¸‹ï¼Œå¾ˆåƒæ—¶é—´æˆ³ï¼Œæµ‹è¯•åå‘ç° 4 ä»¥åçš„æ•°å­—è¿˜æœ‰ è‹±æ–‡å­—æ¯éƒ½æ˜¯æ— æ•ˆæ—¶é—´æˆ³ï¼Œéšä¾¿çˆ†ç ´ä¸‹ï¼Œ4æ˜¯æ­£ç¡®ç­”æ¡ˆ</p><p><code>flag{MTczMDc4MzQ2Ng==}</code></p></div><div class="post-copyright-info-container border-box"><div class="copyright-info-content border-box"><div class="copyright-info-top border-box"><div class="copyright-post-title border-box text-ellipsis">2024 å›½èµ› Reverse æ–¹å‘</div><div class="copyright-post-link border-box text-ellipsis">2024/12/03/2024ciscn/</div></div><div class="copyright-info-bottom border-box"><div class="copyright-post-author bottom-item"><div class=type>ä½œè€…</div><div class=content>carbofish</div></div><div class="post-time bottom-item"><div class=type>å‘å¸ƒäº</div><div class=content>2024-12-03 15:12</div></div><div class="post-license bottom-item"><div class=type>è®¸å¯</div><div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0"><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><i class="fa-brands fa-creative-commons"></i> <i class="fa-brands fa-creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc"></i> <i class="fa-brands fa-creative-commons-sa"></i></a></div></div></div><i class="copyright-bg fa-solid fa-copyright"></i></div><div class="copy-copyright-info flex-center tooltip" data-tooltip-content=å¤åˆ¶ç‰ˆæƒä¿¡æ¯ data-tooltip-offset-y=-2px><i class="fa-solid fa-copy"></i></div></div><div class="post-bottom-tags-and-share border-box"><div><ul class="post-tags-box border-box"><li class="tag-item border-box"><i class="icon fas fa-hashtag"></i>&nbsp;<a href=/tags/Reverse/ >Reverse</a></li></ul></div><div></div></div><div class="post-nav border-box"><div class=prev-post><a class=prev rel=prev href=/2024/12/03/2024gujianshan/ title="2024 å¤å‰‘å±±ç½‘ç»œå®‰å…¨å¤§èµ› Reverse æ–¹å‘"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">2024 å¤å‰‘å±±ç½‘ç»œå®‰å…¨å¤§èµ› Reverse æ–¹å‘</span> <span class=post-nav-item>ä¸Šä¸€ç¯‡</span></span></a></div><div class=next-post><a class=next rel=next href=/2024/12/03/arm_study/ title="ARM64 æ±‡ç¼–å°è®°"><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">ARM64 æ±‡ç¼–å°è®°</span> <span class=post-nav-item>ä¸‹ä¸€ç¯‡</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comments-container border-box"><div id=comments-anchor class="comment-area-title border-box"><i class="fas fa-comments"></i>&nbsp;è¯„è®º</div><div class="comment-plugin-fail border-box"><span class=fail-tip>è¯„è®ºæ’ä»¶åŠ è½½å¤±è´¥</span> <button class="reload keep-button">ç‚¹å‡»é‡æ–°åŠ è½½</button></div><div class="comment-plugin-loading flex-center border-box"><i class="loading-icon fa-solid fa-spinner fa-spin"></i> <span class=load-tip>æ­£åœ¨åŠ è½½è¯„è®ºæ’ä»¶</span></div><script data-pjax>window.KeepCommentPlugin={},window.KeepCommentPlugin.hideLoading=()=>{document.querySelector(".comments-container .comment-plugin-loading").style.display="none"},window.KeepCommentPlugin.loadFailHandle=()=>{window.KeepCommentPlugin.hideLoading();var e=document.querySelector(".comments-container .comment-plugin-fail");e.style.display="flex",e.querySelector(".reload").addEventListener("click",()=>{window.location.reload()})}</script><div class=waline-comment-container><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline-meta.css><div id=waline-comment></div><script data-pjax>window.KeepCommentPlugin.walineOptions=JSON.parse("{}".replace(/&#34;/g,'"')),window.KeepCommentPlugin.walineOptions.el="#waline-comment",window.KeepCommentPlugin.walineOptions.comment=".post-comments-count",window.KeepCommentPlugin.walineOptions.serverURL="https://comment.carbo.ink/",window.KeepCommentPlugin.walineOptions.lang="zh-CN",window.KeepCommentPlugin.walineOptions.reaction=!0</script><script data-pjax async type=module>import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.3.2/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('true' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }</script></div></div></div></div><div class="pc-post-toc right-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#Reverse><span class=nav-text>Reverse</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#rand0m><span class=nav-text>rand0m</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#cython><span class=nav-text>cython</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#dump><span class=nav-text>dump</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom border-box"><footer class="footer border-box"><div class="copyright-info info-item">&copy;&nbsp;<span>2024</span>&nbsp;-&nbsp;2025 &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href=/ >carbofish</a></div><div class="theme-info info-item">ç”±&nbsp;<a target=_blank href=https://hexo.io>Hexo</a>&nbsp;é©±åŠ¨&nbsp;&&nbsp;ä¸»é¢˜&nbsp;<a class=keep-version target=_blank href=https://github.com/XPoet/hexo-theme-keep>Keep</a></div><div class="count-info info-item"><span class="count-item border-box word"><span class="item-type border-box">æ€»å­—æ•°</span> <span class="item-value border-box word">53.6k</span> </span><span class="count-item border-box uv"><span class="item-type border-box">è®¿å®¢æ•°</span> <span class="item-value border-box uv" id=busuanzi_value_site_uv></span> </span><span class="count-item border-box pv"><span class="item-type border-box">è®¿é—®é‡</span> <span class="item-value border-box pv" id=busuanzi_value_site_pv></span></span></div></footer></div></div><div class="post-tools right-toc"><div class="post-tools-container border-box"><ul class="post-tools-list border-box"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class=post-comments-count></span></li><li class="tools-item flex-center full-screen"><i class="fa-solid fa-expand"></i></li></ul></div></div><div class=side-tools><div class="side-tools-container border-box"><ul class="side-tools-list side-tools-show-handle border-box"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-toggle-theme-mode flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list border-box"><li class="tools-item toggle-show-toc-tablet flex-center"><i class="fas fa-list"></i></li><li class="tools-item go-to-comments-tablet flex-center"><i class="fas fa-comment"></i></li><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center show-arrow"><i class="arrow fas fa-arrow-up"></i> <span class=percent></span></li></ul></div></div><div class=zoom-in-image-mask><img class=zoom-in-image></div><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-input-field-pre><i class="fas fa-keyboard"></i></span><div class=search-input-container><input autocomplete=off autocorrect=off autocapitalize=off placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=close-popup-btn><i class="fas fa-times"></i></span></div><div id=search-result><div id=no-result><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><div class=tablet-post-toc-mask><div class=tablet-post-toc><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class=nav><li class="nav-item nav-level-3"><a class=nav-link href=#Reverse><span class=nav-text>Reverse</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#rand0m><span class=nav-text>rand0m</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#cython><span class=nav-text>cython</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#dump><span class=nav-text>dump</span></a></li></ol></li></ol></div></div></div></div></main><script src=/js/utils.js></script><script src=/js/header-shrink.js></script><script src=/js/back2top.js></script><script src=/js/toggle-theme.js></script><script src=/js/code-block.js></script><script src=/js/main.js></script><script src=/js/libs/anime.min.js></script><script src=/js/local-search.js></script><script src=/js/lazyload.js></script><div class=pjax><script src=/js/post/post-helper.js></script><script src=/js/post/toc.js></script><script src=/js/post/copyright-info.js></script></div><script src=/js/mermaid.min.js></script><script data-pjax>window.mermaid&&mermaid.init()</script><script src=/js/libs/pjax.min.js></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.initExecute()})})</script></body></html>